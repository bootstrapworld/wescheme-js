!function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(6),i=n(7),a=n(9),s=e.compile=function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=o.lex(t,"foo",e),s=r.parse(n),c=i.desugar(s)[0],u=i.analyze(c),l=a.compile(c,u);return l.bytecode};e["default"]=s},function(t,e,n){window.plt=window.plt||{},plt.compiler=n(2);var o=n(3),r=n(4);!function(){"use strict";function t(t){return/\s/.test(t)}function e(t){return"("===t||")"===t||"["===t||"]"===t||"{"===t||"}"===t}function n(t){this.txt=t}function i(t,e){return"("===t&&")"===e||"["===t&&"]"===e||"{"===t&&"}"===e}function a(t){return"("===t?")":"["===t?"]":"{"===t?"}":")"===t?"(":"]"===t?"[":"}"===t?"{":B(new o.Message(["otherDelim: Unknown delimiter: ",t]))}function s(e,n){var o;if(n<e.length)for(o=e.charAt(n);t(o)&&n<e.length;)"\n"===o?(x++,E=0):E++,o=e.charAt(++n);return n}function c(t){return t instanceof Array?"("+t.map(c).toString()+")":t.toString()}function u(t,e){var o=0;S=E=0,k=x=1,M=!0,C=e||"<definitions>";var r,i=[];for(b=[],o=s(t,0);o<t.length;)r=l(t,o),r instanceof n||i.push(r),o=s(t,r.location.startChar+r.location.span);return i.location=new _(S,k,0,o,C),i}function l(t,e){S=E,k=x;var n=e;e=s(t,e);var r=t.charAt(e);e>=t.length&&(T=e,B(new o.Message([C,":",k.toString(),":",(S-1).toString(),": read: (found end-of-file)"]),new _(S-1,k,e-2,2),"Error-GenericReadError"));var i=R.test(r)?B(new o.Message(["read: expected a ",a(r)," to open ",new o.ColoredPart(r,new _(E,k,n,1))]),new _(E,k,n,1)):N.test(r)?p(t,e):'"'===r?h(t,e):"#"===r?f(t,e):";"===r?y(t,e):D.test(r)?v(t,e):w(t,e);return i}function p(t,e){function r(t,e,r){var i=l(t,e);if(e=i.location.end().startChar+1,i instanceof P&&"."==i.val){if(v){var a=new o.Message(["A syntax list may have only 2 `.'s"]);B(a,r[y].location)}v=y?r.length:!1,y=y||r.length}return i instanceof n||(i.parent=r,r.push(i)),e}function c(t,e,n){if(0===e){var r=new o.Message(["A `.' cannot be the first element in a syntax list"]);B(r,t[e].location)}if(e===t.length-1||n===t.length-1){var r=new o.Message(["A `.' cannot be the last element in a syntax list"]);B(r,t[n||e].location)}if(n){if(n-e===2)return t.slice(e+1,e+2).concat(t.slice(0,e),t.slice(n+1));var r=new o.Message(["Two `.'s may only surround one syntax item"]);B(r,t[n].location)}if(!(t[e+1]instanceof Array)){var r=new o.Message(["A `.' must be followed by a syntax list, but found ",new o.ColoredPart("something else",t[e+1].location)]);B(r,t[e+1].location)}if(!(t.length>e+2))return t.slice(0,e).concat(t[e+1],t.slice(e+2));var r=new o.Message(["A `.' followed by a syntax list must be followed by a closing delimeter, but found ",new o.ColoredPart("something else",t[e+2].location)]);B(r,t[e+1].location)}function u(t){if(/expected a .+ to (close|open)/.exec(t)||/unexpected/.exec(t)||/syntax list/.exec(t)||/bad syntax/.exec(t)||/bad character constant/.exec(t))throw t;var n=JSON.parse(JSON.parse(t)["structured-error"]).location;return m=new _(Number(n.column),Number(n.line),Number(n.offset)-1,Number(n.span)),e=T,d=t,e}var p=E,h=x,f=e,d=!1,m=new _(p,h,f,1),g=t.charAt(e++),y=!1,v=!1;E++;var w=[];for(b.push(g),e=s(t,e);e<t.length&&!R.test(t.charAt(e));){"\n"===t.charAt(e)&&(x++,E=0);try{e=r(t,e,w)}catch(S){var e=u(S)}e=s(t,e)}if(e>=t.length){var k=new o.Message(["read: expected a ",a(g)," to close ",new o.ColoredPart(g.toString(),new _(p,h,f,1))]);B(k,m)}if(!i(g,t.charAt(e))){var k=new o.Message(["read: expected a ",a(g)," to close ",new o.ColoredPart(g.toString(),new _(p,h,f,1))," but found a ",new o.ColoredPart(t.charAt(e).toString(),new _(E,x,e,1))]);B(k,new _(E,x,e,1))}if(E++,e++,d)throw T=e,d;return(y||v)&&(w=c(w,y,v)),w.location=new _(p,h,f,e-f),w}function h(t,e){var n=E,r=x,i=e,a=/^\"[^\"]*(\\\"[^\"]*)*[^\\]\"|\"\"/.test(t.slice(e)),s=/^\"[^\"]*(\\"[^\"]*)*/.exec(t.slice(i))[0];e++,E++;for(var c,u="";e<t.length&&'"'!==t.charAt(e);){if(c=t.charAt(e++),"\n"===c?(x++,E=0):E++,"\\"===c){if(E++,c=t.charAt(e++),e>=t.length)break;switch(!0){case/a/.test(c):c="";break;case/b/.test(c):c="\b";break;case/t/.test(c):c="	";break;case/n/.test(c):c="\n";break;case/v/.test(c):c="\x0B";break;case/f/.test(c):c="\f";break;case/r/.test(c):c="\r";break;case/e/.test(c):c="'";break;case/\n/.test(c):c="";break;case/[\"\'\\]/.test(c):break;case/[xuU]/.test(c):var l="x"===c?F:"u"===c?O:L;l.test(t.slice(e))||(T=i+s.length+1,B(new o.Message([C,":",r.toString(),":",n.toString(),": read: no hex digit following \\"+c+" in string"]),new _(n,r,i,e-i+1),"Error-GenericReadError"));var p=l.exec(t.slice(e))[1];c=String.fromCharCode(parseInt(p,16)),e+=p.length,E+=p.length;break;case j.test(t.slice(e-1)):var p=j.exec(t.slice(e-1))[1];c=String.fromCharCode(parseInt(p,8)),e+=p.length-1,E+=p.length-1;break;default:T=i+s.length+1,B(new o.Message([C,":",r.toString(),":",n.toString(),": read: unknown escape sequence \\"+c+" in string"]),new _(n,r,i,e-i),"Error-GenericReadError")}}u+=c}a||(T=i+s.length,B(new o.Message([C,":",r.toString(),":",n.toString(),": read: expected a closing '\"'"]),new _(n,r,i,1),"Error-GenericReadError"));var h=new I(new o.string(u));return e++,E++,h.location=new _(n,r,i,e-i),h}function f(t,e){function n(t,e){var n=new o.Message([C,":",x.toString(),":",(E-1).toString(),t]);B(n,new _(i,a,s,e.length+1),"Error-GenericReadError")}var r,i=E,a=x,s=e;e++,E++;if(e<t.length){var c=t.charAt(e).toLowerCase(),u=new RegExp('^(((fl|fx|s|hash|hasheq)[[({])|((rx|px)#{0,1}"))',"g"),f=u.exec(t.slice(e)),b=/^(!(?!\/)|reader|lang[\s]{0,1})/,S=b.exec(t.slice(e)),k=new RegExp("^(c|C)(i|I|s|S)"),N=k.exec(t.slice(e)),R=new RegExp("^([0-9]*)[[({]","g"),D=R.exec(t.slice(e));if(f&&f[0].length>0){var F,O=l(t,e+f[0].length-1),V=f[0].length,L=f[0].replace(/[\(\[\{\"|#\"]/g,"");switch(L){case"fl":F="flvectors";break;case"fx":F="fxvectors";break;case"s":F="structs";break;case"hash":case"hasheq":F="hashtables";break;case"px":case"rx":F="regular expressions";break;default:throw"IMPOSSIBLE: unsupportedMatch captured something it shouldn't: "+L}var j=new o.Message([C,":",x.toString(),":","0",": read-syntax: literal "+F+" not allowed"]);return r=new q(O,j,V),r.location=new _(i,a,s,f[0].length+O.location.span),r}if(S&&S[0].length>0)n(": read: #"+S[0].trim()+" not enabled in the current context",S[0]);else{if(N&&N[0].length>0)return M="cs"===N[0].toLowerCase(),e+=2,E+=2,l(t,e);if(D&&D[0].length>0){var U=D[1]?parseInt(D[1]):"",z=U.toString().length;e+=z,E+=z;var $=p(t,e),W=""===U?$.length:parseInt(D[1]);if($.length>W){var G=new o.Message(["read: vector length "+W+" is too small, ",$.length+" value"+($.length>1?"s":"")," provided"]);B(G,new _(i,a,s,D[0].length))}return e+=$.location.span,r=new I(new Vector(W,$)),r.location=new _(i,a,s,e-s),r}var Y=new RegExp("^(hasheq|hash|fl|fx|\\d+|true|false|[tfeibdox]|\\<\\<|[\\\\\\\"\\%\\:\\&\\|\\;\\!\\`\\,\\']|)","i"),K=Y.exec(t.slice(e))[0],X=t.charAt(e+K.length),c=K.charAt(0).toLowerCase();switch(c){case"\\":r=d(t,e-1),e+=r.location.span-1;break;case'"':n(": byte strings are not supported in WeScheme",'#"');case"%":r=w(t,e),r.val="#"+r.val,e+=r.location.span;break;case":":r=w(t,e-1);var j=new o.Message([C,":",x.toString(),":","0",": read-syntax: Keyword internment is not supported in WeScheme"]);r=new q(r.val,j,r.location.span),e+=r.val.length-1;break;case"&":E++,O=l(t,e+1);var Z=new P("box"),r=[Z,O];e+=O.location.span+1,Z.location=new _(i,a,s,e-s);break;case"|":e--,r=m(t,e),e+=r.location.span+1;break;case";":r=g(t,e+1),e+=r.location.span+1;break;case"!":r=y(t,e-1),e+=r.location.span;break;case"`":case",":case"'":r=v(t,e),r.location.startChar--,r.location.span++,T=e+r.location.span;var G=new o.Message([C,":",a.toString(),":",(E-1).toString()," read: WeScheme does not support the '#"+c+"' notation for ",","===c?"unsyntax":"'"===c?"syntax":"quasisyntax"]);B(G,r.location);break;case"<<":r=h(t,e-1),e+=r.location.span;break;case"e":case"i":case"b":case"o":case"d":case"x":E--,r=w(t,e-1),e+=r.location.span-1;break;case"true":case"false":case"t":case"f":if(!A.exec(X)){r=new I("t"===c||"true"===K),e+=K.length,E+=K.length;break}default:T=e;var G=new o.Message([C,":",x.toString(),":",(E-1).toString(),": read: bad syntax `#",K+X,"'"]);B(G,new _(i,a,s,(K+X).length+1),"Error-GenericReadError")}}}else T=e,B(new o.Message([C,":",x.toString(),":",(E-1).toString(),": read: bad syntax `#'"]),new _(i,a,s,e-s),"Error-GenericReadError");return r.location=new _(i,a,s,e-s),r}function d(n,r){var i=E,a=x,s=r;r+=2,E++;for(var c,u="",l=!0;r<n.length&&"#\\"!==n.slice(r,r+2)&&(l||!t(n.charAt(r))&&!e(n.charAt(r)));)l=!1,E++,u+=n.charAt(r++);var p=new RegExp("(backspace|tab|newline|space|vtab)[^a-zA-Z]*","i"),h=p.exec(u);if(p.test(u))u="backspace"===u?"\b":"tab"===u?"	":"newline"===u?"\n":"space"===u?" ":"vtab"===u?"\x0B":"Impossible: unknown special char was matched by special char!",r=s+2+h[1].length;else if(/^[0-9].*/.test(u)&&j.test(u)&&j.exec(u)[0]===u&&parseInt(j.exec(u)[0],8)<256&&parseInt(j.exec(u)[0],8)>31){var h=/[0-7]+/.exec(u)[0];u=String.fromCharCode(parseInt(h,8)),r=s+2+h.length}else if(/[uU]/.test(u)&&(c="u"===u.charAt(0)?O:V)&&c.test(u.slice(1))){var h=c.exec(u.slice(1))[0];E+=h.length-u.length+1,u=String.fromCharCode(parseInt(h,16)),r=s+3+h.length}else 1===u.length||/[^\u00C0-\u1FFF\u2C00-\uD7FF\w]$/.test(u.charAt(1))?(u=u.charAt(0),r=s+3):B(new o.Message([C,":",a.toString(),":",(i-1).toString(),": read: bad character constant: #\\",u]),new _(i-1,a,s,r-s),"Error-GenericReadError");var f=new I(new o["char"](u));return f.location=new _(i,a,s,r-s),f}function m(t,e){var r=E,i=x,a=e;e+=2,E+=2;for(var s="";e+1<t.length&&("|"!==t.charAt(e)||"#"!==t.charAt(e+1));)"\n"===t.charAt(e)&&(x++,E=0),s+=t.charAt(e),e++,E++;e+1>=t.length&&B(new o.Message(["read: Unexpected EOF when reading a multiline comment"]),new _(r,i,a,e-a)),e++,E++;var c=new n(s);return c.location=new _(r,i,a,e-a),c}function g(t,e){for(var r,i=E++,a=x,c=e;(e=s(t,e))&&e+1<t.length&&(r=l(t,e))&&r instanceof n;)e=r.location.endChar;e+1>=t.length&&(T=e,B(new o.Message([C,":",a.toString(),":",(i-1).toString(),": read: expected a commented-out element for `#;' (found end-of-file)"]),new _(i-1,a,e-2,2),"Error-GenericReadError"));var u=new n("("+r.toString()+")");return e=r.location.endChar,u.location=new _(i,a,c,e-c),u}function y(t,e){var r=E,i=x,a=e;e++,E++;for(var s="";e<t.length&&"\n"!==t.charAt(e);)s+=t.charAt(e),E++,e++;e>t.length&&(T=e,B(new o.Message(["read: Unexpected EOF when reading a line comment"]),new _(r,i,a,e-a)));var c=new n(s);return c.location=new _(r,i,a,e+1-a),x++,E=0,c}function v(t,e){function r(t){T=t+1;var e="'"==p?" quoting ":"`"==p?" quasiquoting ":","==p?" unquoting ":",@"==p?" unquoting ":"";B(new o.Message([C,":",c.toString(),":",a.toString(),": read: expected an element for"+e,p," (found end-of-file)"]),new _(a,c,u,p.length),"Error-GenericReadError")}var i,a=E,c=x,u=e,p=t.charAt(e),h="'"==p?new P("quote"):"`"==p?new P("quasiquote"):"";for(e+1>=t.length&&r(e),e++,E++,","==p&&("@"==t.charAt(e)?(e++,E++,p+="@",h=new P("unquote-splicing")):h=new P("unquote")),h.location=new _(E-1,c,u,e-u);!i||i instanceof n;){e=s(t,e);try{i=l(t,e)}catch(f){/read\: \(found end-of-file\)/.test(f)&&r(e);var d=/expected a .* to open \",\"(.)\"/.exec(f);throw d&&(T=e+1,B(new o.Message([C,":",x.toString(),":",E.toString(),": read: unexpected `"+d[1]+"'"]),new _(E,x,e,1),"Error-GenericReadError")),f}e=i.location.end().startChar+1}var m=[h,i],g=i.location.end().startChar+1-u;return m.location=new _(a,c,u,g),m}function w(t,e){var n=E,i=x,a=e,s=new RegExp("(\\|(.|\\n)*\\||\\\\(.|\\n)|[^\\(\\)\\{\\}\\[\\]\\,\\'\\`\\s\\\"\\;])+","mg"),c=s.exec(t.slice(e))[0],u=/\.*\\+$/.exec(c);u&&u[0].length%2>0&&(e=t.length,T=e,B(new o.Message([C,":",x.toString(),":",n.toString(),": read: EOF following `\\' in symbol"]),new _(n,i,a,e-a),"Error-GenericReadError")),e+=c.length,E+=c.length;for(var l="",p=0;p<c.length;p++)"\\"==c.charAt(p)&&p++,l+=c.charAt(p);var h=l.split("|");if(h.length%2===0){T=t.length;var f=h[h.length-1].length+1,d=c.slice(0,c.length-f),m=a+d.length;E=n;for(var p=0;p<d.length;p++)"\n"===t.charAt(e)?(x++,E=0):E++;B(new o.Message([C,":",x.toString(),":",E.toString(),": read: unbalanced `|'"]),new _(E,x,m,t.length-m),"Error-GenericReadError")}var g=h.reduce(function(t,e,n){return t+=n%2||M?e:e.toLowerCase()},"");"\n"===g&&(x++,E=0);var y=new RegExp("^$|[\\(\\)\\{\\}\\[\\]\\,\\'\\`\\s\\\"\\\\]","g"),v=new RegExp("^.*\\\\[\\d]*.*|\\|[\\d]*\\|");g=v.test(c)||y.test(g)?"|"+g+"|":g;var w=new P(g);if(1===h.length&&!/^[a-zA-Z\-\?]+$/.test(g))try{var b=r.fromString(g,!0);(b||0===b)&&(b instanceof Object&&(b.stx=g,b.location=new _(n,i,a,e-a)),w=new I(b))}catch(S){T=e;var k=new o.Message([C,":",i.toString(),":",n.toString(),": read: "+S.message]);B(k,new _(n,i,a,e-a),"Error-GenericReadError")}return w.stx=g,w.location=new _(n,i,a,e-a),w}var b,x,E,S,k,C,M,T,I=plt.compiler.literal,P=plt.compiler.symbolExpr,q=plt.compiler.unsupportedExpr,B=plt.compiler.throwError,N=/[(\u005B\u007B]/,R=/[)\u005D\u007D]/,A=/^[^(\u005B\u007B)\u005D\u007D\s]+/,D=/[\'`,]/,F=new RegExp("^([0-9a-f]{1,2})","i"),O=new RegExp("^([0-9a-f]{1,4})","i"),V=new RegExp("^([0-9a-f]{1,6})","i"),L=new RegExp("^([0-9a-f]{1,8})","i"),j=new RegExp("^([0-7]{1,3})","i"),_=function(t,e,n,r,i){this.startCol=t,this.startRow=e,this.startChar=n,this.span=r,this.source=i||C,this.endCol=E,this.endRow=x,this.endChar=n+r,this.start=function(){return new _("","",this.startChar,1)},this.end=function(){return new _("","",this.startChar+this.span-1,1)},this.toString=function(){return"Loc("+this.startCol+", "+this.startRow+", "+(this.startChar+1)+","+this.span+")"},this.toVector=function(){return new o.vector(['"'+this.source+'"',this.startChar+1,this.startRow,this.startCol,this.span])},this.toString=function(){return{line:this.startRow.toString(),id:this.source,span:this.span.toString(),offset:(this.startChar+1).toString(),column:this.startCol.toString()}}};Array.prototype.toString=function(){return this.join(" ")},plt.compiler.lex=function(t,e,n){var o=(new Date).getTime();try{var r=u(t,e)}catch(i){throw console.log("LEXING ERROR"),i}var a=(new Date).getTime();return n&&(console.log("Lexed in "+Math.floor(a-o)+"ms"),console.log(r),console.log(c(r))),r},plt.compiler.sexpToString=c}(),t.exports=plt.compiler},function(t,e,n){var o=n(3),r=o.Vector;window.plt=window.plt||{},plt.compiler=plt.compiler||{},function(){"use strict";function t(t,e,n){function o(t){return"string"==typeof t?t:t instanceof x?'["span", [["class", "SchemeValue-Symbol"]], '+t.val+"]":void 0!==t.location?{text:t.text,type:"ColoredPart",loc:t.location.toString(),toString:function(){return t.text}}:void 0!==t.locations?{text:t.text,type:"MultiPart",solid:t.solid,locs:t.locations.map(function(t){return t.toString()}),toString:function(){return t.text}}:void 0}e.source=e.source||"<unknown>",t.args=t.args.map(o);var r={type:"moby-failure","dom-message":["span",[["class","Error"]],["span",[["class",n||"Message"]]].concat(n?[["span",[["class","Error.reason"]],t.toString()],["span",[["class",(n||"message")+("Error-GenericReadError"===n?".locations":".otherLocations")]]]]:t.args.map(function(t){return t.toString()})),["br",[],""],["span",[["class","Error.location"]],["span",[["class","location-reference"],["style","display:none"]],["span",[["class","location-offset"]],(e.startChar+1).toString()],["span",[["class","location-line"]],e.startRow.toString()],["span",[["class","location-column"]],e.startCol.toString()],["span",[["class","location-span"]],e.span.toString()],["span",[["class","location-id"]],e.source.toString()]]]],"structured-error":JSON.stringify({message:n?!1:t.args,location:e.toString()})};throw JSON.stringify(r)}function e(t,e){this.first=t,this.second=e,this.toString=function(){return"("+this.first.toString()+" "+this.second.toString()+")"}}function n(t,e,n,o){W.call(this),this.name=t,this.args=e,this.body=n,this.stx=o,this.toString=function(){return"(define ("+this.name.toString()+" "+this.args.join(" ")+")\n    "+this.body.toString()+")"}}function i(t,e,n){W.call(this),this.name=t,this.expr=e,this.stx=n,this.toString=function(){return"(define "+this.name.toString()+" "+this.expr.toString()+")"}}function a(t,e,n){W.call(this),this.names=t,this.expr=e,this.stx=n,this.toString=function(){return"(define-values ("+this.names.join(" ")+") "+this.expr.toString()+")"}}function s(t,e,n){W.call(this),this.name=t,this.fields=e,this.stx=n,this.toString=function(){return"(define-struct "+this.name.toString()+" ("+this.fields.toString()+"))"}}function c(t,e){W.call(this),this.exprs=t,this.stx=e,this.toString=function(){return"(begin "+this.exprs.join(" ")+")"}}function u(t,e,n){W.call(this),this.args=t,this.body=e,this.stx=n,this.toString=function(){return"(lambda ("+this.args.join(" ")+") "+this.body.toString()+")"}}function l(t,e,n){W.call(this),this.defs=t,this.body=e,this.stx=n,this.toString=function(){return"(local ("+this.defs.toString()+") "+this.body.toString()+")"}}function p(t,e,n){this.bindings=t,this.body=e,this.stx=n,this.toString=function(){return"(letrec ("+this.bindings.toString()+") ("+this.body.toString()+"))"}}function h(t,e,n){this.bindings=t,this.body=e,this.stx=n,this.toString=function(){return"(let ("+this.bindings.toString()+") ("+this.body.toString()+"))"}}function f(t,e,n){this.bindings=t,this.body=e,this.stx=n,this.toString=function(){return"(let* ("+this.bindings.toString()+") ("+this.body.toString()+"))"}}function d(t,e){this.clauses=t,this.stx=e,this.toString=function(){return"(cond\n    "+this.clauses.join("\n    ")+")"}}function m(t,e,n){W.call(this),this.expr=t,this.clauses=e,this.stx=n,this.toString=function(){return"(case "+this.expr.toString()+"\n    "+this.clauses.join("\n    ")+")"}}function g(t,e){this.exprs=t,this.stx=e,this.toString=function(){return"(and "+this.exprs.join(" ")+")"}}function y(t,e){this.exprs=t,this.stx=e,this.toString=function(){return"(or "+this.exprs.toString()+")"}}function v(t,e,n){W.call(this),this.func=t,this.args=e,this.stx=n,this.toString=function(){return"("+[this.func].concat(this.args).join(" ")+")"}}function w(t,e,n,o){W.call(this),this.predicate=t,this.consequence=e,this.alternative=n,this.stx=o,this.toString=function(){return"(if "+this.predicate.toString()+" "+this.consequence.toString()+" "+this.alternative.toString()+")"}}function b(t,e,n){W.call(this),this.predicate=t,this.exprs=e,this.stx=n,this.toString=function(){return"("+this.stx[0]+" "+this.predicate.toString()+" "+this.exprs.toString()+")"}}function x(t,e){W.call(this),this.val=t,this.stx=e}function E(t){W.call(this),this.val=t,this.toString=function(){if(this.val===!0)return"#t";if(this.val===!1)return"#f";if(this.val instanceof Char){var t=this.val.val;return"\b"===t?"#\\backspace":"	"===t?"#\\tab":"\n"===t?"#\\newline":" "===t?"#\\space":"\x0B"===t?"#\\vtab":this.val.toWrittenString()}return o.toWrittenString(this.val)}}function S(t){W.call(this),this.val=t,this.toString=function(){function t(t){return t instanceof Array&&2===t.length&&t[0]instanceof x&&("quasiquote"===t[0].val||"quote"===t[0].val||"unquote"===t[0].val||"unquote-splicing"===t[0].val)}function e(t){var e=t.val;return"quasiquote"===e?"`":"quote"===e?"'":"unquote"===e?",":"unquote-splicing"===e?",@":function(){throw"impossible quote-like string"}()}function n(o){return t(o)?e(o[0]).concat(n(o[1])):o instanceof Array?o.reduce(function(t,e){return t.concat(n(e))},"(").concat(")"):o.toString()}return"'"+n(this.val)}}function k(t){W.call(this),this.val=t,this.toString=function(){return","+this.val.toString()}}function C(t){W.call(this),this.val=t,this.toString=function(){return this.val instanceof Array?"`("+this.val.toString()+")":"`"+this.val.toString()}}function M(t){W.call(this),this.val=t,this.toString=function(){return",@"+this.val.toString()}}function T(t,e){W.call(this),this.spec=t,this.stx=e,this.toString=function(){return"(require "+this.spec.toString()+")"}}function I(t,e){W.call(this),this.clauses=t,this.stx=e,this.toString=function(){return"(provide "+this.clauses.toString()+")"}}function P(t,e,n){W.call(this),this.val=t,this.errorMsg=e,this.errorSpan=n,this.toString=function(){return this.val.toString()}}function q(t){return!(t instanceof i||t instanceof a||t instanceof s||t instanceof n||t instanceof I||t instanceof P||t instanceof T)}function B(t){return t instanceof i||t instanceof a||t instanceof s||t instanceof n}function N(t,e){this.name=t,this.bindings=e}function R(t,e,n,o){return this.name=t,this.moduleSource=e,this.permissions=n,this.loc=o,this.toString=function(){return this.name},this}function A(t,e,n,o,r,i,a){return this.name=t,this.moduleSource=e,this.minArity=n,this.isVarArity=o,this.permissions=r,this.isCps=i,this.loc=a,this.toString=function(){return this.name},this}function D(t,e,n,o,r,i,a,s,c){return this.name=t,this.moduleSource=e,this.fields=n,this.constructor=o,this.predicate=r,this.accessors=i,this.mutators=a,this.permissions=s,this.loc=c,this.toString=function(){return this.name},this}function F(t){var e=this;this.bindings=t||G(),this.lookup=function(t){return this.bindings.containsKey(t)?this.bindings.get(t):!1},this.peek=function(t){return 0==t?this:this instanceof O?"IMPOSSIBLE - peeked at an emptyEnv!":this.parent.peek(t-1)},this.contains=function(t){return this.lookup(t)!==!1},this.keys=this.bindings.keys,this.extend=function(t){return this.bindings.put(t.name,t),new plt.compiler.env(this.bindings)},this.extendFunction=function(t,e,n,o,r){return this.extend(new A(t,e,n,o,[],!1,r))},this.extendConstant=function(t,e,n){return this.extend(new R(t,e,[],n))},this.lookup_context=function(t){return t.context instanceof F?t.context.contains(t)?t.context.lookup(t):!1:e.contains(t)?e.lookup(t):!1},this.extendEnv_moduleBinding=function(t){return t.bindings.reduceRight(function(t,e){return t.extend(e)},this)},this.toString=function(){return this.bindings.values().reduce(function(t,e){return t+"\n  |---"+e.name},"")}}function O(){F.call(this),this.lookup=function(t,e){return new plt.compiler.unboundStackReference(t)}}function V(t){F.call(this),this.parent=t,this.lookup=function(t,e){return this.parent.lookup(t,e+1)}}function L(t,e,n){F.call(this),this.name=t,this.boxed=e,this.parent=n,this.lookup=function(t,e){return t===this.name?new plt.compiler.localStackReference(t,this.boxed,e):this.parent.lookup(t,e+1)}}function j(t,e,n){F.call(this),this.names=t,this.boxed=e,this.parent=n;this.lookup=function(t,e){var n=this.names.indexOf(t);return n>-1?new plt.compiler.globalStackReference(t,e,n):this.parent.lookup(t,e+1)}}function _(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;for(var n=[],o=0;o<=e.length;o++)n[o]=[o];for(var r=0;r<=t.length;r++)n[0][r]=r;for(o=1;o<=e.length;o++)for(r=1;r<=t.length;r++)e.charAt(o-1)==t.charAt(r-1)?n[o][r]=n[o-1][r-1]:n[o][r]=Math.min(n[o-1][r-1]+1,Math.min(n[o][r-1]+1,n[o-1][r]+1));return n[e.length][t.length]}function U(e,n,r,i,a,s,c,u,l,p,h,f,d,m){this.env=e||new O,this.modules=n||[],this.usedBindingsHash=r||G(),this.freeVariables=i||[],this.gensymCounter=a||0,this.providedNames=s||G(),this.definedNames=c||G(),this.sharedExpressions=u||G(),this.withLocationEmits=l||!0,this.allowRedefinition=p||!1,this.moduleResolver=h||plt.compiler.defaultModuleResolver,this.modulePathResolver=f||plt.compiler.defaultModulePathResolver,this.currentModulePath=d||Y,this.declaredPermissions=m||[],this.isRedefinition=function(t){return this.env.lookup(t)},this.usedBindings=this.usedBindingsHash.values,this.accumulateDeclaredPermission=function(t,e){return this.declaredPermissions=[[t,e]].concat(this.declaredPermissions),this},this.accumulateSharedExpression=function(t,e){var n=makeLabeledTranslation(this.gensymCounter,e);return this.sharedExpressions.put(n,t),this},this.accumulateDefinedBinding=function(e,n){if(plt.compiler.keywords.indexOf(e.name)>-1)t(new o.Message([new o.ColoredPart(e.name,e.loc),": this is a reserved keyword and cannot be used as a variable or function name"]),e.loc);else{if(this.allowRedefinition||!this.isRedefinition(e.name))return this.env.extend(e),this.definedNames.put(e.name,e),this;var r=this.env.lookup(e.name);r.loc?t(new o.Message([new o.ColoredPart(e.name,e.loc),": this name has a ",new o.ColoredPart("previous definition",r.loc)," and cannot be re-defined"]),e.loc):t(new o.Message([new o.ColoredPart(e.name,e.loc),": this name has a ","previous definition"," and cannot be re-defined"]),e.loc)}},this.accumulateDefinedBindings=function(t,e){var n=this;return t.forEach(function(t){n.accumulateDefinedBinding(t,e)}),this},this.accumulateModuleBindings=function(t){var e=this;return t.forEach(function(t){e.env.extend(t)}),this},this.accumulateModule=function(t){return this.modules=[t].concat(this.modules),this},this.accumulateBindingUse=function(t){var e=this.usedBindingsHash.get(t.name);return e&&e.moduleSource||this.usedBindingsHash.put(t.name,t),this},this.accumulateFreeVariableUse=function(t){return this.freeVariables=this.freeVariables.indexOf(t)>-1?this.freeVariables:[t].concat(this.freeVariables),this},this.gensym=function(t){return[this,new x(t+this.gensymCounter++)]},this.permissions=function(){function t(t,e,n){return n.indexOf(t)===e}function e(t,e){return(e instanceof A||e instanceof R)&&e.permissions.length>0?t.concat(e.permissions):t}return this.usedBindings().reduce(e,[]).filter(t)},this.getExposedBindings=function(){function e(e){function n(t){return i.definedNames.get(t)}i.definedNames.containsKey(e.symbl)||t(new o.Message(["provided-name-not-defined: ",e.symbl]));var a=r(a,i.definedNames.get(e.symbl));return e instanceof plt.compiler.provideBindingStructId?[n(a.constructor),n(a.predicate)].concat(a.accessors.map(n),a.mutators.map(n)):[a]}function n(t){var e=function(e){return e[0]===t.name},n=i.declaredPermissions.filter(e);return t.permissions=n.map(function(t){return t[1]}),t}function r(e,n){return!(e instanceof plt.compiler.provideBindingStructId)||n instanceof D?n:void t(new o.Message(["provided-structure-not-structure: ",n.symbl]))}var i=this;return bindings=bindings.reduce(function(t,n){return t.concat(e(n))},[]),bindings.map(n)},this.toString=function(){var t="pinfo-------------";return t+="\n**env****: "+this.env.toString(),t+="\n**modules**: "+this.modules.join(","),t+="\n**used bindings**: "+this.usedBindings(),t+="\n**free variables**: "+this.freeVariables.join(","),t+="\n**gensym counter**: "+this.gensymCounter,t+="\n**provided names**: "+this.providedNames.values(),t+="\n**defined names**: "+this.definedNames.values(),t+="\n**permissions**: "+this.permissions()}}function z(t){var e=["null","empty","true","false","eof","pi","e","js-undefined","js-null"].reduce(function(t,e){return t.extendConstant(e.toString(),'"moby/toplevel"',!1)},new O),n=new plt.compiler.pinfo,o=plt.compiler.topLevelModules.reduceRight(function(t,e){return t.extendEnv_moduleBinding(e)},e);return"moby"===t?n.env=o.extendEnv_moduleBinding(mobyModuleBinding):"base"===t&&(n.env=o),n}var $=function(t){var e=function(){};return e.prototype=t,new e},W=function(){this.toString=function(){return this.val.toString()},this.location=null};n.prototype=$(W.prototype),i.prototype=$(W.prototype),a.prototype=$(W.prototype),s.prototype=$(W.prototype),c.prototype=$(W.prototype),u.prototype=$(W.prototype),l.prototype=$(W.prototype),m.prototype=$(W.prototype),v.prototype=$(W.prototype),w.prototype=$(W.prototype),b.prototype=$(W.prototype),x.prototype=$(W.prototype),E.prototype=$(W.prototype),r.prototype.toString=r.prototype.toWrittenString=function(){var t=this.elts.filter(function(t){return void 0!==t}),e=t[t.length-1];return"#("+this.elts.map(function(t){return void 0===t?e:t})+")"},S.prototype=$(W.prototype),k.prototype=$(W.prototype),C.prototype=$(W.prototype),M.prototype=$(W.prototype),T.prototype=$(W.prototype),I.prototype=$(W.prototype),P.prototype=$(W.prototype);var G=o.makeLowLevelEqHash;plt.compiler.keywords=["cond","else","let","case","let*","letrec","quote","quasiquote","unquote","unquote-splicing","local","begin","if","or","and","when","unless","lambda","Î»","define","define-struct","define-values"],O.prototype=$(F.prototype),V.prototype=$(F.prototype),L.prototype=$(F.prototype),j.prototype=$(F.prototype);var Y="";plt.compiler.defaultModuleResolver=function(t){for(var e=0;e<plt.compiler.knownModules.length;e++)if(plt.compiler.knownModules[e].name===t)return plt.compiler.knownModules[e];return!1},plt.compiler.moduleGuess=function(t){return plt.compiler.knownModules.reduce(function(e,n){var o=_(n.name,t);return o<e.distance?{name:n.name,distance:o}:e},{name:t,distance:5})},plt.compiler.defaultModulePathResolver=function(t,e){var n=t.toString().split("/"),o=n[0];n.slice(1).join();return plt.compiler.knownCollections.indexOf(o)>-1&&plt.compiler.defaultModuleResolver(t.toString())||/^wescheme\/\w+$/.exec(t)},plt.compiler.throwError=t,plt.compiler.Program=W,plt.compiler.couple=e,plt.compiler.defFunc=n,plt.compiler.defVar=i,plt.compiler.defVars=a,plt.compiler.defStruct=s,plt.compiler.beginExpr=c,plt.compiler.lambdaExpr=u,plt.compiler.localExpr=l,plt.compiler.letrecExpr=p,plt.compiler.letExpr=h,plt.compiler.letStarExpr=f,plt.compiler.condExpr=d,plt.compiler.caseExpr=m,plt.compiler.andExpr=g,plt.compiler.orExpr=y,plt.compiler.callExpr=v,plt.compiler.ifExpr=w,plt.compiler.whenUnlessExpr=b,plt.compiler.symbolExpr=x,plt.compiler.literal=E,plt.compiler.quotedExpr=S,plt.compiler.unquotedExpr=k,plt.compiler.quasiquotedExpr=C,plt.compiler.unquoteSplice=M,plt.compiler.requireExpr=T,plt.compiler.provideStatement=I,plt.compiler.unsupportedExpr=P,plt.compiler.pinfo=U,plt.compiler.getBasePinfo=z,plt.compiler.isExpression=q,plt.compiler.isDefinition=B,plt.compiler.env=F,plt.compiler.emptyEnv=O,plt.compiler.localEnv=L,plt.compiler.globalEnv=j,plt.compiler.moduleBinding=N,plt.compiler.functionBinding=A,plt.compiler.constantBinding=R,plt.compiler.structBinding=D,plt.compiler.unnamedEnv=V}(),t.exports=plt.compiler},function(t,e,n){var o=n(4),r=n(5),i={};!function(){function t(){var t=document.createElement("span");return t.appendChild(document.createTextNode("(")),t.className="lParen",t}function e(){var t=document.createElement("span");return t.appendChild(document.createTextNode(")")),t.className="rParen",t}var n=function(t,e){t.appendChild(e)},a={}.hasOwnProperty,s=0,c=function(){return s++,s},u=function(t){return t&&!t._eqHashCode&&(t._eqHashCode=c()),t&&t._eqHashCode?t._eqHashCode:"string"==typeof t?t:0},l=function(){this.parentMap=q()};l.prototype.find=function(t){var e=this.parentMap.containsKey(t)?this.parentMap.get(t):t;if(e===t)return e;var n=this.find(e);return this.parentMap.put(t,n),n},l.prototype.merge=function(t,e){this.parentMap.put(this.find(t),this.find(e))};var p=function(){var t=!1,e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,n=function(){};return n.extend=function(n){var o=this.prototype;t=!0;var r=new this;t=!1;for(var i in n)r[i]="function"==typeof n[i]&&"function"==typeof o[i]&&e.test(n[i])?function(t,e){return function(){var n=this._super;this._super=o[t];var r=e.apply(this,arguments);return this._super=n,r}}(i,n[i]):n[i];var a=function(){!t&&this.init&&this.init.apply(this,arguments)};return a.prototype=r,a.constructor=a,a.extend=arguments.callee,a},n}(),h=function(t,e,n,o,r,i,a,s,c){this.name=t,this.type=e,this.numberOfArgs=n,this.numberOfFields=o,this.firstField=r,this.constructor=i,this.predicate=a,this.accessor=s,this.mutator=c};h.prototype.toString=function(){return"#<struct-type:"+this.name+">"},h.prototype.isEqual=function(t,e){return this===t};var f=function(t,e,n,o,r,i){e||(e={type:d,numberOfArgs:0,numberOfFields:0,firstField:0});var a=e.numberOfArgs,s=e.type.extend({init:function(t,e){i||(i=function(t){if(3==arguments.length)t(arguments[1]);else{var e,n=[];for(e=1;e<arguments.length-1;e++)n.push(arguments[e]);t(new Z(n))}});var s=this,c=function(e){var i;i=e instanceof Z?e.elts:[e];var c=i.slice(0,a);s._super(t,c);
for(var u=0;n>u;u++)s._fields.push(i[u+a]);for(var u=0;o>u;u++)s._fields.push(r)};e.unshift(c),e.push(x.makeInstance(t)),i.apply(null,e)}});return s.prototype.type=s,new h(t,s,n+a,n+o,e.firstField+e.numberOfFields,function(){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n]);return new s(t,e)},function(t){return t instanceof s},function(t,e){return t._fields[e+this.firstField]},function(t,e,n){t._fields[e+this.firstField]=n})},d=p.extend({init:function(t,e){this._constructorName=t,this._fields=[]},toWrittenString:function(t){var e,n=[];for(n.push("("),n.push(this._constructorName),e=0;e<this._fields.length;e++)n.push(" "),n.push(L(this._fields[e],t));return n.push(")"),n.join("")},toDisplayedString:function(t){return this.toWrittenString(t)},toDomNode:function(o){var r=document.createElement("div"),i=document.createElement("span");i.appendChild(document.createTextNode(this._constructorName));var a;for(r.appendChild(t()),r.appendChild(i),a=0;a<this._fields.length;a++)n(r,_(this._fields[a],o));return r.appendChild(e()),r},isEqual:function(t,e){if(void 0==t.type||this.type!==t.type||!(t instanceof this.type))return!1;for(var n=0;n<this._fields.length;n++)if(!K(this._fields[n],t._fields[n],e))return!1;return!0}});d.prototype.type=d;var m=function(t){this.pattern=t},g=function(t){this.pattern=t},y=function(t){this.path=t},v=function(t,e){this.bytes=t,this.mutable=void 0===e?!1:e};v.prototype.get=function(t){return this.bytes[t]},v.prototype.set=function(t,e){this.mutable&&(this.bytes[t]=e)},v.prototype.length=function(){return this.bytes.length},v.prototype.copy=function(t){return new v(this.bytes.slice(0),t)},v.prototype.subbytes=function(t,e){return(null==e||void 0==e)&&(e=this.bytes.length),new v(this.bytes.slice(t,e),!0)},v.prototype.toString=function(){for(var t="",e=0;e<this.bytes.length;e++)t+=String.fromCharCode(this.bytes[e]);return t},v.prototype.toDisplayedString=v.prototype.toString,v.prototype.toWrittenString=function(){for(var t=['#"'],e=0;e<this.bytes.length;e++)t.push(w(this.bytes[e]));return t.push('"'),t.join("")};var w=function(t){var e,n=[];switch(t){case 7:e="\\a";break;case 8:e="\\b";break;case 9:e="\\t";break;case 10:e="\\n";break;case 11:e="\\v";break;case 12:e="\\f";break;case 13:e="\\r";break;case 34:e='\\"';break;case 92:e="\\\\";break;default:val>=32&&val<=126?e=String.fromCharCode(val):n.push("\\"+val.toString(8))}return e},b=function(t,e){this.val=t,this.mutable=e};b.prototype.unbox=function(){return this.val},b.prototype.set=function(t){this.mutable&&(this.val=t)},b.prototype.toString=function(){return"#&"+this.val.toString()},b.prototype.toWrittenString=function(t){return"#&"+L(this.val,t)},b.prototype.toDisplayedString=function(t){return"#&"+j(this.val,t)},b.prototype.toDomNode=function(t){var e=document.createElement("span"),n=document.createElement("span");return n.appendChild(document.createTextNode("#&")),e.className="wescheme-box",e.appendChild(n),e.appendChild(_(this.val,t)),e},Logic={TRUE:!0,FALSE:!1},Boolean.prototype.toWrittenString=function(t){return this.valueOf()?"true":"false"},Boolean.prototype.toDisplayedString=Boolean.prototype.toWrittenString,Boolean.prototype.toString=function(){return this.valueOf()?"true":"false"},Boolean.prototype.isEqual=function(t,e){return this==t},Char=function(t){this.val=t},Char.makeInstance=function(t){return new Char(t)},Char.prototype.toString=function(){var t,e=this.val.charCodeAt(0);switch(e){case 0:t="#\\nul";break;case 8:t="#\\backspace";break;case 9:t="#\\tab";break;case 10:t="#\\newline";break;case 11:t="#\\vtab";break;case 12:t="#\\page";break;case 13:t="#\\return";break;case 20:t="#\\space";break;case 127:t="#\\rubout";break;default:if(e>=32&&126>=e)t="#\\"+this.val;else{for(var n=e.toString(16).toUpperCase();n.length<4;)n="0"+n;t="#\\u"+n}}return t},Char.prototype.toWrittenString=Char.prototype.toString,Char.prototype.toDisplayedString=function(t){return this.val},Char.prototype.getValue=function(){return this.val},Char.prototype.isEqual=function(t,e){return t instanceof Char&&this.val==t.val};var x=function(t){this.val=t},E={};x.makeInstance=function(t){return a.call(E,t)||(E[t]=new x(t)),E[t]},x.prototype.isEqual=function(t,e){return t instanceof x&&this.val==t.val},x.prototype.toString=function(){return this.val},x.prototype.toWrittenString=function(t){return this.val},x.prototype.toDisplayedString=function(t){return this.val},x.prototype.toDomNode=function(t){var e=document.createElement("span");return e.className="wescheme-symbol",e.style.fontFamily="monospace",e.style.whiteSpace="pre",e.appendChild(document.createTextNode("'"+this.val)),e};var S=function(t){this.val=t},k={};S.makeInstance=function(t){return a.call(k,t)||(k[t]=new S(t)),k[t]},S.prototype.isEqual=function(t,e){return t instanceof S&&this.val==t.val},S.prototype.toString=function(){return this.val},S.prototype.toWrittenString=function(t){return this.val},S.prototype.toDisplayedString=function(t){return this.val},Empty=function(){},Empty.EMPTY=new Empty,Empty.prototype.isEqual=function(t,e){return t instanceof Empty},Empty.prototype.reverse=function(){return this},Empty.prototype.first=function(){throw new Error("first can't be applied on empty.")},Empty.prototype.rest=function(){throw new Error("rest can't be applied on empty.")},Empty.prototype.isEmpty=function(){return!0},Empty.prototype.toWrittenString=function(t){return"empty"},Empty.prototype.toDisplayedString=function(t){return"empty"},Empty.prototype.toString=function(t){return"()"},Empty.prototype.append=function(t){return t},Cons=function(t,e){this.f=t,this.r=e},Cons.prototype.reverse=function(){for(var t=this,e=Empty.EMPTY;!t.isEmpty();)e=Cons.makeInstance(t.first(),e),t=t.rest();return e},Cons.makeInstance=function(t,e){return new Cons(t,e)},Cons.prototype.isEqual=function(t,e){return t instanceof Cons?K(this.first(),t.first(),e)&&K(this.rest(),t.rest(),e):Logic.FALSE},Cons.prototype.first=function(){return this.f},Cons.prototype.rest=function(){return this.r},Cons.prototype.isEmpty=function(){return!1},Cons.prototype.append=function(t){if(t===Empty.EMPTY)return this;for(var e=t,n=this.reverse();!n.isEmpty();)e=Cons.makeInstance(n.first(),e),n=n.rest();return e},Cons.prototype.toWrittenString=function(t){for(var e=["list"],n=this;n instanceof Cons;)e.push(L(n.first(),t)),n=n.rest();return n!==Empty.EMPTY?C(this,t,L):"("+e.join(" ")+")"};var C=function(t,e,n){for(var o=[],r=[];t instanceof Cons;)o.push("(cons "),o.push(n(t.first(),e)),o.push(" "),r.push(")"),t=t.rest();return o.push(n(t,e)),o.join("")+r.join("")};Cons.prototype.toString=Cons.prototype.toWrittenString,Cons.prototype.toDisplayedString=function(t){for(var e=["list"],n=this;n instanceof Cons;)e.push(j(n.first(),t)),n=n.rest();return n!==Empty.EMPTY?C(this,t,j):"("+e.join(" ")+")"},Cons.prototype.toDomNode=function(o){var r=document.createElement("span"),i=document.createElement("span");r.className="wescheme-cons",i.appendChild(document.createTextNode("list")),r.appendChild(t()),r.appendChild(i);for(var a=this;a instanceof Cons;)n(r,_(a.first(),o)),a=a.rest();return a!==Empty.EMPTY?M(this,o):(r.appendChild(e()),r)};var M=function(o,r){var i=document.createElement("span"),a=i,s=document.createElement("span");for(s.appendChild(document.createTextNode("cons")),a.className="wescheme-cons";o instanceof Cons;){a.appendChild(t()),a.appendChild(s),n(a,_(o.first(),r));var c=document.createElement("span");a.appendChild(c),a.appendChild(e()),a=c,o=o.rest()}return n(a,_(o,r)),i};Vector=function(t,e){if(this.elts=new Array(t),e)for(var n=0;t>n;n++)this.elts[n]=e[n];else for(var n=0;t>n;n++)this.elts[n]=void 0;this.mutable=!0},Vector.makeInstance=function(t,e){return new Vector(t,e)},Vector.prototype.length=function(){return this.elts.length},Vector.prototype.ref=function(t){return this.elts[t]},Vector.prototype.set=function(t,e){this.elts[t]=e},Vector.prototype.isEqual=function(t,e){if(null!=t&&void 0!=t&&t instanceof Vector){if(t.length()!=this.length())return!1;for(var n=0;n<this.length();n++)if(!K(this.elts[n],t.elts[n],e))return!1;return!0}return!1},Vector.prototype.toList=function(){for(var t=Empty.EMPTY,e=this.length()-1;e>=0;e--)t=Cons.makeInstance(this.elts[e],t);return t},Vector.prototype.toWrittenString=function(t){for(var e=[],n=0;n<this.length();n++)e.push(L(this.ref(n),t));return"#("+e.join(" ")+")"},Vector.prototype.toDisplayedString=function(t){for(var e=[],n=0;n<this.length();n++)e.push(j(this.ref(n),t));return"#("+e.join(" ")+")"},Vector.prototype.toDomNode=function(t){var e=document.createElement("span"),o=document.createElement("span"),r=document.createElement("span");o.appendChild(document.createTextNode("#(")),o.className="lParen",r.appendChild(document.createTextNode(")")),r.className="rParen",e.className="wescheme-vector",e.appendChild(o);for(var i=0;i<this.length();i++)n(e,_(this.ref(i),t));return e.appendChild(r),e};var T=function(t){this.chars=t,this.length=t.length,this.mutable=!0};T.makeInstance=function(t){return new T(t)},T.fromString=function(t){return T.makeInstance(t.split(""))},T.prototype.toString=function(){return this.chars.join("")},T.prototype.toWrittenString=function(t){return I(this.toString())},T.prototype.toDisplayedString=T.prototype.toString,T.prototype.copy=function(){return T.makeInstance(this.chars.slice(0))},T.prototype.substring=function(t,e){return(null==e||void 0==e)&&(e=this.length),T.makeInstance(this.chars.slice(t,e))},T.prototype.charAt=function(t){return this.chars[t]},T.prototype.charCodeAt=function(t){return this.chars[t].charCodeAt(0)},T.prototype.replace=function(t,e){return T.fromString(this.toString().replace(t,e))},T.prototype.isEqual=function(t,e){return t instanceof T||"string"==typeof t?this.toString()===t.toString():!1},T.prototype.set=function(t,e){this.chars[t]=e},T.prototype.toUpperCase=function(){return T.fromString(this.chars.join("").toUpperCase())},T.prototype.toLowerCase=function(){return T.fromString(this.chars.join("").toLowerCase())},T.prototype.match=function(t){return this.toString().match(t)};var I=function(t){return'"'+P(t)+'"'},P=function(t){for(var e=[],n=0;n<t.length;n++){var o=t.charCodeAt(n);switch(o){case 7:e.push("\\a");break;case 8:e.push("\\b");break;case 9:e.push("\\t");break;case 10:e.push("\\n");break;case 11:e.push("\\v");break;case 12:e.push("\\f");break;case 13:e.push("\\r");break;case 34:e.push('\\"');break;case 92:e.push("\\\\");break;default:if(o>=32&&126>=o)e.push(t.charAt(n));else{for(var r=o.toString(16).toUpperCase();r.length<4;)r="0"+r;e.push("\\u"+r)}}}return e.join("")},q=function(){return new r(function(t){return u(t)},function(t,e){return t===e})},B=function(t){this.hash=q(),this.mutable=!0};B=B,B.prototype.toWrittenString=function(t){for(var e=this.hash.keys(),n=[],o=0;o<e.length;o++){var r=i.toWrittenString(e[o],t),a=i.toWrittenString(this.hash.get(e[o]),t);n.push("("+r+" . "+a+")")}return"#hasheq("+n.join(" ")+")"},B.prototype.toDisplayedString=function(t){for(var e=this.hash.keys(),n=[],o=0;o<e.length;o++){var r=i.toDisplayedString(e[o],t),a=i.toDisplayedString(this.hash.get(e[o]),t);n.push("("+r+" . "+a+")")}return"#hasheq("+n.join(" ")+")"},B.prototype.isEqual=function(t,e){if(!(t instanceof B))return!1;if(this.hash.keys().length!=t.hash.keys().length)return!1;for(var n=this.hash.keys(),o=0;o<n.length;o++)if(!t.hash.containsKey(n[o])||!K(this.hash.get(n[o]),t.hash.get(n[o]),e))return!1;return!0};var N=function(t){this.hash=new r(function(t){return L(t)},function(t,e){return K(t,e,new l)}),this.mutable=!0};N=N,N.prototype.toWrittenString=function(t){for(var e=this.hash.keys(),n=[],o=0;o<e.length;o++){var r=i.toWrittenString(e[o],t),a=i.toWrittenString(this.hash.get(e[o]),t);n.push("("+r+" . "+a+")")}return"#hash("+n.join(" ")+")"},N.prototype.toDisplayedString=function(t){for(var e=this.hash.keys(),n=[],o=0;o<e.length;o++){var r=i.toDisplayedString(e[o],t),a=i.toDisplayedString(this.hash.get(e[o]),t);n.push("("+r+" . "+a+")")}return"#hash("+n.join(" ")+")"},N.prototype.isEqual=function(t,e){if(!(t instanceof N))return!1;if(this.hash.keys().length!=t.hash.keys().length)return!1;for(var n=this.hash.keys(),o=0;o<n.length;o++)if(!t.hash.containsKey(n[o])||!K(this.hash.get(n[o]),t.hash.get(n[o]),e))return!1;return!0};var R=function(t,e){this.name=t,this.obj=e};R.prototype.toString=function(){return"#<js-object:"+typeof this.obj+":"+this.name+">"},R.prototype.isEqual=function(t,e){return this.obj===t.obj};var A=function(t,e,n){this.startup=t,this.shutdown=e,this.startupArgs=n,this.shutdownArg=void 0};A.prototype.toString=function(){return"#<world-config>"},A.prototype.isEqual=function(t,e){if(!K(this.startup,t.startup,e)||!K(this.shutdown,t.shutdown,e)||this.startupArgs.length!=t.startupArgs.length||!K(this.shutdownArg,t.shutdownArg,e))return!1;for(var n=0;n<args.length;n++)if(!K(this.startupArgs[n],t.startupArgs[n],e))return!1;return!0};var D=f("effect",!1,0,0,!1,!1);D.type.prototype.invokeEffect=function(t){helpers.raise(i.incompleteExn(i.exnFail,"effect type created without using make-effect-type",[]))};var F=function(t,e,n,o,r,i){e||(e=D);var a=f(t,e,n,0,!1,r),s=a.firstField+a.numberOfFields;return a.type.prototype.invokeEffect=function(t,e){var n=new dt("update-world",1,!1,!0,function(e,n){helpers.check(e,n,helpers.procArityContains(1),"update-world","procedure (arity 1)",1),t(function(t,o){interpret.call(e,n,[t],o,function(t){throw t})},function(){e.v=tt})}),r=this._fields.slice(0,s);r.unshift(n),i(o,r,e)},a},O=f("render-effect",!1,0,0,!1,!1);O.type.prototype.callImplementation=function(t,e){helpers.raise(i.incompleteExn(i.exnFail,"render effect created without using make-render-effect-type",[]))};var V=function(t,e,n,o,r){e||(e=O);var i=f(t,e,n,0,!1,r),a=i.firstField+i.numberOfFields;return i.type.prototype.callImplementation=function(t,e){var n=this._fields.slice(0,a);t(o,n,e)},i},L=function(t,e){if(e||(e=q()),"object"==typeof t){if(e.containsKey(t))return"...";e.put(t,!0)}if(void 0==t||null==t)return"#<undefined>";if("string"==typeof t)return I(t.toString());if("object"!=typeof t&&"function"!=typeof t)return t.toString();var n;return n="undefined"!=typeof t.toWrittenString?t.toWrittenString(e):"undefined"!=typeof t.toDisplayedString?t.toDisplayedString(e):t.toString(),e.remove(t),n},j=function(t,e){if(e||(e=q()),"object"==typeof t){if(e.containsKey(t))return"...";e.put(t,!0)}if(void 0==t||null==t)return"#<undefined>";if("string"==typeof t)return t;if("object"!=typeof t&&"function"!=typeof t)return t.toString();var n;return n="undefined"!=typeof t.toDisplayedString?t.toDisplayedString(e):"undefined"!=typeof t.toWrittenString?t.toWrittenString(e):t.toString(),e.remove(t),n},_=function(t,e){if(e||(e=q()),W(t))return z(t);if("object"==typeof t){if(e.containsKey(t)){var n=document.createElement("span");return n.style["font-family"]="monospace",n.appendChild(document.createTextNode("...")),n}e.put(t,!0)}if(void 0==t||null==t){var n=document.createElement("span");return n.style["font-family"]="monospace",n.appendChild(document.createTextNode("#<undefined>")),n}if("string"==typeof t)return U(L(t));if("object"!=typeof t&&"function"!=typeof t)return U(t.toString());var o;return o=t.nodeType?t:"undefined"!=typeof t.toDomNode?t.toDomNode(e):U("undefined"!=typeof t.toWrittenString?t.toWrittenString(e):"undefined"!=typeof t.toDisplayedString?t.toDisplayedString(e):t.toString()),e.remove(t),o},U=function(t){var e,n,o=t.split("\n"),r=document.createElement("span");for(r.className="true"===t||"false"===t?"wescheme-boolean":"wescheme-string",r.style.fontFamily="monospace",r.style.whiteSpace="pre",o.length>0&&r.appendChild(document.createTextNode(o[0])),e=1;e<o.length;e++)n=document.createElement("br"),n.style.clear="left",r.appendChild(n),r.appendChild(document.createTextNode(o[e]));return r},z=function(t){var e;return o.isExact(t)?o.isInteger(t)?(e=document.createElement("span"),e.className="wescheme-number Integer",e.appendChild(document.createTextNode(t.toString())),e):o.isRational(t)?$(t):G(t)?(e=document.createElement("span"),e.className="wescheme-number Complex",e.appendChild(document.createTextNode(t.toString())),e):(e=document.createElement("span"),e.className="wescheme-number",e.appendChild(document.createTextNode(t.toString())),e):(e=document.createElement("span"),e.className="wescheme-number",e.appendChild(document.createTextNode(t.toString())),e)},$=function(t){var e=document.createElement("span"),n=o.toRepeatingDecimal(o.numerator(t),o.denominator(t),{limit:25}),r=document.createElement("span");if(r.appendChild(document.createTextNode(n[0]+"."+n[1])),e.appendChild(r),"..."===n[2])r.appendChild(document.createTextNode(n[2]));else if("0"!==n[2]){var i=document.createElement("span");i.style.textDecoration="overline",i.appendChild(document.createTextNode(n[2])),e.appendChild(i)}var a=document.createElement("span"),s=document.createElement("sup");s.appendChild(document.createTextNode(String(o.numerator(t))));var c=document.createElement("sub");c.appendChild(document.createTextNode(String(o.denominator(t))));var u=document.createElement("span");u.appendChild(document.createTextNode("/")),a.appendChild(s),a.appendChild(u),a.appendChild(c);var l=document.createElement("span");l.appendChild(e),l.appendChild(a),a.style.display="none";var p=!0;return l.onclick=function(t){p=!p,e.style.display=p?"inline":"none",a.style.display=p?"none":"inline"},l.style.cursor="pointer",l.className="wescheme-number Rational",l},W=o.isSchemeNumber,G=W,Y=function(t){return"string"==typeof t||t instanceof T},K=function(t,e,n){return t===e?!0:W(t)&&W(e)?o.equals(t,e):Y(t)&&Y(e)?t.toString()===e.toString():void 0==t||null==t?void 0==e||null==e:"object"==typeof t&&"object"==typeof e&&t.isEqual&&e.isEqual?n.find(t)===n.find(e)?!0:(n.merge(t,e),t.isEqual(e,n)):!1},X=function(t,e){this.v=t,this.isPreserved=e||!1},Z=function(t){this.elts=t};Z.prototype.toDomNode=function(t){var e=document.createElement("span");if(e.style.whiteSpace="pre",this.elts.length>0){e.appendChild(_(this.elts[0],t));for(var n=1;n<this.elts.length;n++)e.appendChild(document.createTextNode("\n")),e.appendChild(_(this.elts[n],t))}return e};var H=function(){};H.prototype.toString=function(){return"#<undefined>"};var Q=new H,J=function(){};J.prototype.toString=function(){return"#<void>"};var tt=new J,et=function(){};et.prototype.toString=function(){return"#<eof>"};var nt=new et,ot=function(t,e,n,o,r,i,a){this.name=t,this.locs=e,this.numParams=n,this.paramTypes=o,this.isRest=r,this.closureVals=i,this.body=a};ot.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};var rt=function(t,e){this.name=t,this.closures=e};rt.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<case-lambda-procedure:~a>",[this.name]):"#<case-lambda-procedure>"};var it=function(t,e){this.name=!1,this.vstack=t.slice(0),this.cstack=e.slice(0)};it.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};var at=function(){this.slots=[],this.definedMask=[]};at.prototype.addSlot=function(t){void 0===t?(this.slots.push(i.UNDEFINED),this.definedMask.push(!1)):(this.slots.push(t),t instanceof st&&t.value===i.UNDEFINED?this.definedMask.push(!1):this.definedMask.push(!0))},at.prototype.ref=function(t,e){if(this.slots[t]instanceof st){if(this.definedMask[t])return this.slots[t].value;helpers.raise(i.incompleteExn(i.exnFailContractVariable,new gt([new vt(this.slots[t].name,e),": this variable is not defined"]),[this.slots[t].name]))}else{if(this.definedMask[t])return this.slots[t];helpers.raise(i.incompleteExn(i.exnFailContractVariable,"variable has not been defined",[!1]))}},at.prototype.set=function(t,e){this.slots[t]instanceof st?(this.slots[t].value=e,this.definedMask[t]=!0):(this.slots[t]=e,this.definedMask[t]=!0)},at.prototype.length=function(){return this.slots.length};var st=function(t,e){this.name=t,this.value=e},ct=function(t,e){this.resolvedModuleName=t,this.variableName=e},ut=function(t,e){this.prefix=t,this.pos=e};ut.prototype.ref=function(){return this.prefix.ref(this.pos)},ut.prototype.set=function(t){this.prefix.set(this.pos,t)};var lt=function(t){this.dict=t||{}};lt.prototype.invoke=function(t){},lt.prototype.update=function(t,e){return this.dict[t.val]=e,this};var pt=function(t){this.dict=t};pt.prototype.toDomNode=function(t){var e=document.createElement("span");return e.appendChild(document.createTextNode("#<continuation-mark-set>")),e},pt.prototype.toWrittenString=function(t){return"#<continuation-mark-set>"},pt.prototype.toDisplayedString=function(t){return"#<continuation-mark-set>"},pt.prototype.ref=function(t){return this.dict.containsKey(t)?this.dict.get(t):[]};var ht=function(){},ft=new ht,dt=function(t,e,n,o,r){this.name=t,this.numParams=e,this.isRest=n,this.assignsToValueRegister=o,this.impl=r};dt.prototype.toString=function(){return"#<function:"+this.name+">"},dt.prototype.toWrittenString=function(t){return"#<function:"+this.name+">"},dt.prototype.toDisplayedString=function(t){return"#<function:"+this.name+">"},dt.prototype.toDomNode=function(t){var e=document.createElement("span");return e.className="wescheme-primproc",e.appendChild(document.createTextNode("#<function:"+this.name+">")),e};var mt=function(t,e){this.name=t,this.cases=e};mt.prototype.toDomNode=function(t){var e=document.createElement("span");return e.className="wescheme-caseprimitive",e.appendChild(document.createTextNode("#<function:"+this.name+">")),e},mt.prototype.toWrittenString=function(t){return"#<function:"+this.name+">"},mt.prototype.toDisplayedString=function(t){return"#<function:"+this.name+">"};var gt=function(t){this.args=t};gt.prototype.toString=function(){var t,e=[];for(t=0;t<this.args.length;t++)e.push(""+this.args[t]);return e.join("")};var yt=function(t){return t instanceof gt},vt=function(t,e){this.text=t,this.location=e},wt=function(t){return t instanceof vt};vt.prototype.toString=function(){return this.text+""};var bt=function(t){this.coloredParts=t},xt=function(t){return t instanceof bt};bt.prototype.toString=function(){var t,e=[];for(t=0;t<this.coloredParts.length;t++)e.push(this.coloredParts[t].text+"");return e.join("")};var Et=function(t,e,n){this.text=t,this.locations=e,this.solid=n},St=function(t){return t instanceof Et};Et.prototype.toString=function(){return this.text};var kt=function(t){var e,n=Empty.EMPTY;for(e=t.length-1;e>=0;e--)n=Cons.makeInstance(t[e],n);return n},Ct=function(t){return Vector.makeInstance(t.length,t)},Mt=function(t){if(t instanceof T)return t;if(t instanceof Array)return T.makeInstance(t);if("string"==typeof t)return T.fromString(t);throw i.internalError("makeString expects and array of 1-character strings or a string; given "+t.toString(),!1)},Tt=function(t){for(var e=new B;!t.isEmpty();)e.hash.put(t.first().first(),t.first().rest()),t=t.rest();return e},It=function(t){for(var e=new N;!t.isEmpty();)e.hash.put(t.first().first(),t.first().rest()),t=t.rest();return e},Pt=Ct(["<no-location>",0,0,0,0]),qt=function(t){return t===Pt},Bt=f("posn",!1,2,0,!1,!1),Nt=f("color",!1,4,0,!1,!1),Rt=f("arity-at-least",!1,1,0,!1,function(t,e,n){helpers.check(void 0,e,function(t){return o.isExact(t)&&o.isInteger(t)&&o.greaterThanOrEqual(t,0)},n,"exact non-negative integer",1),t(e)});i.symbol=x.makeInstance,i.rational=o.makeRational,i["float"]=o.makeFloat,i.complex=o.makeComplex,i.bignum=o.makeBignum,i.list=kt,i.vector=Ct,i.regexp=function(t){return new m(t)},i.byteRegexp=function(t){return new g(t)},i["char"]=Char.makeInstance,i.string=Mt,i.box=function(t){return new b(t,!0)},i.boxImmutable=function(t){return new b(t,!1)},i.path=function(t){return new y(t)},i.bytes=function(t,e){return new v(t,e)},i.keyword=function(t){return new S(t)},i.pair=function(t,e){return Cons.makeInstance(t,e)},i.hash=It,i.hashEq=Tt,i.jsObject=function(t,e){return new R(t,e)},i.toWrittenString=L,i.toDisplayedString=j,i.toDomNode=_,i.posn=Bt.constructor,i.posnX=function(t){return Bt.accessor(t,0)},i.posnY=function(t){return Bt.accessor(t,1)},i.color=function(t,e,n,o){return void 0===o&&(o=255),Nt.constructor(t,e,n,o)},i.colorRed=function(t){return Nt.accessor(t,0)},i.colorGreen=function(t){return Nt.accessor(t,1)},i.colorBlue=function(t){return Nt.accessor(t,2)},i.colorAlpha=function(t){return Nt.accessor(t,3)},i.arityAtLeast=Rt.constructor,i.arityValue=function(t){return Rt.accessor(t,0)},i.FALSE=Logic.FALSE,i.TRUE=Logic.TRUE,i.EMPTY=Empty.EMPTY,i.isEqual=K,i.isNumber=W,i.isSymbol=function(t){return t instanceof x},i.isChar=function(t){return t instanceof Char},i.isString=Y,i.isPair=function(t){return t instanceof Cons},i.isVector=function(t){return t instanceof Vector},i.isBox=function(t){return t instanceof b},i.isHash=function(t){return t instanceof B||t instanceof N},i.isByteString=function(t){return t instanceof v},i.isStruct=function(t){return t instanceof d},i.isPosn=Bt.predicate,i.isArityAtLeast=Rt.predicate,i.isColor=Nt.predicate,i.isFunction=function(t){return t instanceof dt||t instanceof mt||t instanceof ot||t instanceof rt||t instanceof it},i.getProcedureType=function(t){return t instanceof dt?"PrimProc":t instanceof mt?"CasePrimitive":t instanceof ot?"ClosureValue":t instanceof rt?"CaseLambdaValue":t instanceof it?"ContinuationClosureValue":!1},i.isJsObject=function(t){return t instanceof R},i.UnionFind=l,i.cons=Cons.makeInstance,i.UNDEFINED=Q,i.VOID=tt,i.EOF=nt,i.ValuesWrapper=Z,i.ClosureValue=ot,i.ContinuationPrompt=ht,i.defaultContinuationPrompt=ft,i.ContinuationClosureValue=it,i.CaseLambdaValue=rt,i.PrimProc=dt,i.CasePrimitive=mt,i.contMarkRecordControl=function(t){return new lt(t)},i.isContMarkRecordControl=function(t){return t instanceof lt},i.continuationMarkSet=function(t){return new pt(t)},i.isContinuationMarkSet=function(t){return t instanceof pt},i.PrefixValue=at,i.GlobalBucket=st,i.ModuleVariableRecord=ct,i.VariableReference=ut,i.Box=b,i.ThreadCell=X,i.Class=p,i.makeStructureType=f,i.isStructType=function(t){return t instanceof h},i.makeLowLevelEqHash=q;var At=function(t,e){this.val=t,this.contMarks=e?e:!1};i.internalError=function(t,e){return new At(t,e)},i.isInternalError=function(t){return t instanceof At};var Dt=function(t){this.val=t};i.schemeError=function(t){return new Dt(t)},i.isSchemeError=function(t){return t instanceof Dt};var Ft=function(t,e,n){this.constructor=t,this.msg=e,this.otherArgs=n};i.incompleteExn=function(t,e,n){return new Ft(t,e,n)},i.isIncompleteExn=function(t){return t instanceof Ft};var Ot=f("exn",!1,2,0,!1,function(t,e,n,o){helpers.check(void 0,n,i.isContinuationMarkSet,o,"continuation mark set",2),t(new Z([e,n]))});i.exn=Ot.constructor,i.isExn=Ot.predicate,i.exnMessage=function(t){return Ot.accessor(t,0)},i.exnContMarks=function(t){return Ot.accessor(t,1)},i.exnSetContMarks=function(t,e){Ot.mutator(t,1,e)};var Vt=f("exn:break",Ot,1,0,!1,function(t,e,n,o,r){t(new Z([e,n,o]))});i.exnBreak=Vt.constructor,i.isExnBreak=Vt.predicate,i.exnBreakContinuation=function(t){return Vt.accessor(t,0)};var Lt=f("exn:fail",Ot,0,0,!1,!1);i.exnFail=Lt.constructor,i.isExnFail=Lt.predicate;var jt=f("exn:fail:contract",Lt,0,0,!1,!1);i.exnFailContract=jt.constructor,i.isExnFailContract=jt.predicate;var _t=f("exn:fail:contract:arity",jt,0,0,!1,!1);i.exnFailContractArity=jt.constructor,i.isExnFailContractArity=jt.predicate;var Ut=f("exn:fail:contract:variable",jt,1,0,!1,!1);i.exnFailContractVariable=jt.constructor,i.isExnFailContractVariable=jt.predicate,i.exnFailContractVariableId=function(t){return Ut.accessor(t,0)};var zt=f("exn:fail:contract:division-by-zero",jt,0,0,!1,!1);i.exnFailContractDivisionByZero=zt.constructor,i.isExnFailContractDivisionByZero=zt.predicate;var $t=f("exn:fail:contract:arity:position",_t,1,0,!1,!1);i.exnFailContractArityWithPosition=$t.constructor,i.isExnFailContractArityWithPosition=$t.predicate,i.exnFailContractArityWithPositionLocations=function(t){return $t.accessor(t,0)},i.worldConfig=function(t,e,n){return new A(t,e,n)},i.isWorldConfig=function(t){return t instanceof A},i.makeEffectType=F,i.isEffectType=function(t){return t instanceof h&&t.type.prototype.invokeEffect?!0:!1},i.isEffect=D.predicate,i.makeRenderEffectType=V,i.isRenderEffectType=function(t){return t instanceof h&&t.type.prototype.callImplementation?!0:!1},i.isRenderEffect=O.predicate,i.NoLocation=Pt,i.isNoLocation=qt,i.ColoredPart=vt,i.Message=gt,i.isColoredPart=wt,i.isMessage=yt,i.GradientPart=bt,i.isGradientPart=xt,i.MultiPart=Et,i.isMultiPart=St,i.Vector=Vector}(),t.exports=i},function(t,e,n){var o;o=e,function(){"use strict";function t(t){return new RegExp("^([+-]?["+t+"]+)/(["+t+"]+)$")}function e(t,e){var n="[+-]",o="[+-]?",r=s(t),i="["+c(t)+"]",a="["+r+"]+",u=a+"/"+a,l=o+u,p=a,h="["+r+"]*\\.["+r+"]+",f="["+r+"]+\\.["+r+"]*",d="(?:"+p+"|"+h+"|"+f+")",m="(?:inf.0|nan.0|inf.f|nan.f)",g="(?:"+d+"|"+u+")",y=g+"(?:"+i+o+a+")?",v="(?:"+y+"|"+m+")",w="(?:"+o+y+"|"+n+m+")",b=new RegExp("^("+l+")("+n+u+"?)i$"),x=new RegExp("^("+w+")?("+n+v+"?)i$"),E=new RegExp("^("+w+")@("+w+")$"),S=e.match(b),k=e.match(x),C=e.match(E);return S?S:k?k:C?C:!1}function n(t){return new RegExp("^[+-]?["+t+"]+$")}function i(t){var e="(["+t+"]*)\\.(["+t+"]+)",n="(["+t+"]+)\\.(["+t+"]*)";return new RegExp("^(?:([+-]?)("+e+"|"+n+"))$")}function a(t,e){var n="["+t+"]+",o="["+t+"]*\\.["+t+"]+",r="["+t+"]+\\.["+t+"]*";return new RegExp("^(?:([+-]?(?:"+n+"|"+o+"|"+r+"))["+e+"]([+-]?["+t+"]+))$")}function s(t){return 2===t?"01":8===t?"0-7":10===t?"0-9":16===t?"0-9a-fA-F":ve("digitsForRadix: invalid radix",this,t)}function c(t){return 2===t||8===t||10===t?"defsl":16===t?"sl":ve("expMarkForRadix: invalid radix",this,t)}function u(t){this.defaultp=function(){return 0==t},this.exactp=function(){return 1==t},this.inexactp=function(){return 2==t}}function l(t,n,o,r){var i=e(n,t);return i?oo.makeInstance(p(i[1]||"0",n,o),p("+"===i[2]?"1":"-"===i[2]?"-1":i[2],n,o)):p(t,n,o,r)}function p(e,o,r,u){var l=e.match(t(s(o)));if(l)return Yn.makeInstance(p(l[1],o,r),p(l[2],o,r));if("+nan.0"===e||"-nan.0"===e)return Kn.nan;if("+inf.0"===e)return Kn.inf;if("-inf.0"===e)return Kn.neginf;if("-0.0"===e)return to;var f=e.match(i(s(o)));if(f){var d=void 0!==f[3]?f[3]:f[5],m=void 0!==f[4]?f[4]:f[6];return h(f[1],d,m,o,r)}var g=e.match(a(s(o),c(o)));if(g){var y=p(g[1],o,r),v=p(g[2],o,r);return Re(y,ze(o,v))}if(e.match(n(s(o)))){var w=parseInt(e,o);return kn(w)?wo(e):r.intAsExactp()?w:Kn.makeInstance(w)}return u?(0===e.length&&ve("no digits"),void ve("bad number: "+e,this)):!1}function h(t,e,n,o,r){var t="-"==t?-1:1,i=""===e?0:r.intAsExactp()?f(e,o):parseInt(e,o),a=""===n?0:r.intAsExactp()?f(n,o):parseInt(n,o),s=r.intAsExactp()?ze(o,n.length):Math.pow(o,n.length),c=""===n?0:r.intAsExactp()?De(a,s):a/s,u=function(t){return"number"==typeof t?Kn.makeInstance(t):t.toInexact()};return r.floatAsInexactp()?u(Re(t,qe(i,c))):Re(t,qe(i,c))}function f(t,e){return p(t,e,u.on,!0)}function d(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function m(){return new d(null)}function g(t,e,n,o,r,i){for(;--i>=0;){var a=e*this[t++]+n[o]+r;r=Math.floor(a/67108864),n[o++]=67108863&a}return r}function y(t,e,n,o,r,i){for(var a=32767&e,s=e>>15;--i>=0;){var c=32767&this[t],u=this[t++]>>15,l=s*c+u*a;c=a*c+((32767&l)<<15)+n[o]+(1073741823&r),r=(c>>>30)+(l>>>15)+s*u+(r>>>30),n[o++]=1073741823&c}return r}function v(t,e,n,o,r,i){for(var a=16383&e,s=e>>14;--i>=0;){var c=16383&this[t],u=this[t++]>>14,l=s*c+u*a;c=a*c+((16383&l)<<14)+n[o]+r,r=(c>>28)+(l>>14)+s*u,n[o++]=268435455&c}return r}function w(t){return mo.charAt(t)}function b(t,e){var n=go[t.charCodeAt(e)];return null==n?-1:n}function x(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function E(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function S(t){var e=m();return e.fromInt(t),e}function k(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,
this.s=0;for(var o=t.length,r=!1,i=0;--o>=0;){var a=8==n?255&t[o]:b(t,o);0>a?"-"==t.charAt(o)&&(r=!0):(r=!1,0==i?this[this.t++]=a:i+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-i)-1)<<i,this[this.t++]=a>>this.DB-i):this[this.t-1]|=a<<i,i+=n,i>=this.DB&&(i-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,i>0&&(this[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),r&&d.ZERO.subTo(this,this)}function C(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function M(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,o=(1<<e)-1,r=!1,i=[],a=this.t,s=this.DB-a*this.DB%e;if(a-- >0)for(s<this.DB&&(n=this[a]>>s)>0&&(r=!0,i.push(w(n)));a>=0;)e>s?(n=(this[a]&(1<<s)-1)<<e-s,n|=this[--a]>>(s+=this.DB-e)):(n=this[a]>>(s-=e)&o,0>=s&&(s+=this.DB,--a)),n>0&&(r=!0),r&&i.push(w(n));return r?i.join(""):"0"}function T(){var t=m();return d.ZERO.subTo(this,t),t}function I(){return this.s<0?this.negate():this}function P(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(e=this.s<0?t.t-n:n-t.t,0!=e)return e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0}function q(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function B(){return this.t<=0?0:this.DB*(this.t-1)+q(this[this.t-1]^this.s&this.DM)}function N(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s}function R(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s}function A(t,e){var n,o=t%this.DB,r=this.DB-o,i=(1<<r)-1,a=Math.floor(t/this.DB),s=this.s<<o&this.DM;for(n=this.t-1;n>=0;--n)e[n+a+1]=this[n]>>r|s,s=(this[n]&i)<<o;for(n=a-1;n>=0;--n)e[n]=0;e[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function D(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)return void(e.t=0);var o=t%this.DB,r=this.DB-o,i=(1<<o)-1;e[0]=this[n]>>o;for(var a=n+1;a<this.t;++a)e[a-n-1]|=(this[a]&i)<<r,e[a-n]=this[a]>>o;o>0&&(e[this.t-n-1]|=(this.s&i)<<r),e.t=this.t-n,e.clamp()}function F(t,e){for(var n=0,o=0,r=Math.min(t.t,this.t);r>n;)o+=this[n]-t[n],e[n++]=o&this.DM,o>>=this.DB;if(t.t<this.t){for(o-=t.s;n<this.t;)o+=this[n],e[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<t.t;)o-=t[n],e[n++]=o&this.DM,o>>=this.DB;o-=t.s}e.s=0>o?-1:0,-1>o?e[n++]=this.DV+o:o>0&&(e[n++]=o),e.t=n,e.clamp()}function O(t,e){var n=this.abs(),o=t.abs(),r=n.t;for(e.t=r+o.t;--r>=0;)e[r]=0;for(r=0;r<o.t;++r)e[r+n.t]=n.am(0,o[r],e,r,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&d.ZERO.subTo(e,e)}function V(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var o=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,o,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()}function L(t,e,n){var o=t.abs();if(!(o.t<=0)){var r=this.abs();if(r.t<o.t)return null!=e&&e.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=m());var i=m(),a=this.s,s=t.s,c=this.DB-q(o[o.t-1]);c>0?(o.lShiftTo(c,i),r.lShiftTo(c,n)):(o.copyTo(i),r.copyTo(n));var u=i.t,l=i[u-1];if(0!=l){var p=l*(1<<this.F1)+(u>1?i[u-2]>>this.F2:0),h=this.FV/p,f=(1<<this.F1)/p,g=1<<this.F2,y=n.t,v=y-u,w=null==e?m():e;for(i.dlShiftTo(v,w),n.compareTo(w)>=0&&(n[n.t++]=1,n.subTo(w,n)),d.ONE.dlShiftTo(u,w),w.subTo(i,i);i.t<u;)i[i.t++]=0;for(;--v>=0;){var b=n[--y]==l?this.DM:Math.floor(n[y]*h+(n[y-1]+g)*f);if((n[y]+=i.am(0,b,n,v,0,u))<b)for(i.dlShiftTo(v,w),n.subTo(w,n);n[y]<--b;)n.subTo(w,n)}null!=e&&(n.drShiftTo(u,e),a!=s&&d.ZERO.subTo(e,e)),n.t=u,n.clamp(),c>0&&n.rShiftTo(c,n),0>a&&d.ZERO.subTo(n,n)}}}function j(t){var e=m();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(d.ZERO)>0&&t.subTo(e,e),e}function _(t){this.m=t}function U(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function z(t){return t}function $(t){t.divRemTo(this.m,null,t)}function W(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function G(t,e){t.squareTo(e),this.reduce(e)}function Y(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function K(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function X(t){var e=m();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(d.ZERO)>0&&this.m.subTo(e,e),e}function Z(t){var e=m();return t.copyTo(e),this.reduce(e),e}function H(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],o=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(n=e+this.m.t,t[n]+=this.m.am(0,o,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Q(t,e){t.squareTo(e),this.reduce(e)}function J(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function tt(){return 0==(this.t>0?1&this[0]:this.s)}function et(t,e){if(t>4294967295||1>t)return d.ONE;var n=m(),o=m(),r=e.convert(this),i=q(t)-1;for(r.copyTo(n);--i>=0;)if(e.sqrTo(n,o),(t&1<<i)>0)e.mulTo(o,r,n);else{var a=n;n=o,o=a}return e.revert(n)}function nt(t,e){var n;return n=256>t||e.isEven()?new _(e):new K(e),this.exp(t,n)}function ot(){var t=m();return this.copyTo(t),t}function rt(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function it(){return 0==this.t?this.s:this[0]<<24>>24}function at(){return 0==this.t?this.s:this[0]<<16>>16}function st(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function ct(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function ut(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),o=S(n),r=m(),i=m(),a="";for(this.divRemTo(o,r,i);r.signum()>0;)a=(n+i.intValue()).toString(t).substr(1)+a,r.divRemTo(o,r,i);return i.intValue().toString(t)+a}function lt(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),o=Math.pow(e,n),r=!1,i=0,a=0,s=0;s<t.length;++s){var c=b(t,s);0>c?"-"==t.charAt(s)&&0==this.signum()&&(r=!0):(a=e*a+c,++i>=n&&(this.dMultiply(o),this.dAddOffset(a,0),i=0,a=0))}i>0&&(this.dMultiply(Math.pow(e,i)),this.dAddOffset(a,0)),r&&d.ZERO.subTo(this,this)}function pt(t,e,n){if("number"==typeof e)if(2>t)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(d.ONE.shiftLeft(t-1),wt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(d.ONE.shiftLeft(t-1),this);else{var o=[],r=7&t;o.length=(t>>3)+1,e.nextBytes(o),r>0?o[0]&=(1<<r)-1:o[0]=0,this.fromString(o,256)}}function ht(){var t=this.t,e=[];e[0]=this.s;var n,o=this.DB-t*this.DB%8,r=0;if(t-- >0)for(o<this.DB&&(n=this[t]>>o)!=(this.s&this.DM)>>o&&(e[r++]=n|this.s<<this.DB-o);t>=0;)8>o?(n=(this[t]&(1<<o)-1)<<8-o,n|=this[--t]>>(o+=this.DB-8)):(n=this[t]>>(o-=8)&255,0>=o&&(o+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(e[r++]=n);return e}function ft(t){return 0==this.compareTo(t)}function dt(t){return this.compareTo(t)<0?this:t}function mt(t){return this.compareTo(t)>0?this:t}function gt(t,e,n){var o,r,i=Math.min(t.t,this.t);for(o=0;i>o;++o)n[o]=e(this[o],t[o]);if(t.t<this.t){for(r=t.s&this.DM,o=i;o<this.t;++o)n[o]=e(this[o],r);n.t=this.t}else{for(r=this.s&this.DM,o=i;o<t.t;++o)n[o]=e(r,t[o]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()}function yt(t,e){return t&e}function vt(t){var e=m();return this.bitwiseTo(t,yt,e),e}function wt(t,e){return t|e}function bt(t){var e=m();return this.bitwiseTo(t,wt,e),e}function xt(t,e){return t^e}function Et(t){var e=m();return this.bitwiseTo(t,xt,e),e}function St(t,e){return t&~e}function kt(t){var e=m();return this.bitwiseTo(t,St,e),e}function Ct(){for(var t=m(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function Mt(t){var e=m();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Tt(t){var e=m();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function It(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function Pt(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+It(this[t]);return this.s<0?this.t*this.DB:-1}function qt(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Bt(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=qt(this[n]^e);return t}function Nt(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function Rt(t,e){var n=d.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n}function At(t){return this.changeBit(t,wt)}function Dt(t){return this.changeBit(t,St)}function Ft(t){return this.changeBit(t,xt)}function Ot(t,e){for(var n=0,o=0,r=Math.min(t.t,this.t);r>n;)o+=this[n]+t[n],e[n++]=o&this.DM,o>>=this.DB;if(t.t<this.t){for(o+=t.s;n<this.t;)o+=this[n],e[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<t.t;)o+=t[n],e[n++]=o&this.DM,o>>=this.DB;o+=t.s}e.s=0>o?-1:0,o>0?e[n++]=o:-1>o&&(e[n++]=this.DV+o),e.t=n,e.clamp()}function Vt(t){var e=m();return this.addTo(t,e),e}function Lt(t){var e=m();return this.subTo(t,e),e}function jt(t){var e=m();return this.multiplyTo(t,e),e}function _t(t){var e=m();return this.divRemTo(t,e,null),e}function Ut(t){var e=m();return this.divRemTo(t,null,e),e}function zt(t){var e=m(),n=m();return this.divRemTo(t,e,n),[e,n]}function $t(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Wt(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Gt(){}function Yt(t){return t}function Kt(t,e,n){t.multiplyTo(e,n)}function Xt(t,e){t.squareTo(e)}function Zt(t){return this.bnpExp(t,new Gt)}function Ht(t,e,n){var o=Math.min(this.t+t.t,e);for(n.s=0,n.t=o;o>0;)n[--o]=0;var r;for(r=n.t-this.t;r>o;++o)n[o+this.t]=this.am(0,t[o],n,o,0,this.t);for(r=Math.min(t.t,e);r>o;++o)this.am(0,t[o],n,o,0,e-o);n.clamp()}function Qt(t,e,n){--e;var o=n.t=this.t+t.t-e;for(n.s=0;--o>=0;)n[o]=0;for(o=Math.max(e-this.t,0);o<t.t;++o)n[this.t+o-e]=this.am(e-o,t[o],n,0,0,this.t+o-e);n.clamp(),n.drShiftTo(1,n)}function Jt(t){this.r2=m(),this.q3=m(),d.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function te(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=m();return t.copyTo(e),this.reduce(e),e}function ee(t){return t}function ne(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function oe(t,e){t.squareTo(e),this.reduce(e)}function re(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function ie(t,e){var n,o,r=t.bitLength(),i=S(1);if(0>=r)return i;n=18>r?1:48>r?3:144>r?4:768>r?5:6,o=8>r?new _(e):e.isEven()?new Jt(e):new K(e);var a=[],s=3,c=n-1,u=(1<<n)-1;if(a[1]=o.convert(this),n>1){var l=m();for(o.sqrTo(a[1],l);u>=s;)a[s]=m(),o.mulTo(l,a[s-2],a[s]),s+=2}var p,h,f=t.t-1,d=!0,g=m();for(r=q(t[f])-1;f>=0;){for(r>=c?p=t[f]>>r-c&u:(p=(t[f]&(1<<r+1)-1)<<c-r,f>0&&(p|=t[f-1]>>this.DB+r-c)),s=n;0==(1&p);)p>>=1,--s;if((r-=s)<0&&(r+=this.DB,--f),d)a[p].copyTo(i),d=!1;else{for(;s>1;)o.sqrTo(i,g),o.sqrTo(g,i),s-=2;s>0?o.sqrTo(i,g):(h=i,i=g,g=h),o.mulTo(g,a[p],i)}for(;f>=0&&0==(t[f]&1<<r);)o.sqrTo(i,g),h=i,i=g,g=h,--r<0&&(r=this.DB-1,--f)}return o.revert(i)}function ae(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var o=e;e=n,n=o}var r=e.getLowestSetBit(),i=n.getLowestSetBit();if(0>i)return e;for(i>r&&(i=r),i>0&&(e.rShiftTo(i,e),n.rShiftTo(i,n));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return i>0&&n.lShiftTo(i,n),n}function se(t){if(0>=t)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var o=this.t-1;o>=0;--o)n=(e*n+this[o])%t;return n}function ce(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return d.ZERO;for(var n=t.clone(),o=this.clone(),r=S(1),i=S(0),a=S(0),s=S(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(r.isEven()&&i.isEven()||(r.addTo(this,r),i.subTo(t,i)),r.rShiftTo(1,r)):i.isEven()||i.subTo(t,i),i.rShiftTo(1,i);for(;o.isEven();)o.rShiftTo(1,o),e?(a.isEven()&&s.isEven()||(a.addTo(this,a),s.subTo(t,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);n.compareTo(o)>=0?(n.subTo(o,n),e&&r.subTo(a,r),i.subTo(s,i)):(o.subTo(n,o),e&&a.subTo(r,a),s.subTo(i,s))}return 0!=o.compareTo(d.ONE)?d.ZERO:s.compareTo(t)>=0?s.subtract(t):s.signum()<0?(s.addTo(t,s),s.signum()<0?s.add(t):s):s}function ue(t){var e,n=this.abs();if(1==n.t&&n[0]<=yo[yo.length-1]){for(e=0;e<yo.length;++e)if(n[0]==yo[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<yo.length;){for(var o=yo[e],r=e+1;r<yo.length&&vo>o;)o*=yo[r++];for(o=n.modInt(o);r>e;)if(o%yo[e++]==0)return!1}return n.millerRabin(t)}function le(t){var e=this.subtract(d.ONE),n=e.getLowestSetBit();if(0>=n)return!1;var o=e.shiftRight(n);t=t+1>>1,t>yo.length&&(t=yo.length);for(var r=m(),i=0;t>i;++i){r.fromInt(yo[i]);var a=r.modPow(o,this);if(0!=a.compareTo(d.ONE)&&0!=a.compareTo(e)){for(var s=1;s++<n&&0!=a.compareTo(e);)if(a=a.modPowInt(2,this),0==a.compareTo(d.ONE))return!1;if(0!=a.compareTo(e))return!1}}return!0}function pe(t){return function(){var e=this.toInexact();return e[t].apply(e,arguments)}}var he=o,fe=function(t,e,n){return n=n||{},function(o,r){return n.isXSpecialCase&&n.isXSpecialCase(o)?n.onXSpecialCase(o,r):n.isYSpecialCase&&n.isYSpecialCase(r)?n.onYSpecialCase(o,r):"number"==typeof o&&"number"==typeof r?t(o,r):("number"==typeof o&&(o=ye(o,r)),"number"==typeof r&&(r=ye(r,o)),o.level<r.level&&(o=o.liftTo(r)),r.level<o.level&&(r=r.liftTo(o)),e(o,r))}},de=function(t){if(isNaN(t)||!isFinite(t))return Kn.makeInstance(t);var e=Math.floor(t);return e===t?kn(e)?wo(me(t+"")):e:Kn.makeInstance(t)},me=function(t){var e,n,o=t.match(a(s(10),c(10)));return o?(e=o[1].match(/^([^.]*)(.*)$/),n=Number(o[2]),0===e[2].length?e[1]+ge(n):n>=e[2].length-1?e[1]+e[2].substring(1)+ge(n-(e[2].length-1)):e[1]+e[2].substring(1,1+n)):t},ge=function(t){var e=[];e.length=t;for(var n=0;t>n;n++)e[n]="0";return e.join("")},ye=function(t,e){switch(e.level){case 0:return wo(t);case 1:return new Yn(t,1);case 2:return new Kn(t);case 3:return new oo(t,0);default:ve("IMPOSSIBLE: cannot lift fixnum integer to "+e.toString(),t,e)}},ve=function(t,e,n){he.onThrowRuntimeError(t,e,n)},we=function(t,e,n){throw new Error(t)},be=function(t){return"number"==typeof t||t instanceof Yn||t instanceof Kn||t instanceof oo||t instanceof d},xe=function(t){return"number"==typeof t||be(t)&&t.isRational()},Ee=function(t){return"number"==typeof t||be(t)&&t.isReal()},Se=function(t){return"number"==typeof t||be(t)&&t.isExact()},ke=function(t){return"number"==typeof t?!1:be(t)&&t.isInexact()},Ce=function(t){return"number"==typeof t||be(t)&&t.isInteger()},Me=function(t){return"number"==typeof t||be(t)&&t.isInteger()&&t.isExact()},Te=function(t){return"number"==typeof t?t:t.toFixnum()},Ie=function(t){return"number"==typeof t?t:t.toExact()},Pe=function(t){return"number"==typeof t?Kn.makeInstance(t):t.toInexact()},qe=function(t,e){var n;return"number"==typeof t&&"number"==typeof e&&(n=t+e,kn(n))?wo(t).add(wo(e)):t instanceof Kn&&e instanceof Kn?t.add(e):Be(t,e)},Be=fe(function(t,e){var n=t+e;return kn(n)?wo(t).add(wo(e)):n},function(t,e){return t.add(e)},{isXSpecialCase:function(t){return Me(t)&&Rn(t)},onXSpecialCase:function(t,e){return e},isYSpecialCase:function(t){return Me(t)&&Rn(t)},onYSpecialCase:function(t,e){return t}}),Ne=fe(function(t,e){var n=t-e;return kn(n)?wo(t).subtract(wo(e)):n},function(t,e){return t.subtract(e)},{isXSpecialCase:function(t){return Me(t)&&Rn(t)},onXSpecialCase:function(t,e){return Cn(e)},isYSpecialCase:function(t){return Me(t)&&Rn(t)},onYSpecialCase:function(t,e){return t}}),Re=function(t,e){var n;return"number"==typeof t&&"number"==typeof e?(n=t*e,kn(n)?wo(t).multiply(wo(e)):n):t instanceof Kn&&e instanceof Kn?t.multiply(e):Ae(t,e)},Ae=fe(function(t,e){var n=t*e;return kn(n)?wo(t).multiply(wo(e)):n},function(t,e){return t.multiply(e)},{isXSpecialCase:function(t){return Me(t)&&(Rn(t)||An(t)||Dn(t))},onXSpecialCase:function(t,e){return Rn(t)?0:An(t)?e:Dn(t)?Cn(e):void 0},isYSpecialCase:function(t){return Me(t)&&(Rn(t)||An(t)||Dn(t))},onYSpecialCase:function(t,e){return Rn(e)?0:An(e)?t:Dn(e)?Cn(t):void 0}}),De=fe(function(t,e){Rn(e)&&ve("/: division by zero",t,e);var n=t/e;return kn(n)?wo(t).divide(wo(e)):Math.floor(n)!==n?Yn.makeInstance(t,e):n},function(t,e){return t.divide(e)},{isXSpecialCase:function(t){return Oe(t,0)},onXSpecialCase:function(t,e){return Oe(e,0)&&ve("/: division by zero",t,e),0},isYSpecialCase:function(t){return Oe(t,0)},onYSpecialCase:function(t,e){ve("/: division by zero",t,e)}}),Fe=fe(function(t,e){return t===e},function(t,e){return t.equals(e)}),Oe=function(t,e){if(t===e)return!0;if("number"==typeof t&&"number"==typeof e)return t===e;if(t===to||e===to)return t===e;if(t instanceof oo||e instanceof oo)return Oe(ln(t),ln(e))&&Oe(un(t),un(e));var n=Se(t),o=Se(e);return(n&&o||!n&&!o)&&Fe(t,e)},Ve=function(t,e,n){return Ue(Xe(Ne(t,e)),n)},Le=fe(function(t,e){return t>=e},function(t,e){return Ee(t)&&Ee(e)||ve(">=: couldn't be applied to complex number",t,e),t.greaterThanOrEqual(e)}),je=fe(function(t,e){return e>=t},function(t,e){return Ee(t)&&Ee(e)||ve("<=: couldn't be applied to complex number",t,e),t.lessThanOrEqual(e)}),_e=fe(function(t,e){return t>e},function(t,e){return Ee(t)&&Ee(e)||ve(">: couldn't be applied to complex number",t,e),t.greaterThan(e)}),Ue=fe(function(t,e){return e>t},function(t,e){return Ee(t)&&Ee(e)||ve("<: couldn't be applied to complex number",t,e),t.lessThan(e)}),ze=function(){var t=fe(function(t,e){var n=Math.pow(t,e);return kn(n)?wo(t).expt(wo(e)):n},function(t,e){return Fe(e,0)?qe(e,1):t.expt(e)});return function(e,n){return Fe(n,0)?qe(n,1):Ee(n)&&Ue(n,0)?t(De(1,e),Cn(n)):t(e,n)}}(),$e=function(t){return Oe(t,0)?1:"number"==typeof t?Kn.makeInstance(Math.exp(t)):t.exp()},We=function(t,e){Ce(t)||ve("modulo: the first argument "+t+" is not an integer.",t,e),Ce(e)||ve("modulo: the second argument "+e+" is not an integer.",t,e);var n;return"number"==typeof t?(n=t%e,0>e?0>=n?n:n+e:0>n?n+e:n):(n=Bn(Ze(t),Ze(e)),Ue(e,0)?je(n,0)?n:qe(n,e):Ue(n,0)?qe(n,e):n)},Ge=function(t){return"number"==typeof t?t:t.numerator()},Ye=function(t){return"number"==typeof t?1:t.denominator()},Ke=function(t){if("number"==typeof t){if(t>=0){var e=Math.sqrt(t);return Math.floor(e)===e?e:Kn.makeInstance(e)}return oo.makeInstance(0,Ke(-t))}return t.sqrt()},Xe=function(t){return"number"==typeof t?Math.abs(t):t.abs()},Ze=function(t){return"number"==typeof t?t:t.floor()},He=function(t){return"number"==typeof t?t:t.ceiling()},Qe=function(t){return"number"==typeof t?t:t.conjugate()},Je=function(t){return"number"==typeof t?Math.abs(t):t.magnitude()},tn=function(t){return Oe(t,1)?0:"number"==typeof t?Kn.makeInstance(Math.log(t)):t.log()},en=function(t){return"number"==typeof t?t>0?0:Kn.pi:t.angle()},nn=function(t){return Oe(t,0)?0:"number"==typeof t?Kn.makeInstance(Math.tan(t)):t.tan()},on=function(t){return Oe(t,0)?0:"number"==typeof t?Kn.makeInstance(Math.atan(t)):t.atan()},rn=function(t){return Oe(t,0)?1:"number"==typeof t?Kn.makeInstance(Math.cos(t)):t.cos()},an=function(t){return Oe(t,0)?0:"number"==typeof t?Kn.makeInstance(Math.sin(t)):t.sin()},sn=function(t){return Oe(t,1)?0:"number"==typeof t?Kn.makeInstance(Math.acos(t)):t.acos()},cn=function(t){return Oe(t,0)?0:"number"==typeof t?Kn.makeInstance(Math.asin(t)):t.asin()},un=function(t){return"number"==typeof t?0:t.imaginaryPart()},ln=function(t){return"number"==typeof t?t:t.realPart()},pn=function(t){return"number"==typeof t?t:t.round()},hn=function(t){return Re(t,t)},fn=function(t){return Ce(t)||ve("integer-sqrt: the argument "+t.toString()+" is not an integer.",t),"number"==typeof t?0>t?oo.makeInstance(0,Math.floor(Math.sqrt(-t))):Math.floor(Math.sqrt(t)):t.integerSqrt()},dn=function(t,e){Ce(t)||ve("gcd: the argument "+t.toString()+" is not an integer.",t);for(var n,o,r=Xe(t),i=0;i<e.length;i++)for(o=Xe(e[i]),Ce(o)||ve("gcd: the argument "+o.toString()+" is not an integer.",o);!Rn(o);)n=r,r=o,o=Bn(n,o);return r},mn=function(t,e){Ce(t)||ve("lcm: the argument "+t.toString()+" is not an integer.",t);var n=Xe(t);if(Rn(n))return 0;for(var o=0;o<e.length;o++){Ce(e[o])||ve("lcm: the argument "+e[o].toString()+" is not an integer.",e[o]);var r=Nn(n,e[o]);if(Rn(r))return 0;n=De(Re(n,e[o]),r)}return n},gn=function(t,e){return Ce(t)||ve("quotient: the first argument "+t.toString()+" is not an integer.",t),Ce(e)||ve("quotient: the second argument "+e.toString()+" is not an integer.",e),Ln(t,e)},yn=function(t,e){return Ce(t)||ve("remainder: the first argument "+t.toString()+" is not an integer.",t),Ce(e)||ve("remainder: the second argument "+e.toString()+" is not an integer.",e),jn(t,e)},vn=function(t){return Oe(t,0)?Kn.makeInstance(1):De(qe($e(t),$e(Cn(t))),2)},wn=function(t){return De(Ne($e(t),$e(Cn(t))),2)},bn=function(t,e){return Oe(e,0)?t:oo.makeInstance(Re(t,rn(e)),Re(t,an(e)))},xn=function(t){return"number"==typeof t?isFinite(t):t.isFinite()},En=-9e15,Sn=9e15,kn=function(t){return En>t||t>Sn},Cn=function(t){return"number"==typeof t?-t:t.negate()},Mn=function(t){return De(t,2)},Tn=function(t){return Re(t,ro)},In=function(t,e){for(var n=1;;){if(Rn(e))return n;Fe(We(e,2),0)?(t=Re(t,t),e=De(e,2)):(n=Re(n,t),e=Ne(e,1))}},Pn=function(t,e,n){return n=n||{},function(o,r){if(o instanceof Yn?o=Ge(o):o instanceof oo&&(o=ln(o)),r instanceof Yn?r=Ge(r):r instanceof oo&&(r=ln(r)),"number"==typeof o&&"number"==typeof r){var i=t(o,r);if(!kn(i)||n.ignoreOverflow)return i}return o instanceof Kn||r instanceof Kn?n.doNotCoerseToFloating?t(Te(o),Te(r)):Kn.makeInstance(t(Te(o),Te(r))):("number"==typeof o&&(o=wo(o)),"number"==typeof r&&(r=wo(r)),e(o,r))}},qn=function(t,e,n){return n=n||{},function(o){if(o instanceof Yn?o=Ge(o):o instanceof oo&&(o=ln(o)),"number"==typeof o){var r=t(o);if(!kn(r)||n.ignoreOverflow)return r}return o instanceof Kn?t(Te(o)):("number"==typeof o&&(o=wo(o)),e(o))}},Bn=Pn(function(t,e){return t%e},function(t,e){return j.call(t,e)}),Nn=Pn(function(t,e){for(var n;0!==e;)n=t,t=e,e=n%e;return t},function(t,e){return ae.call(t,e)}),Rn=qn(function(t){return 0===t},function(t){return ft.call(t,d.ZERO)}),An=qn(function(t){return 1===t},function(t){return ft.call(t,d.ONE)}),Dn=qn(function(t){return-1===t},function(t){return ft.call(t,d.NEGATIVE_ONE)}),Fn=Pn(function(t,e){return t+e},function(t,e){return Vt.call(t,e)}),On=Pn(function(t,e){return t-e},function(t,e){return Lt.call(t,e)}),Vn=Pn(function(t,e){return t*e},function(t,e){return jt.call(t,e)}),Ln=Pn(function(t,e){return(t-t%e)/e},function(t,e){return _t.call(t,e)}),jn=Pn(function(t,e){return t%e},function(t,e){return Ut.call(t,e)}),_n=Pn(function(t,e){return t/e},function(t,e){return Te(t)/Te(e)},{ignoreOverflow:!0,doNotCoerseToFloating:!0}),Un=Pn(function(t,e){return t===e},function(t,e){return ft.call(t,e)},{doNotCoerseToFloating:!0}),zn=Pn(function(t,e){return t>e},function(t,e){return P.call(t,e)>0},{doNotCoerseToFloating:!0}),$n=Pn(function(t,e){return e>t},function(t,e){return P.call(t,e)<0},{doNotCoerseToFloating:!0}),Wn=Pn(function(t,e){return t>=e},function(t,e){return P.call(t,e)>=0},{doNotCoerseToFloating:!0}),Gn=Pn(function(t,e){return e>=t},function(t,e){return P.call(t,e)<=0},{doNotCoerseToFloating:!0}),Yn=function(t,e){this.n=t,this.d=e};Yn.prototype.toString=function(){return An(this.d)?this.n.toString()+"":this.n.toString()+"/"+this.d.toString()},Yn.prototype.level=1,Yn.prototype.liftTo=function(t){return 2===t.level?new Kn(_n(this.n,this.d)):3===t.level?new oo(this,0):ve("invalid level of Number",this,t)},Yn.prototype.isFinite=function(){return!0},Yn.prototype.equals=function(t){return t instanceof Yn&&Un(this.n,t.n)&&Un(this.d,t.d)},Yn.prototype.isInteger=function(){return An(this.d)},Yn.prototype.isRational=function(){return!0},Yn.prototype.isReal=function(){return!0},Yn.prototype.add=function(t){return Yn.makeInstance(Fn(Vn(this.n,t.d),Vn(this.d,t.n)),Vn(this.d,t.d))},Yn.prototype.subtract=function(t){return Yn.makeInstance(On(Vn(this.n,t.d),Vn(this.d,t.n)),Vn(this.d,t.d))},Yn.prototype.negate=function(){return Yn.makeInstance(-this.n,this.d)},Yn.prototype.multiply=function(t){return Yn.makeInstance(Vn(this.n,t.n),Vn(this.d,t.d))},Yn.prototype.divide=function(t){return(Rn(this.d)||Rn(t.n))&&ve("/: division by zero",this,t),Yn.makeInstance(Vn(this.n,t.d),Vn(this.d,t.n))},Yn.prototype.toExact=function(){return this},Yn.prototype.toInexact=function(){return Kn.makeInstance(this.toFixnum())},Yn.prototype.isExact=function(){return!0},Yn.prototype.isInexact=function(){return!1},Yn.prototype.toFixnum=function(){return _n(this.n,this.d)},Yn.prototype.numerator=function(){return this.n},Yn.prototype.denominator=function(){return this.d},Yn.prototype.greaterThan=function(t){return zn(Vn(this.n,t.d),Vn(this.d,t.n))},Yn.prototype.greaterThanOrEqual=function(t){return Wn(Vn(this.n,t.d),Vn(this.d,t.n))},Yn.prototype.lessThan=function(t){return $n(Vn(this.n,t.d),Vn(this.d,t.n))},Yn.prototype.lessThanOrEqual=function(t){return Gn(Vn(this.n,t.d),Vn(this.d,t.n))},Yn.prototype.integerSqrt=function(){var t=Ke(this);return xe(t)?Ie(Ze(t)):Ee(t)?Ie(Ze(t)):oo.makeInstance(Ie(Ze(ln(t))),Ie(Ze(un(t))))},Yn.prototype.sqrt=function(){if(Wn(this.n,0)){var t=Ke(this.n),e=Ke(this.d);return Fe(Ze(t),t)&&Fe(Ze(e),e)?Yn.makeInstance(t,e):Kn.makeInstance(_n(t,e))}var t=Ke(Cn(this.n)),e=Ke(this.d);return Fe(Ze(t),t)&&Fe(Ze(e),e)?oo.makeInstance(0,Yn.makeInstance(t,e)):oo.makeInstance(0,Kn.makeInstance(_n(t,e)))},Yn.prototype.abs=function(){return Yn.makeInstance(Xe(this.n),this.d)},Yn.prototype.floor=function(){var t=Ln(this.n,this.d);return $n(this.n,0)?Ne(t,1):t},Yn.prototype.ceiling=function(){var t=Ln(this.n,this.d);return $n(this.n,0)?t:qe(t,1)},Yn.prototype.conjugate=function(){return this},Yn.prototype.magnitude=Yn.prototype.abs,Yn.prototype.log=function(){return Kn.makeInstance(Math.log(this.n/this.d))},Yn.prototype.angle=function(){return Rn(this.n)?0:zn(this.n,0)?0:Kn.pi},Yn.prototype.tan=function(){return Kn.makeInstance(Math.tan(_n(this.n,this.d)))},Yn.prototype.atan=function(){return Kn.makeInstance(Math.atan(_n(this.n,this.d)))},Yn.prototype.cos=function(){return Kn.makeInstance(Math.cos(_n(this.n,this.d)))},Yn.prototype.sin=function(){return Kn.makeInstance(Math.sin(_n(this.n,this.d)))},Yn.prototype.expt=function(t){return Me(t)&&Le(t,0)?In(this,t):Kn.makeInstance(Math.pow(_n(this.n,this.d),_n(t.n,t.d)))},Yn.prototype.exp=function(){return Kn.makeInstance(Math.exp(_n(this.n,this.d)))},Yn.prototype.acos=function(){return Kn.makeInstance(Math.acos(_n(this.n,this.d)))},Yn.prototype.asin=function(){return Kn.makeInstance(Math.asin(_n(this.n,this.d)))},Yn.prototype.imaginaryPart=function(){return 0},Yn.prototype.realPart=function(){return this},Yn.prototype.round=function(){var t=Fe(this.d,2),e=$n(this.n,0),n=this.n;e&&(n=Cn(n));var o=Ln(n,this.d);if(t)o=qe(o,1);else{var r=jn(n,this.d);_e(Re(r,2),this.d)&&(o=qe(o,1))}return e&&(o=Cn(o)),o},Yn.makeInstance=function(t,e){void 0===t&&ve("n undefined",t,e),void 0===e&&(e=1),Rn(e)&&ve("division by zero: "+t+"/"+e),$n(e,0)&&(t=Cn(t),e=Cn(e));var n=Nn(Xe(t),Xe(e));return t=Ln(t,n),e=Ln(e,n),An(e)||Rn(t)?t:new Yn(t,e)};var Kn=function(t){this.n=t};Kn=Kn;var Xn=new Kn(Number.NaN),Zn=new Kn(Number.POSITIVE_INFINITY),Hn=new Kn(Number.NEGATIVE_INFINITY),Qn=new Kn(Number.POSITIVE_INFINITY),Jn=new Kn(Number.NEGATIVE_INFINITY),to=new Kn(-0),eo=new Kn(0);Kn.pi=new Kn(Math.PI),Kn.e=new Kn(Math.E),Kn.nan=Xn,Kn.inf=Zn,Kn.neginf=Hn,Kn.makeInstance=function(t){return isNaN(t)?Kn.nan:t===Number.POSITIVE_INFINITY?Kn.inf:t===Number.NEGATIVE_INFINITY?Kn.neginf:0===t?1/t===-(1/0)?to:eo:new Kn(t)},Kn.prototype.isExact=function(){return!1},Kn.prototype.isInexact=function(){return!0},Kn.prototype.isFinite=function(){return isFinite(this.n)||this===Qn||this===Jn},Kn.prototype.toExact=function(){(!isFinite(this.n)||isNaN(this.n))&&ve("toExact: no exact representation for "+this,this);var t=this.n.toString(),e=t.match(/^(.*)\.(.*)$/);if(e){var n=(parseInt(e[1]),parseInt(e[2]),Math.pow(10,e[2].length));return Yn.makeInstance(Math.round(this.n*n),n)}return this.n},Kn.prototype.toInexact=function(){return this},Kn.prototype.isInexact=function(){return!0},Kn.prototype.level=2,Kn.prototype.liftTo=function(t){return 3===t.level?new oo(this,0):ve("invalid level of Number",this,t)},Kn.prototype.toString=function(){if(isNaN(this.n))return"+nan.0";if(this.n===Number.POSITIVE_INFINITY)return"+inf.0";if(this.n===Number.NEGATIVE_INFINITY)return"-inf.0";if(this===to)return"-0.0";var t=this.n.toString();return t.match("\\.")?t:t+".0"},Kn.prototype.equals=function(t,e){return t instanceof Kn&&this.n===t.n},Kn.prototype.isRational=function(){return this.isFinite()},Kn.prototype.isInteger=function(){return this.isFinite()&&this.n===Math.floor(this.n)},Kn.prototype.isReal=function(){return!0};var no=function(t){return Ue(t,0)?-1:_e(t,0)?1:t===to?-1:0};Kn.prototype.add=function(t){return this.isFinite()&&t.isFinite()?Kn.makeInstance(this.n+t.n):isNaN(this.n)||isNaN(t.n)?Xn:this.isFinite()&&!t.isFinite()?t:!this.isFinite()&&t.isFinite()?this:no(this)*no(t)===1?this:Xn},Kn.prototype.subtract=function(t){return this.isFinite()&&t.isFinite()?Kn.makeInstance(this.n-t.n):isNaN(this.n)||isNaN(t.n)?Xn:this.isFinite()||t.isFinite()?this.isFinite()?Re(t,-1):this:no(this)===no(t)?Xn:this},Kn.prototype.negate=function(){return Kn.makeInstance(-this.n)},Kn.prototype.multiply=function(t){return Kn.makeInstance(this.n*t.n)},Kn.prototype.divide=function(t){return Kn.makeInstance(this.n/t.n)},Kn.prototype.toFixnum=function(){return this.n},Kn.prototype.numerator=function(){var t=this.n.toString(),e=t.match(/^(.*)\.(.*)$/);if(e){var n=parseInt(e[2]),o=Math.pow(10,e[2].length),r=Nn(o,n),i=o/r;return Kn.makeInstance(Math.round(this.n*i))}return this},Kn.prototype.denominator=function(){var t=this.n.toString(),e=t.match(/^(.*)\.(.*)$/);if(e){var n=parseInt(e[2]),o=Math.pow(10,e[2].length),r=Nn(o,n);return Kn.makeInstance(Math.round(o/r))}return Kn.makeInstance(1)},Kn.prototype.floor=function(){return Kn.makeInstance(Math.floor(this.n))},Kn.prototype.ceiling=function(){return Kn.makeInstance(Math.ceil(this.n))},Kn.prototype.greaterThan=function(t){return this.n>t.n},Kn.prototype.greaterThanOrEqual=function(t){return this.n>=t.n},Kn.prototype.lessThan=function(t){return this.n<t.n},Kn.prototype.lessThanOrEqual=function(t){return this.n<=t.n},Kn.prototype.integerSqrt=function(){return this===to?this:Ce(this)?this.n>=0?Kn.makeInstance(Math.floor(Math.sqrt(this.n))):oo.makeInstance(eo,Kn.makeInstance(Math.floor(Math.sqrt(-this.n)))):void ve("integerSqrt: can only be applied to an integer",this)},Kn.prototype.sqrt=function(){if(this.n<0){var t=oo.makeInstance(0,Kn.makeInstance(Math.sqrt(-this.n)));return t}return Kn.makeInstance(Math.sqrt(this.n))},Kn.prototype.abs=function(){return Kn.makeInstance(Math.abs(this.n))},Kn.prototype.log=function(){return this.n<0?new oo(this,0).log():Kn.makeInstance(Math.log(this.n))},Kn.prototype.angle=function(){return 0===this.n?0:this.n>0?0:Kn.pi},Kn.prototype.tan=function(){return Kn.makeInstance(Math.tan(this.n))},Kn.prototype.atan=function(){return Kn.makeInstance(Math.atan(this.n))},Kn.prototype.cos=function(){return Kn.makeInstance(Math.cos(this.n))},Kn.prototype.sin=function(){return Kn.makeInstance(Math.sin(this.n))},Kn.prototype.expt=function(t){return 1===this.n?t.isFinite()?this:isNaN(t.n)?this:this:Kn.makeInstance(Math.pow(this.n,t.n));
},Kn.prototype.exp=function(){return Kn.makeInstance(Math.exp(this.n))},Kn.prototype.acos=function(){return Kn.makeInstance(Math.acos(this.n))},Kn.prototype.asin=function(){return Kn.makeInstance(Math.asin(this.n))},Kn.prototype.imaginaryPart=function(){return 0},Kn.prototype.realPart=function(){return this},Kn.prototype.round=function(){return isFinite(this.n)?this===to?this:.5===Math.abs(Math.floor(this.n)-this.n)?Math.floor(this.n)%2===0?Kn.makeInstance(Math.floor(this.n)):Kn.makeInstance(Math.ceil(this.n)):Kn.makeInstance(Math.round(this.n)):this},Kn.prototype.conjugate=function(){return this},Kn.prototype.magnitude=Kn.prototype.abs;var oo=function(t,e){this.r=t,this.i=e};oo.makeInstance=function(t,e){return void 0===e&&(e=0),Se(e)&&Ce(e)&&Rn(e)?t:((ke(t)||ke(e))&&(t=Pe(t),e=Pe(e)),new oo(t,e))},oo.prototype.toString=function(){var t=this.r.toString(),e=this.i.toString();return"-"===e[0]||"+"===e[0]?t+e+"i":t+"+"+e+"i"},oo.prototype.isFinite=function(){return xn(this.r)&&xn(this.i)},oo.prototype.isRational=function(){return xe(this.r)&&Oe(this.i,0)},oo.prototype.isInteger=function(){return Ce(this.r)&&Oe(this.i,0)},oo.prototype.toExact=function(){return oo.makeInstance(Ie(this.r),Ie(this.i))},oo.prototype.toInexact=function(){return oo.makeInstance(Pe(this.r),Pe(this.i))},oo.prototype.isExact=function(){return Se(this.r)&&Se(this.i)},oo.prototype.isInexact=function(){return ke(this.r)||ke(this.i)},oo.prototype.level=3,oo.prototype.liftTo=function(t){ve("Don't know how to lift Complex number",this,t)},oo.prototype.equals=function(t){var e=t instanceof oo&&Fe(this.r,t.r)&&Fe(this.i,t.i);return e},oo.prototype.greaterThan=function(t){return this.isReal()&&t.isReal()||ve(">: expects argument of type real number",this,t),_e(this.r,t.r)},oo.prototype.greaterThanOrEqual=function(t){return this.isReal()&&t.isReal()||ve(">=: expects argument of type real number",this,t),Le(this.r,t.r)},oo.prototype.lessThan=function(t){return this.isReal()&&t.isReal()||ve("<: expects argument of type real number",this,t),Ue(this.r,t.r)},oo.prototype.lessThanOrEqual=function(t){return this.isReal()&&t.isReal()||ve("<=: expects argument of type real number",this,t),je(this.r,t.r)},oo.prototype.abs=function(){return Fe(this.i,0).valueOf()||ve("abs: expects argument of type real number",this),Xe(this.r)},oo.prototype.toFixnum=function(){return Fe(this.i,0).valueOf()||ve("toFixnum: expects argument of type real number",this),Te(this.r)},oo.prototype.numerator=function(){return this.isReal()||ve("numerator: can only be applied to real number",this),Ge(this.n)},oo.prototype.denominator=function(){return this.isReal()||ve("floor: can only be applied to real number",this),Ye(this.n)},oo.prototype.add=function(t){return oo.makeInstance(qe(this.r,t.r),qe(this.i,t.i))},oo.prototype.subtract=function(t){return oo.makeInstance(Ne(this.r,t.r),Ne(this.i,t.i))},oo.prototype.negate=function(){return oo.makeInstance(Cn(this.r),Cn(this.i))},oo.prototype.multiply=function(t){if(t.isReal())return oo.makeInstance(Re(this.r,t.r),Re(this.i,t.r));var e=Ne(Re(this.r,t.r),Re(this.i,t.i)),n=qe(Re(this.r,t.i),Re(this.i,t.r));return oo.makeInstance(e,n)},oo.prototype.divide=function(t){var e,n,o,r,i,a,s;if(t.isReal())return oo.makeInstance(De(this.r,t.r),De(this.i,t.r));if(this.isInexact()||t.isInexact())return e=this.r,n=this.i,o=t.r,r=t.i,je(Xe(r),Xe(o))?(i=De(r,o),a=De(qe(e,Re(n,i)),qe(o,Re(r,i))),s=De(Ne(n,Re(e,i)),qe(o,Re(r,i)))):(i=De(o,r),a=De(qe(Re(e,i),n),qe(Re(o,i),r)),s=De(Ne(Re(n,i),e),qe(Re(o,i),r))),oo.makeInstance(a,s);var c=Qe(t),u=Re(this,c),l=ln(Re(t,c)),p=oo.makeInstance(De(ln(u),l),De(un(u),l));return p},oo.prototype.conjugate=function(){var t=oo.makeInstance(this.r,Ne(0,this.i));return t},oo.prototype.magnitude=function(){var t=qe(Re(this.r,this.r),Re(this.i,this.i));return Ke(t)},oo.prototype.isReal=function(){return Oe(this.i,0)},oo.prototype.integerSqrt=function(){return Ce(this)?fn(this.r):void ve("integerSqrt: can only be applied to an integer",this)},oo.prototype.sqrt=function(){if(this.isReal())return Ke(this.r);var t=qe(this.magnitude(),this.r),e=Ke(Mn(t)),n=De(this.i,Ke(Re(t,2)));return oo.makeInstance(e,n)},oo.prototype.log=function(){var t=this.magnitude(),e=this.angle(),n=qe(tn(t),Tn(e));return n},oo.prototype.angle=function(){if(this.isReal())return en(this.r);if(Fe(0,this.r)){var t=Mn(Kn.pi);return _e(this.i,0)?t:Cn(t)}var t=on(De(Xe(this.i),Xe(this.r)));return _e(this.r,0)?_e(this.i,0)?t:Cn(t):_e(this.i,0)?Ne(Kn.pi,t):Ne(t,Kn.pi)};var ro=oo.makeInstance(0,1),io=oo.makeInstance(0,-1);oo.prototype.tan=function(){return De(this.sin(),this.cos())},oo.prototype.atan=function(){return Fe(this,ro)||Fe(this,io)?Hn:Re(ro,Re(Kn.makeInstance(.5),tn(De(qe(ro,this),qe(ro,Ne(0,this))))))},oo.prototype.cos=function(){if(this.isReal())return rn(this.r);var t=Tn(this),e=Cn(t);return Mn(qe($e(t),$e(e)))},oo.prototype.sin=function(){if(this.isReal())return an(this.r);var t=Tn(this),e=Cn(t),n=oo.makeInstance(0,2),o=Ne($e(t),$e(e)),r=De(o,n);return r},oo.prototype.expt=function(t){if(Me(t)&&Le(t,0))return In(this,t);var e=Re(t,this.log());return $e(e)},oo.prototype.exp=function(){var t=$e(this.r),e=rn(this.i),n=an(this.i);return Re(t,qe(e,Tn(n)))},oo.prototype.acos=function(){if(this.isReal())return sn(this.r);var t=Mn(Kn.pi),e=Tn(this),n=Ke(Ne(1,hn(this))),o=Tn(tn(qe(e,n)));return qe(t,o)},oo.prototype.asin=function(){if(this.isReal())return cn(this.r);var t=Ne(1,hn(this)),e=Ke(t);return Re(2,on(De(this,qe(1,e))))},oo.prototype.ceiling=function(){return this.isReal()||ve("ceiling: can only be applied to real number",this),He(this.r)},oo.prototype.floor=function(){return this.isReal()||ve("floor: can only be applied to real number",this),Ze(this.r)},oo.prototype.imaginaryPart=function(){return this.i},oo.prototype.realPart=function(){return this.r},oo.prototype.round=function(){return this.isReal()||ve("round: can only be applied to real number",this),pn(this.r)};var ao=new RegExp("^(#[ei]#[bodx]|#[bodx]#[ei]|#[bodxei])(.*)$");u.def=new u(0),u.on=new u(1),u.off=new u(2),u.prototype.intAsExactp=function(){return this.defaultp()||this.exactp()},u.prototype.floatAsInexactp=function(){return this.defaultp()||this.inexactp()};var so,co=function(t,e){var n=10,e="undefined"==typeof e?u.def:e===!0?u.on:e===!1?u.off:ve("exactness must be true or false",this,r),o=t.toLowerCase().match(ao);if(o){var i=o[1].toLowerCase(),a=i.match(new RegExp("(#[ei])")),s=i.match(new RegExp("(#[bodx])"));if(a){var c=a[1].charAt(1);e="e"===c?u.on:"i"===c?u.off:ve("invalid exactness flag",this,r)}if(s){var c=s[1].charAt(1);n="b"===c?2:"o"===c?8:"d"===c?10:"x"===c?16:ve("invalid radix flag",this,r)}}var p=o?o[2]:t,h=o?!0:!1;return l(p,n,e,h)},uo=0xdeadbeefcafe,lo=15715070==(16777215&uo);lo&&"undefined"!=typeof navigator&&"Microsoft Internet Explorer"==navigator.appName?(d.prototype.am=y,so=30):lo&&"undefined"!=typeof navigator&&"Netscape"!=navigator.appName?(d.prototype.am=g,so=26):(d.prototype.am=v,so=28),d.prototype.DB=so,d.prototype.DM=(1<<so)-1,d.prototype.DV=1<<so;var po=52;d.prototype.FV=Math.pow(2,po),d.prototype.F1=po-so,d.prototype.F2=2*so-po;var ho,fo,mo="0123456789abcdefghijklmnopqrstuvwxyz",go=[];for(ho="0".charCodeAt(0),fo=0;9>=fo;++fo)go[ho++]=fo;for(ho="a".charCodeAt(0),fo=10;36>fo;++fo)go[ho++]=fo;for(ho="A".charCodeAt(0),fo=10;36>fo;++fo)go[ho++]=fo;_.prototype.convert=U,_.prototype.revert=z,_.prototype.reduce=$,_.prototype.mulTo=W,_.prototype.sqrTo=G,K.prototype.convert=X,K.prototype.revert=Z,K.prototype.reduce=H,K.prototype.mulTo=J,K.prototype.sqrTo=Q,d.prototype.copyTo=x,d.prototype.fromInt=E,d.prototype.fromString=k,d.prototype.clamp=C,d.prototype.dlShiftTo=N,d.prototype.drShiftTo=R,d.prototype.lShiftTo=A,d.prototype.rShiftTo=D,d.prototype.subTo=F,d.prototype.multiplyTo=O,d.prototype.squareTo=V,d.prototype.divRemTo=L,d.prototype.invDigit=Y,d.prototype.isEven=tt,d.prototype.bnpExp=et,d.prototype.toString=M,d.prototype.negate=T,d.prototype.abs=I,d.prototype.compareTo=P,d.prototype.bitLength=B,d.prototype.mod=j,d.prototype.modPowInt=nt,d.ZERO=S(0),d.ONE=S(1),Gt.prototype.convert=Yt,Gt.prototype.revert=Yt,Gt.prototype.mulTo=Kt,Gt.prototype.sqrTo=Xt,Jt.prototype.convert=te,Jt.prototype.revert=ee,Jt.prototype.reduce=ne,Jt.prototype.mulTo=re,Jt.prototype.sqrTo=oe;var yo=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],vo=(1<<26)/yo[yo.length-1];d.prototype.chunkSize=st,d.prototype.toRadix=ut,d.prototype.fromRadix=lt,d.prototype.fromNumber=pt,d.prototype.bitwiseTo=gt,d.prototype.changeBit=Rt,d.prototype.addTo=Ot,d.prototype.dMultiply=$t,d.prototype.dAddOffset=Wt,d.prototype.multiplyLowerTo=Ht,d.prototype.multiplyUpperTo=Qt,d.prototype.modInt=se,d.prototype.millerRabin=le,d.prototype.clone=ot,d.prototype.intValue=rt,d.prototype.byteValue=it,d.prototype.shortValue=at,d.prototype.signum=ct,d.prototype.toByteArray=ht,d.prototype.equals=ft,d.prototype.min=dt,d.prototype.max=mt,d.prototype.and=vt,d.prototype.or=bt,d.prototype.xor=Et,d.prototype.andNot=kt,d.prototype.not=Ct,d.prototype.shiftLeft=Mt,d.prototype.shiftRight=Tt,d.prototype.getLowestSetBit=Pt,d.prototype.bitCount=Bt,d.prototype.testBit=Nt,d.prototype.setBit=At,d.prototype.clearBit=Dt,d.prototype.flipBit=Ft,d.prototype.add=Vt,d.prototype.subtract=Lt,d.prototype.multiply=jt,d.prototype.divide=_t,d.prototype.remainder=Ut,d.prototype.divideAndRemainder=zt,d.prototype.modPow=ie,d.prototype.modInverse=ce,d.prototype.pow=Zt,d.prototype.expt=Zt,d.prototype.gcd=ae,d.prototype.isProbablePrime=ue,d.NEGATIVE_ONE=d.ONE.negate();var wo=function(t){return"number"==typeof t&&(t+=""),t=me(t),new d(t,10)};d.prototype.level=0,d.prototype.liftTo=function(t){if(1===t.level)return new Yn(this,1);if(2===t.level){var e=this.toFixnum();return e===Number.POSITIVE_INFINITY?Qn:e===Number.NEGATIVE_INFINITY?Jn:new Kn(e)}return 3===t.level?new oo(this,0):ve("invalid level for BigInteger lift",this,t)},d.prototype.isFinite=function(){return!0},d.prototype.isInteger=function(){return!0},d.prototype.isRational=function(){return!0},d.prototype.isReal=function(){return!0},d.prototype.isExact=function(){return!0},d.prototype.isInexact=function(){return!1},d.prototype.toExact=function(){return this},d.prototype.toInexact=function(){return Kn.makeInstance(this.toFixnum())},d.prototype.toFixnum=function(){var t,e=0,n=this.toString();if("-"===n[0]){for(t=1;t<n.length;t++)e=10*e+Number(n[t]);return-e}for(t=0;t<n.length;t++)e=10*e+Number(n[t]);return e},d.prototype.greaterThan=function(t){return this.compareTo(t)>0},d.prototype.greaterThanOrEqual=function(t){return this.compareTo(t)>=0},d.prototype.lessThan=function(t){return this.compareTo(t)<0},d.prototype.lessThanOrEqual=function(t){return this.compareTo(t)<=0},d.prototype.divide=function(t){var e=zt.call(this,t);if(0===e[1].compareTo(d.ZERO))return e[0];var n=qe(e[0],Yn.makeInstance(e[1],t));return n},d.prototype.numerator=function(){return this},d.prototype.denominator=function(){return 1},function(){var t=function(t,e){for(;!je(hn(e),t)||!Ue(t,hn(qe(e,1)));)e=Ze(De(qe(e,Ze(De(t,e))),2));return e};d.prototype.integerSqrt=function(){var e;return no(this)>=0?t(this,this):(e=this.negate(),oo.makeInstance(0,t(e,e)))}}(),function(){d.prototype.sqrt=function(){var t,e=this.integerSqrt();return Oe(hn(e),this)?e:(t=Te(this),isFinite(t)?t>=0?Kn.makeInstance(Math.sqrt(t)):oo.makeInstance(0,Kn.makeInstance(Math.sqrt(-t))):e)}}(),d.prototype.floor=function(){return this},d.prototype.ceiling=function(){return this},d.prototype.conjugate=pe("conjugate"),d.prototype.magnitude=pe("magnitude"),d.prototype.log=pe("log"),d.prototype.angle=pe("angle"),d.prototype.atan=pe("atan"),d.prototype.acos=pe("acos"),d.prototype.asin=pe("asin"),d.prototype.tan=pe("tan"),d.prototype.cos=pe("cos"),d.prototype.sin=pe("sin"),d.prototype.exp=pe("exp"),d.prototype.imaginaryPart=function(){return 0},d.prototype.realPart=function(){return this},d.prototype.round=function(){return this};var bo=function(){var t=function(t,e,n){var o=[],r={};for(r[t]=!0;;){if(n--<=0)return[o.join(""),"..."];var i=gn(Re(t,10),e),a=yn(Re(t,10),e);if(o.push(i.toString()),r[a]){t=a;break}r[a]=!0,t=a}for(var s=t,c=[];;){var i=gn(Re(t,10),e),a=yn(Re(t,10),e);if(c.push(i.toString()),Fe(a,s))break;t=a}for(var u=o.join(""),l=c.join("");u.length>=l.length&&u.substring(u.length-l.length)===l;)u=u.substring(0,u.length-l.length);return[u,l]};return function(e,n,o){var r=512;o&&"undefined"!=typeof o.limit&&(r=o.limit),Ce(e)||ve("toRepeatingDecimal: n "+e.toString()+" is not an integer."),Ce(n)||ve("toRepeatingDecimal: d "+n.toString()+" is not an integer."),Fe(n,0)&&ve("toRepeatingDecimal: d equals 0"),Ue(n,0)&&ve("toRepeatingDecimal: d < 0");var i=Ue(e,0)?"-":"";e=Xe(e);var a=i+gn(e,n),s=t(yn(e,n),n,r);return[a].concat(s)}}();he.fromFixnum=de,he.fromString=co,he.makeBignum=wo,he.makeRational=Yn.makeInstance,he.makeFloat=Kn.makeInstance,he.makeComplex=oo.makeInstance,he.makeComplexPolar=bn,he.pi=Kn.pi,he.e=Kn.e,he.nan=Kn.nan,he.negative_inf=Kn.neginf,he.inf=Kn.inf,he.negative_one=-1,he.zero=0,he.one=1,he.i=ro,he.negative_i=io,he.negative_zero=to,he.onThrowRuntimeError=we,he.isSchemeNumber=be,he.isRational=xe,he.isReal=Ee,he.isExact=Se,he.isInexact=ke,he.isInteger=Ce,he.toFixnum=Te,he.toExact=Ie,he.toInexact=Pe,he.add=qe,he.subtract=Ne,he.multiply=Re,he.divide=De,he.equals=Fe,he.eqv=Oe,he.approxEquals=Ve,he.greaterThanOrEqual=Le,he.lessThanOrEqual=je,he.greaterThan=_e,he.lessThan=Ue,he.expt=ze,he.exp=$e,he.modulo=We,he.numerator=Ge,he.denominator=Ye,he.integerSqrt=fn,he.sqrt=Ke,he.abs=Xe,he.quotient=gn,he.remainder=yn,he.floor=Ze,he.ceiling=He,he.conjugate=Qe,he.magnitude=Je,he.log=tn,he.angle=en,he.tan=nn,he.atan=on,he.cos=rn,he.sin=an,he.tan=nn,he.acos=sn,he.asin=cn,he.cosh=vn,he.sinh=wn,he.imaginaryPart=un,he.realPart=ln,he.round=pn,he.sqr=hn,he.gcd=dn,he.lcm=mn,he.toRepeatingDecimal=bo,he.BigInteger=d,he.Rational=Yn,he.FloatPoint=Kn,he.Complex=oo,he.MIN_FIXNUM=En,he.MAX_FIXNUM=Sn}()},function(t,e){var n=function(){function t(t){return"undefined"==typeof t}function e(t){return"function"==typeof t}function n(t){return"string"==typeof t}function o(t,n){return e(t[n])}function r(t){return o(t,"equals")}function i(t){return o(t,"hashCode")}function a(t){if(n(t))return t;if(i(t)){var e=t.hashCode();return n(e)?e:a(e)}return o(t,"toString")?t.toString():String(t)}function s(t,e){return t.equals(e)}function c(t,e){return r(e)?e.equals(t):t===e}function u(t,e){return t===e}function l(t,e,n,o,r){for(var i,a=0,s=t.length;s>a;a++)if(i=t[a],r(e,n(i)))return o?[a,i]:!0;return!1}function p(t,e){if(o(t,"splice"))t.splice(e,1);else if(e===t.length-1)t.length=e;else{var n=t.slice(e+1);t.length=e;for(var r=0,i=n.length;i>r;r++)t[e+r]=n[r]}}function h(e,n){if(null===e)throw new Error("null is not a valid "+n);if(t(e))throw new Error(n+" must not be undefined")}function f(t){h(t,S)}function d(t){h(t,k)}function m(t,e,n){this.entries=[],this.addEntry(t,e),null!==n&&(this.getEqualityFunction=function(){return n})}function g(t){return t[0]}function y(t){return t[1]}function v(){}function w(t){return t[0]}function b(t,e,n){return l(t,e,w,!0,n)}function x(t,e){var n=t[e];return n&&n instanceof v?n[1]:null}function E(t,n){var o=[],r={};t=e(t)?t:a,n=e(n)?n:null,this.put=function(e,i){f(e),d(i);var a=t(e),s=x(r,a);if(s){var c=s.getEntryForKey(e);c?c[1]=i:s.addEntry(e,i)}else{var u=new v;u[0]=a,u[1]=new m(e,i,n),o[o.length]=u,r[a]=u}},this.get=function(e){f(e);var n=t(e),o=x(r,n);if(o){var i=o.getEntryForKey(e);if(i)return i[1]}return null},this.containsKey=function(e){f(e);var n=t(e),o=x(r,n);return o?o.containsKey(e):!1},this.containsValue=function(t){d(t);for(var e=0,n=o.length;n>e;e++)if(o[e][1].containsValue(t))return!0;return!1},this.clear=function(){o.length=0,r={}},this.isEmpty=function(){return 0===o.length},this.keys=function(){for(var t=[],e=0,n=o.length;n>e;e++)o[e][1].keys(t);return t},this.values=function(){for(var t=[],e=0,n=o.length;n>e;e++)o[e][1].values(t);return t},this.remove=function(e){f(e);var n=t(e),i=x(r,n);if(i&&i.removeEntryForKey(e)&&0===i.size()){var a=b(o,n,i.getEqualityFunction(e));p(o,a[0]),delete r[n]}},this.size=function(){for(var t=0,e=0,n=o.length;n>e;e++)t+=o[e][1].size();return t}}var S="key",k="value";return m.prototype={getEqualityFunction:function(t){return r(t)?s:c},searchForEntry:function(t){return l(this.entries,t,g,!0,this.getEqualityFunction(t))},getEntryForKey:function(t){return this.searchForEntry(t)[1]},getEntryIndexForKey:function(t){return this.searchForEntry(t)[0]},removeEntryForKey:function(t){var e=this.searchForEntry(t);return e?(p(this.entries,e[0]),!0):!1},addEntry:function(t,e){this.entries[this.entries.length]=[t,e]},size:function(){return this.entries.length},keys:function(t){for(var e=t.length,n=0,o=this.entries.length;o>n;n++)t[e+n]=this.entries[n][0]},values:function(t){for(var e=t.length,n=0,o=this.entries.length;o>n;n++)t[e+n]=this.entries[n][1]},containsKey:function(t){return l(this.entries,t,g,!1,this.getEqualityFunction(t))},containsValue:function(t){return l(this.entries,t,y,!1,u)}},v.prototype=[],E}();t.exports=n},function(t,e,n){window.plt=window.plt||{},plt.compiler=n(2);var o=n(3);!function(){"use strict";function t(t){return o.isVector(t.val)}function e(t){return o.isString(t.val)}function n(t){return t instanceof F}function r(t){return t instanceof D}function i(t){return t instanceof st}function a(t,e){return t=t instanceof F?t.val:t,e=e instanceof F?e.val:e,t===e}function s(t){return t instanceof Array&&t.length>=1}function c(t){return t.slice(1)}function u(t){function e(t){return d(t)?m(t):g(t)?y(t):B(t)?N(t):R(t)?A(t):ct(new o.Message(["Not a Definition, Expression, Library Require, or Provide"]),t.location)}return t.map(e)}function l(t){return 0===t.length?[]:s(t)?u(t):ct(new o.Message(["The sexp is not a list of definitions or expressions: "+t]),t.location)}function p(t){return s(t)&&n(t[0])&&a("define-struct",t[0])}function h(t){return s(t)&&n(t[0])&&a("define",t[0])}function f(t){return s(t)&&n(t[0])&&a("define-values",t[0])}function d(t){return p(t)||h(t)||f(t)}function m(t){function e(t){if(t.length<2&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected the structure name after define-struct, but nothing's there"]),t.location),t[1]instanceof F||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected the structure name after define-struct, but found ",new o.ColoredPart("something else",t[1].location)]),t.location),t.length<3&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least one field name (in parentheses) after the ",new o.ColoredPart("structure name",t[1].location),", but nothing's there"]),t.location),t[2]instanceof Array||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least one field name (in parentheses) after the ",new o.ColoredPart("structure name",t[1].location),", but found ",new o.ColoredPart("something else",t[2].location)]),t.location),t[2].forEach(function(e){e instanceof F||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a field name, but found ",new o.ColoredPart("something else",e.location)]),t.location)}),t.length>3){var e=t.slice(3).map(function(t){return t.location}),n=1===t[2].length?"field name":"field names",r=e.length+" extra "+(1===e.length?"part":"parts");ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected nothing after the ",new o.ColoredPart(n,t[2].location),", but found ",new o.MultiPart(r,e,!1)]),t.location)}return new rt(P(t[1]),t[2].map(P),t)}function n(t){if(t.length<2&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expects a list of variables and a body, but found neither"]),t.location),t.length<3&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expects a list of variables and a body, but found only ",new o.ColoredPart("one part",t[1].location)]),t.location),t[1]instanceof Array||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expects a list of variables and a body, but found ",new o.ColoredPart("something else",t[1].location)]),t.location),t.length>3){var e=t.slice(3).map(function(t){return t.location}),n=e.length+" extra "+(1===e.length?"part":"parts"),r=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expects a list of variables and a body, but found ",new o.MultiPart(n,e,!1)]);ct(r,t.location)}return new ot(t[1].map(P),y(t[2]),t)}function r(t){if(t.length<2&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a variable, or a function name and its variables (in parentheses), after define, but nothing's there"]),t.location),t[1]instanceof Array){if(0===t[1].length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a name for the function within ",new o.ColoredPart("the parentheses",t[1].location)]),t.location),t[1][0]instanceof F||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a function name after the open parenthesis but found ",new o.ColoredPart("something else",t[1][0].location)]),t.location),t[1].forEach(function(e){e instanceof F||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a variable but found ",new o.ColoredPart("something else",e.location)]),t.location)}),t.length<3&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected an expression for the function body, but nothing's there"]),t.location),t.length>3){var e=t.slice(3).map(function(t){return t.location}),n=e.length+" extra "+(1===e.length?"part":"parts");ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected only one expression for the function body, but found ",new o.MultiPart(n,e,!1)]),t.location)}var r=c(t[1]).map(P);return r.location=t[1].location,new et(P(t[1][0]),r,y(t[2]),t)}if(t[1]instanceof F){if(t.length<3&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected an expression after the variable ",new o.ColoredPart(t[1].val,t[1].location)," but nothing's there"]),t.location),t.length>3){var e=t.slice(3).map(function(t){return t.location}),n=e.length+" extra "+(1===e.length?"part":"parts");ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected only one expression after the variable ",new o.ColoredPart(t[1].val,t[1].location),", but found ",new o.MultiPart(n,e,!1)]),t.location)}return new nt(P(t[1]),y(t[2]),t)}ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a variable but found ",new o.ColoredPart("something else",t[1].location)]),t.location)}var i=p(t)?e(t):h(t)?r(t):f?n(t):ct(new o.Message([": expected to find a definition, but found: "+t]),t.location);return i.location=t.location,i}function g(t){return!d(t)&&!B(t)&&!R(t)}function y(t){return s(t)?v(t):I(t)}function v(t){function e(t){return a(t[0],"unquote")&&ct(new o.Message(["misuse of a comma or 'unquote, not under a quasiquoting backquote"]),t.location,"Error-GenericSyntacticError"),a(t[0],"unquote-splicing")&&ct(new o.Message(["misuse of a ,@ or unquote-splicing, not under a quasiquoting backquote"]),t.location,"Error-GenericSyntacticError"),a(t[0],"else")&&ct(new o.Message([new o.ColoredPart(t[0].val,t.location),": not allowed ",new o.ColoredPart("here",t.location),", because this is not a question in a clause"]),t.location),s(t)?new J(y(t[0]),c(t).map(y),t[0]):ct(new o.Message(["function call sexp"]),t.location)}function r(t){if(1===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least one variable (in parentheses) after lambda, but nothing's there"]),t.location),t[1]instanceof Array||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least one variable (in parentheses) after lambda, but found ",new o.ColoredPart("something else",t[1].location)]),t.location),t[1].forEach(function(e){if(!(e instanceof F)){var n=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a list of variables after lambda, but found ",new o.ColoredPart("something else",e.location)]);ct(n,t.location)}}),2===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected an expression for the function body, but nothing's there"]),t.location),t.length>3){var e=t.slice(3).map(function(t){return t.location}),n=e.length+" extra "+(1===e.length?"part":"parts"),r=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected only one expression for the function body, but found ",new o.MultiPart(n,e,!1)]);ct(r,t.location)}var i=t[1].map(P);return i.location=t[1].location,new K(i,y(t[2]),t[0])}function i(t){if(1===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least one definition (in square brackets) after local, but nothing's there"]),t.location),t[1]instanceof Array||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a collection of definitions, but given ",new o.ColoredPart("something else",t[1].location)]),t[1].location),t[1].forEach(function(e){d(e)||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a definition, but given ",new o.ColoredPart("something else",e.location)]),e.location)}),2===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single body, but found none"]),t.location),t.length>3){var e=t.slice(3).map(function(t){return t.location}),n=e.length+" extra "+(1===e.length?"part":"parts");ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single body, but found ",new o.MultiPart(n,e,!1)]),t.location)}return new z(t[1].map(m),y(t[2]),t[0])}function u(t){if(t.length<3&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected an expression after the bindings, but nothing's there"]),t.location),t[1]instanceof Array||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a key/value pair, but given ",new o.ColoredPart("something else",t[1].location)]),t.location),t[1].forEach(function(e){q(e)||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a key/value pair, but given ",new o.ColoredPart("something else",e.location)]),e.location)}),2===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected an expression after the bindings, but nothing's there"]),t.location),t.length>3){var e=t.slice(3).map(function(t){return t.location}),n=e.length+" extra "+(1===e.length?"part":"parts");ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single body, but found ",new o.MultiPart(n,e,!1)]),t.location)}return new U(t[1].map(E),y(t[2]),t[0])}function l(t){if(1===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least one binding (in parentheses) after let, but nothing's there"]),t.location),t[1]instanceof Array||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected sequence of key value pairs, but given ",new o.ColoredPart("something else",t[1].location)]),t[1].location),t[1].forEach(function(e){q(e)||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a key/value pair, but given ",new o.ColoredPart("something else",e.location)]),e.location)}),t.length>3){var e=t.slice(3).map(function(t){return t.location}),n=e.length+" extra "+(1===e.length?"part":"parts");ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single body, but found ",new o.MultiPart(n,e,!1)]),t.location)}return 2===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single body, but found none"]),t.location),new j(t[1].map(E),y(t[2]),t)}function p(t){if(1===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected an expression after the bindings, but nothing's there"]),t.location),!(t[1]instanceof Array)){var e=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected sequence of key/value pairs, but given ",new o.ColoredPart("something else",t[1].location)]);ct(e,t.location)}if(t[1].forEach(function(e){q(e)||ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a key/value pair, but given ",new o.ColoredPart("something else",e.location)]),e.location)}),2===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single body, but found none"]),t.location),t.length>3){var n=t.slice(3).map(function(t){return t.location}),r=n.length+" extra "+(1===n.length?"part":"parts");ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single body, but found ",new o.MultiPart(r,n,!1)]),t.location)}var i=t[1].map(E);return i.location=t[1].location,new _(i,y(t[2]),t[0])}function h(t){if(t.length<4&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a test, a consequence, and an alternative, but all three were not found"]),t.location),t.length>4){var e=t.slice(1).map(function(t){return t.location});ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected only a test, a consequence, and an alternative, ","but found ",new o.MultiPart("more than three of these",e,!1)]),t.location)}return new V(y(t[1]),y(t[2]),y(t[3]),t[0])}function f(t){if(t.length<2){var e=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": Inside a begin, expected to find a body, but nothing was found."]);ct(e,t.location)}return new L(c(t).map(y),t[0])}function g(t){return t.length<3&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least 2 arguments, but given ",1===t.length?"0":new o.ColoredPart((t.length-1).toString(),t[1].location)]),t.location),new $(c(t).map(y),t[0])}function v(t){t.length<3&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least 2 arguments, but given ",1===t.length?"0":new o.ColoredPart((t.length-1).toString(),t[1].location)]),t.location);var e=new W(c(t).map(y),t[0]);return e}function C(t){function e(t){return s(t)?t.map(e):t instanceof Array&&0===t.length?t:I(t)}if(t.length<2&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single argument, but did not find one."]),t.location),t.length>2){var n=t.slice(1).map(function(t){return t.location});ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single argument, but found ",new o.MultiPart("more than one.",n,!1)]),t.location)}return new X(e(t[1]))}return function(){var o=t[0],s=n(o)?a("Î»",o)?r(t):a("lambda",o)?r(t):a("local",o)?i(t):a("letrec",o)?u(t):a("let",o)?l(t):a("let*",o)?p(t):a("cond",o)?b(t):a("case",o)?x(t):a("if",o)?h(t):a("begin",o)?f(t):a("and",o)?g(t):a("or",o)?v(t):a("when",o)?w(t):a("unless",o)?w(t):a("quote",o)?C(t):a("quasiquote",o)?M(t):a("unquote",o)?S(t):a("unquote-splicing",o)?k(t):e(t):e(t);return s.location=t.location,s}()}function w(t){t.length<3&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at a test and at least one result after "+t[0]+", but nothing's there"]),t.location);var e=t.slice(2),n=new tt(y(t[1]),l(e),t[0]);return e.location=e[0].location,n.location=t.location,n}function b(t){function e(t){return n(t[0])&&a(t[0],"else")}function r(e){var n=[e.location.start(),e.location.end()];if(e instanceof Array||ct(new o.Message([new o.MultiPart(t[0].val,s,!0),": expected a clause with a question and an answer, but found ",new o.ColoredPart("something else",e.location)]),e.location),0===e.length&&ct(new o.Message([new o.MultiPart(t[0].val,s,!0),": expected a clause with a question and an answer, but found an ",new o.MultiPart("empty part",n,!0)]),e.location),1===e.length&&ct(new o.Message([new o.MultiPart(t[0].val,s,!0),": expected a clause with a question and an answer, but found a ",new o.MultiPart("clause",n,!0)," with only ",new o.MultiPart("one part",[e[0].location],!1)]),e.location),e.length>2){var r=e.map(function(t){return t.location}),i=r.length+" parts";
ct(new o.Message([new o.MultiPart(t[0].val,s,!0),": expected a clause with a question and an answer, but found ",new o.MultiPart("a clause",n,!0)," with ",new o.MultiPart(i,r,!1)]),e.location)}}function i(t){var e=y(t[0]),n=y(t[1]),r=new O(e,n);return plt.compiler.keywords.indexOf(e.val)>-1&&"else"!==e.val&&ct(new o.Message([new o.ColoredPart(e.val,e.location),": expected an open parenthesis before ",e.val,", but found none"]),e.location),e.isClause=!0,r.location=t.location,r}1===t.length&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least one clause after cond, but nothing's there"]),t.location);var s=[t[0].location,t.location.start(),t.location.end()];c(t).forEach(r);var u=c(t).length,l=c(t).map(i);return c(t).forEach(function(n,r){e(n)&&u-1>r&&ct(new o.Message([new o.MultiPart("cond",s,!0),": ","found an ",new o.ColoredPart("else clause",n.location)," that isn't the last clause in its cond expression; there is ",new o.ColoredPart("another clause",t[r+2].location)," after it"]),n.location)}),new G(l,t[0])}function x(t){function e(e){var n=[e.location.start(),e.location.end()];if(!(e instanceof Array)){var r=new o.Message([new o.MultiPart(t[0].val,c,!0),": expected a clause with at least one choice (in parentheses), but found ",new o.ColoredPart("something else",e.location)]);ct(r,t.location)}if(0===e.length){var r=new o.Message([new o.MultiPart(t[0].val,c,!0),": expected at least one choice (in parentheses) and an answer, but found an ",new o.ColoredPart("empty part",e.location)]);ct(r,t.location)}if(!(e[0]instanceof Array||e[0]instanceof F&&a(e[0],"else"))){var r=new o.Message([new o.MultiPart(t[0].val,c,!0),": expected 'else', or at least one choice in parentheses, but found ",new o.ColoredPart("something else",e.location)]);ct(r,t.location)}if(1===e.length){var r=new o.Message([new o.MultiPart(t[0].val,c,!0),": expected a clause with a question and an answer, but found a ",new o.MultiPart("clause",n,!0)," with only ",new o.ColoredPart("one part",e[0].location)]);ct(r,t.location)}if(e.length>2){var i=e.map(function(t){return t.location}),s=i.length+" parts",r=new o.Message([new o.MultiPart(t[0].val,c,!0),": expected only one expression for the answer in the case clause, but found a ",new o.MultiPart("clause",n,!0)," with ",new o.MultiPart(s,i,!1)]);ct(r,t.location)}}function r(t){return n(t[0])&&"else"===t[0].val}function i(t){var e=r(t)?t[0]:new X(t[0]),n=y(t[1]),o=new O(e,n);return e.isClause=!0,o.location=t.location,o}if(1===t.length){var s=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least one clause after case, but nothing's there"]);ct(s,t.location)}var c=[t[0].location,t.location.start(),t.location.end()];if(2===t.length){var s=new o.Message([new o.MultiPart(t[0].val,c,!0),": expected a clause with at least one choice (in parentheses) and an answer after the expression, but nothing's there"]);ct(s,t.location)}var u=t.slice(2);u.forEach(e);var l=u.length,p=u.map(i);return u.forEach(function(e,n){if(r(e)&&l-1>n){var i=new o.Message([new o.MultiPart("case",c,!0),": found an ",new o.ColoredPart("else clause",e.location),"that isn't the last clause in its case expression; there is ",new o.ColoredPart("another clause",t[n+2].location)," after it"]);ct(i,t.location)}}),new Y(y(t[1]),p,t[0])}function E(t){if(q(t)){var e=new O(P(t[0]),y(t[1]));return e.location=t.location,e.stx=t,e}ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a sequence of key/value pairs, but given ",new o.ColoredPart("something else",t[0].location)]),t.location)}function S(t,e){if("undefined"==typeof e)ct(new o.Message(["misuse of a comma or 'unquote, not under a quasiquoting backquote"]),t.location,"Error-GenericSyntacticError");else if(2!==t.length)ct(new o.Message(["Inside an unquote, expected to find a single argument, but found "+(t.length-1)]),t.location);else{if(1===e){var n=new Z(y(t[1]));return n.location=t[1].location,n}if(e>1){var n=new Z(C(t[1],e-1));return n.location=t[1].location,n}ct(new o.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),t.location)}}function k(t,e){if("undefined"==typeof e)ct(new o.Message(["misuse of a ,@ or unquote-splicing, not under a quasiquoting backquote"]),t.location,"Error-GenericSyntacticError");else if(2!==t.length)ct(new o.Message(["Inside an unquote-splicing, expected to find a single argument, but found "+(t.length-1)]),t.location);else{if(1===e){var n=new Q(y(t[1]));return n.location=t[1].location,n}if(e>1){var n=new Q(C(t[1],e-1));return n.location=t[1].location,n}ct(new o.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),t.location)}}function C(t,e){if(s(t)&&"unquote"===t[0].val)return S(t,e);if(s(t)&&"unquote-splicing"===t[0].val)return k(t,e);if(s(t)&&"quasiquote"===t[0].val)return M(t,e);if(s(t)){var n=t.map(function(t){return C(t,e)});return n.location=t.location,n}return 0===e?y(t):function(){var e=new X(t);return e.location=t.location,e}()}function M(t,e){if(e="undefined"==typeof e?0:e,t.length<2&&ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single argument, but did not find one "]),t.location),t.length>2){var n=t.slice(1).map(function(t){return t.location});ct(new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a single argument, but found ",new o.MultiPart("more than one.",n,!1)]),t.location)}s(t[1])&&a(t[1][0],"unquote-splicing")&&ct(new o.Message(["misuse of ,@ or `unquote-splicing' within a quasiquoting backquote"]),t.location);var r=C(t[1],e+1);r.location=t[1].location;var i=new H(r);return i.location=t.location,i}function T(t){function e(){var e=new D(0);return e.location=t.location,e}var n=t.val,o=u(n.elts.filter(function(t){return void 0!==t})),r=0===o.length?e():o[o.length-1],i=n.elts.map(function(t){return void 0===t?r:y(t)}),a=new F("vector"),s=new J(a,i);return a.location=s.location=t.location,s}function I(e){var s=i(e)?e:t(e)?T(e):n(e)?e:r(e)?e:a("quote",e)?new X(e):a("empty",e)?new J(new F("list"),[]):ct(new o.Message([new o.ColoredPart("( )",e.location),": expected a function, but nothing's there"]),e.location);return s.location=e.location,s}function P(t){return n(t)?t:ct(new o.Message(["ID"]),t.location)}function q(t){return s(t)&&2===t.length}function B(t){return s(t)&&n(t[0])&&a(t[0],"require")}function N(t){if(t.length<2){var n=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a module name after `require', but found nothing"]);ct(n,t.location)}if(t[1]instanceof Array&&a(t[1][0],"lib")){if(t[1].length<3){var r=t[1].slice(1).length,i=r+(1===r?" part":" parts"),n=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected at least two strings after ",new o.ColoredPart("lib",t[1][0].location)," but found only ",i]);ct(n,t.location)}c(t[1]).forEach(function(n){if(!e(n)){var r=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a string for a library collection, but found ",new o.ColoredPart("something else",str.location)]);ct(r,t.location)}})}else if(t[1]instanceof Array&&a(t[1][0],"planet")){var n=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": Importing PLaneT pacakges is not supported at this time"]);ct(n,t.location)}else if(!(t[1]instanceof F||e(t[1]))){var n=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": expected a module name as a string or a `(lib ...)' form, but found ",new o.ColoredPart("something else",t[1].location)]);ct(n,t.location)}var s=new it(t[1],t[0]);return s.location=t.location,s}function R(t){return s(t)&&n(t[0])&&a(t[0],"provide")}function A(t){var e=c(t).map(function(e){if(e instanceof F)return e;if(e instanceof Array&&2==e.length&&e[0]instanceof F&&a(e[0],"struct-out")&&e[1]instanceof F)return e;var n=new o.Message([new o.ColoredPart(t[0].val,t[0].location),": I don't recognize the syntax of this ",new o.ColoredPart("clause",e.location)]);ct(n,t.location)}),n=new at(e,t[0]);return n.location=t.location,n}var D=plt.compiler.literal,F=plt.compiler.symbolExpr,O=(plt.compiler.Program,plt.compiler.couple),V=plt.compiler.ifExpr,L=plt.compiler.beginExpr,j=plt.compiler.letExpr,_=plt.compiler.letStarExpr,U=plt.compiler.letrecExpr,z=plt.compiler.localExpr,$=plt.compiler.andExpr,W=plt.compiler.orExpr,G=plt.compiler.condExpr,Y=plt.compiler.caseExpr,K=plt.compiler.lambdaExpr,X=plt.compiler.quotedExpr,Z=plt.compiler.unquotedExpr,H=plt.compiler.quasiquotedExpr,Q=plt.compiler.unquoteSplice,J=plt.compiler.callExpr,tt=plt.compiler.whenUnlessExpr,et=plt.compiler.defFunc,nt=plt.compiler.defVar,ot=plt.compiler.defVars,rt=plt.compiler.defStruct,it=plt.compiler.requireExpr,at=plt.compiler.provideStatement,st=plt.compiler.unsupportedExpr,ct=plt.compiler.throwError;plt.compiler.parse=function(t,e){var n=(new Date).getTime();try{var o=l(t);o.location=t.location}catch(r){throw console.log("PARSING ERROR"),r}var i=(new Date).getTime();return e&&(console.log("Parsed in "+Math.floor(i-n)+"ms"),console.log(o)),o}}(),t.exports=plt.compiler},function(module,exports,__webpack_require__){__webpack_require__(2),__webpack_require__(8),window.plt=window.plt||{},plt.compiler=plt.compiler||{};var types=__webpack_require__(3);!function(){"use strict";function checkDuplicateIdentifiers(t,e,n){var o={};t.forEach(function(t){t instanceof symbolExpr?o[t.val]?throwError(new types.Message([new types.ColoredPart(e.toString(),e.location),": found ",new types.ColoredPart("a variable",t.location)," that is already used ",new types.ColoredPart("here",o[t.val].location)]),t.location):o[t.val]=t:throwError("expected identifier "+t.val,t.location)})}function tagApplicationOperator_Module(t,e){var n=plt.compiler.defaultModuleResolver(e),o=(new plt.compiler.emptyEnv).extendEnv_moduleBinding(n);return[t.func].concat(t.args).forEach(function(t){t.context=o}),t}function forceBooleanContext(t,e,n){t=new literal(new types.string(t.toString()));var o=new symbolExpr("verify-boolean-branch-value"),r=new quotedExpr(t),i=new quotedExpr(new literal(e.toVector())),a=new quotedExpr(new literal(n.location.toVector())),s=new callExpr(o,[r,i,n,a]);return s.location=o.location=n.location,r.location=i.location=a.location=n.location,tagApplicationOperator_Module(s,"moby/runtime/kernel/misc"),s}function desugarProgram(t,e,n){var o=[[],e||new plt.compiler.pinfo],r=t.reduce(function(t,e){var o=e.desugar(t[1]);if(plt.compiler.isExpression(e)&&n){var r=new symbolExpr("print-values"),i=new callExpr(r,[o[0]]);r.location=i.location=o[0].location,o[0]=i,tagApplicationOperator_Module(i,"moby/runtime/kernel/misc")}return o[0].length?t[0]=t[0].concat(o[0]):t[0].push(o[0]),[t[0],o[1]]},o);return r[0].location=t.location,r}function desugarQuasiQuotedList(t,e,n){function o(t,e,n,o){if(0===n&&t instanceof unquoteSplice)return t.desugar(e,n);var r=t instanceof Array?desugarQuasiQuotedList(t,n,n)[0]:t.desugar(e,n)[0],i=new symbolExpr("list"),a=new callExpr(i,[r]);return i.parent=a,a.location=i.location=o,[a,e]}var r="undefined"!=typeof t.location?t.location:t instanceof Array&&"undefined"!=typeof t[0].location?t[0].location:throwError(types.Message(["ASSERTION FAILURE: couldn't find a usable location"]),new Location(0,0,0,0)),i=t.map(function(t){return o(t,e,n,r)[0]}),a=new symbolExpr("append");a.location=r;var s=new callExpr(a,i);return s.location=r,[s,e]}function bf(t,e,n,o,r){return new functionBinding(t,e,n,o,[],!1,r)}function provideBindingId(t){this.symbl=t}function provideBindingStructId(t){this.symbl=t}function analyzeClosureUses(t,e){var n=e.env,o=n.bindings.keys(),r=types.makeLowLevelEqHash();o.forEach(function(t){r.put(t,n.bindings.get(t))});var i=new plt.compiler.env(r),i=t.args.reduce(function(t,e){return t.extend(new constantBinding(e.val,!1,[],e.location))},i);return e.env=i,e=t.body.analyzeUses(e,i),e.env=n,e}function analyze(t){return programAnalyzeWithPinfo(t,plt.compiler.getBasePinfo("base"))}function programAnalyzeWithPinfo(t,e){function n(t,e){return t.reduce(function(t,e){return e.collectDefinitions(t)},e)}function o(t,e){return t.reduce(function(t,e){return e.collectProvides(t)},e)}function r(t,e){return t.reduce(function(t,e){return e.analyzeUses(t,t.env)},e)}var i=n(t,e),a=o(t,i);return r(t,a)}var literal=plt.compiler.literal,symbolExpr=plt.compiler.symbolExpr,Program=plt.compiler.Program,couple=plt.compiler.couple,ifExpr=plt.compiler.ifExpr,beginExpr=plt.compiler.beginExpr,letExpr=plt.compiler.letExpr,letStarExpr=plt.compiler.letStarExpr,letrecExpr=plt.compiler.letrecExpr,localExpr=plt.compiler.localExpr,andExpr=plt.compiler.andExpr,orExpr=plt.compiler.orExpr,condExpr=plt.compiler.condExpr,caseExpr=plt.compiler.caseExpr,lambdaExpr=plt.compiler.lambdaExpr,quotedExpr=plt.compiler.quotedExpr,unquotedExpr=plt.compiler.unquotedExpr,quasiquotedExpr=plt.compiler.quasiquotedExpr,unquoteSplice=plt.compiler.unquoteSplice,callExpr=plt.compiler.callExpr,whenUnlessExpr=plt.compiler.whenUnlessExpr,defFunc=plt.compiler.defFunc,defVar=plt.compiler.defVar,defVars=plt.compiler.defVars,defStruct=plt.compiler.defStruct,requireExpr=plt.compiler.requireExpr,provideStatement=plt.compiler.provideStatement,unsupportedExpr=plt.compiler.unsupportedExpr,throwError=plt.compiler.throwError,structBinding=plt.compiler.structBinding,constantBinding=plt.compiler.constantBinding,functionBinding=plt.compiler.functionBinding,moduleBinding=plt.compiler.moduleBinding,knownModules=plt.compiler.knownModules;Program.prototype.desugar=function(t){return[this,t]},defFunc.prototype.desugar=function(t){checkDuplicateIdentifiers([this.name].concat(this.args),this.stx[0],this.location),this.args.forEach(function(t){t instanceof symbolExpr||throwError(new types.Message([new types.ColoredPart(this.stx.val,this.stx.location),": expected a variable but found ",new types.ColoredPart("something else",t.location)]),sexp.location)});var e=this.body.desugar(t),n=new defFunc(this.name,this.args,e[0],this.stx);return n.location=this.location,[n,e[1]]},defVar.prototype.desugar=function(t){if(this.expr instanceof lambdaExpr){var e=new defFunc(this.name,this.expr.args,this.expr.body,this.stx);return e.location=this.location,e.desugar(t)}var n=this.expr.desugar(t),o=new defVar(this.name,n[0],this.stx);return o.location=this.location,[o,n[1]]},defVars.prototype.desugar=function(t){var e=this.expr.desugar(t),n=new defVars(this.names,e[0],this.stx);return n.location=this.location,[n,e[1]]},defStruct.prototype.desugar=function(t){function e(t,e){var o=new symbolExpr("make-struct-field-accessor"),r=[new symbolExpr(n.name.val+"-ref"),new literal(e),new quotedExpr(new symbolExpr(t.val))],i=new callExpr(o,r),a=new symbolExpr(n.name.val+"-"+t.val),s=new defVar(a,i);[s,o,i,a].concat(r).forEach(function(e){e.location=t.location}),u.push(s)}var n=this,o=["make-"+this.name.val,this.name.val+"?",this.name.val+"-ref",this.name.val+"-set!"],r=o.map(function(t){return new symbolExpr(t)}),i=new symbolExpr("make-struct-type"),a=[new quotedExpr(new symbolExpr(this.name.val)),new literal(!1),new literal(this.fields.length),new literal(0)],s=new callExpr(i,a);[s,i].concat(r,a).forEach(function(t){t.location=n.location});var c=new defVars([this.name].concat(r),s,this.stx),u=[c];return c.location=this.location,this.fields.forEach(e),[u,t]},beginExpr.prototype.desugar=function(t){var e=desugarProgram(this.exprs,t),n=new beginExpr(e[0],this.stx);return n.location=this.location,[n,e[1]]},lambdaExpr.prototype.desugar=function(t){this.stx&&checkDuplicateIdentifiers(this.args,this.stx,this.location);var e=this.body.desugar(t),n=new lambdaExpr(this.args,e[0],this.stx);return n.location=this.location,[n,e[1]]},localExpr.prototype.desugar=function(t){var e=desugarProgram(this.defs,t),n=this.body.desugar(e[1]),o=new localExpr(e[0],n[0],this.stx);return o.location=this.location,[o,n[1]]},callExpr.prototype.desugar=function(t){var e=desugarProgram([this.func].concat(this.args),t),n=new callExpr(e[0][0],e[0].slice(1),this.stx);return n.location=this.location,[n,e[1]]},ifExpr.prototype.desugar=function(t){var e=desugarProgram([this.predicate,this.consequence,this.alternative],t),n=forceBooleanContext(this.stx,this.stx.location,e[0][0]),o=e[0][1],r=e[0][2],i=new ifExpr(n,o,r,this.stx);return i.location=this.location,[i,e[1]]},whenUnlessExpr.prototype.desugar=function(t){var e=new beginExpr(this.exprs,this.stx),n=new symbolExpr("void"),o=new callExpr(n,[],this.stx),r="when"===this.stx.val?e:o,i="when"===this.stx.val?o:e;e.location=this.exprs.location,n.location=o.location=this.location;var a=desugarProgram([this.predicate,r,i],t),s=new ifExpr(a[0][0],a[0][1],a[0][2],this.stx);return s.location=this.location,[s,a[1]]},letrecExpr.prototype.desugar=function(t){function e(t){var e=new defVar(t.first,t.second,t.stx);return e.location=t.location,e}var n=new localExpr(this.bindings.map(e),this.body,this.stx).desugar(t);return n[0].location=this.location,n},letExpr.prototype.desugar=function(t){function e(t){return t.first}function n(t){return t.second}var o=this.bindings.map(e),r=this.bindings.map(n),i=new lambdaExpr(o,this.body,this.stx),a=new callExpr(i,r);return i.location=a.location=this.location,a.desugar(t)},letStarExpr.prototype.desugar=function(t){function e(t,e){var n=new letExpr([e],t,e.stx);return n.location=e.location,n}return 0===this.bindings.length?this.body.desugar(t):this.bindings.reduceRight(e,this.body).desugar(t)},condExpr.prototype.desugar=function(t){var e=new symbolExpr("throw-cond-exhausted-error"),n=new quotedExpr(new literal(this.location.toVector())),o=tagApplicationOperator_Module(new callExpr(e,[n]),"moby/runtime/kernel/misc"),r=new symbolExpr("if");r.location=this.stx.location,o.location=e.location=n.location=this.location;for(var i=this.clauses.length-1;i>-1;i--)this.clauses[i].first instanceof symbolExpr&&"else"===this.clauses[i].first.val&&(this.clauses[i].first.val="true"),o=new ifExpr(this.clauses[i].first,this.clauses[i].second,o,this.stx),o.location=this.location;return o.desugar(t)},caseExpr.prototype.desugar=function(t){function e(t,e){var r=new symbolExpr("ormap"),i=new callExpr(r,[y,e.first],n.stx),a=new ifExpr(i,e.second,t,o);return h=h.concat([r,i,e.first,a]),a}var n=this,o=new symbolExpr("if");o.location=n.location;var r,i=t.gensym("val"),a=i[0],s=i[1],c=a.gensym("x"),u=c[0],l=c[1],p=new symbolExpr("void"),h=[s,l,p],f=this.clauses,d=f[this.clauses.length-1];d.first instanceof symbolExpr&&"else"===d.first.val?(r=d.second,f.pop()):(r=new callExpr(p,[],n.stx),r.location=n.location);var m=new symbolExpr("equal?"),g=new callExpr(m,[l,s],o),y=new lambdaExpr([l],g,o);h=h.concat([m,g,y]);var v=new couple(s,this.expr),w=f.reduceRight(e,r),b=new letExpr([v],w,o);return h=h.concat([v,b]),h.forEach(function(t){t.location=n.location}),b.desugar(u)},andExpr.prototype.desugar=function(t){function e(t){var r=forceBooleanContext(n.stx,n.stx.location,t[0]),i=t.length>2?e(t.slice(1)):forceBooleanContext(n.stx,n.stx.location,t[1]),a=new literal(!1),s=new ifExpr(r,i,a,o),c=[a,o,s];return c.forEach(function(t){return t.location=n.location}),s}var n=this,o=new symbolExpr("if"),r=desugarProgram(this.exprs,t),i=r[0],t=r[1],a=e(i);return a.location=n.location,[a,t]},orExpr.prototype.desugar=function(t){function e(t,r){var i=t[0],a=(i.location,r.gensym("tmp")),s=a[1],c=new symbolExpr("if");s.notOriginalSource=!0,i.stx&&"if"!==i.stx.val&&(c.location=i.location,i.stx=c);var u,r=a[0],l=new couple(s,forceBooleanContext(n.stx,n.stx.location,i));if(2==t.length)u=forceBooleanContext(o,n.stx.location,t[1]);else{var p=e(t.slice(1),r);u=p[0],r=p[1]}var h=new ifExpr(s,s,u,new symbolExpr("if")),f=new letExpr([l],h,o),d=[o,s,l,h,h.stx,f];return d.forEach(function(t){return t.location=n.location}),f.desugar(r)}var n=this,o=new symbolExpr("or"),r=desugarProgram(this.exprs,t),i=r[0],t=r[1];return e(i,t)},quotedExpr.prototype.desugar=function(t){function e(t,e){return function(n){if(n instanceof callExpr||n instanceof quotedExpr||n instanceof unsupportedExpr)return n.desugar(t);if(n instanceof symbolExpr||n instanceof literal||n instanceof Array){var o=new quotedExpr(n);return o.location=e,[o,t]}throwError(new types.Message(["ASSERTION ERROR: Found an unexpected item in a quotedExpr"]),e)}}return"undefined"==typeof this.location&&throwError(new types.Message(["ASSERTION ERROR: Every quotedExpr should have a location"]),loc),e(t,this.location)(this.val)},unquotedExpr.prototype.desugar=function(t,e){if("undefined"==typeof e)throwError(new types.Message(["misuse of a ', not under a quasiquoting backquote"]),this.location);else{if(1===e)return this.val.desugar(t);if(e>1){if(this.val instanceof Array)return desugarQuasiQuotedList(element,t,e-1);var n=new quotedExpr(new symbolExpr("unquote")),o=new symbolExpr("list"),r=[n,this.val.desugar(t,e-1)[0]],i=new callExpr(o,r);return n.location=this.location,n.parent=r,o.location=this.location,o.parent=i,i.location=this.location,[i,t]}throwError(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),this.location)}},unquoteSplice.prototype.desugar=function(t,e){if("undefined"==typeof e)throwError(new types.Message(["misuse of a ,@, not under a quasiquoting backquote"]),this.location);else{if(1===e)return this.val.desugar(t);if(e>1){if(this.val instanceof Array)return desugarQuasiQuotedList(element,t,e-1);var n=new quotedExpr(new symbolExpr("unquote-splicing")),o=new symbolExpr("list"),r=[n,this.val.desugar(t,e-1)[0]],i=new callExpr(o,r);return n.location=this.location,n.parent=r,o.location=this.location,o.parent=i,i.location=this.location,[i,t]}throwError(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),this.location)}},quasiquotedExpr.prototype.desugar=function(t,e){if(e="undefined"==typeof e?0:e,e>=0){var n;n=this.val instanceof Array?desugarQuasiQuotedList(this.val,t,e+1)[0]:this.val.desugar(t,e+1)[0]}else throwError(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),this.location);if(0==e)return[n,t];var o=new quotedExpr(new symbolExpr("quasiquote")),r=[o,n],i=new symbolExpr("list"),a=new callExpr(i,r);return o.parent=r,o.location=this.location,n.parent=r,i.parent=a,i.location=this.location,a.location=this.location,[a,t]},symbolExpr.prototype.desugar=function(t){if(!this.isClause&&"else"===this.val){var e=this.parent&&this.parent[0]===this?this.parent.location:this.location;throwError(new types.Message([new types.ColoredPart(this.val,e),": not allowed ",new types.ColoredPart("here",e),", because this is not a question in a clause"]),e)}if(this.parent&&this.parent[0]!==this&&"define"===this.val){var n=new types.Message([new types.ColoredPart(this.val,this.location),": not allowed inside an expression"]);throwError(n,this.location)}if(!this.parent&&plt.compiler.keywords.indexOf(this.val)>-1&&"else"!==this.val&&throwError(new types.Message([new types.ColoredPart(this.val,this.location),": expected an open parenthesis before ",this.val,", but found none"]),this.location),"."===this.val){var n=new types.Message([this.location.source,":",this.location.startRow.toString(),":",this.location.startCol.toString(),": read: '.' is not supported as a symbol in WeScheme"]);throwError(n,this.location,"Error-GenericReadError")}return[this,t]},unsupportedExpr.prototype.desugar=function(t){this.location.span=this.errorSpan,throwError(this.errorMsg,this.location,"Error-GenericReadError")},Program.prototype.collectDefinitions=function(t){return t},defFunc.prototype.collectDefinitions=function(t){this.args.forEach(function(t){plt.compiler.keywords.indexOf(t.val)>-1&&throwError(new types.Message([new types.ColoredPart(t.val,t.location),": this is a reserved keyword and cannot be used as a variable or function name"]),t.location)});var e=bf(this.name.val,!1,this.args.length,!1,this.name.location);return t.accumulateDefinedBinding(e,this.location)},defVar.prototype.collectDefinitions=function(t){var e=this.expr instanceof lambdaExpr?bf(this.name.val,!1,this.expr.args.length,!1,this.name.location):new constantBinding(this.name.val,!1,[],this.name.location);return t.accumulateDefinedBinding(e,this.location)},defVars.prototype.collectDefinitions=function(t){var e=this,n=function(t){return e.stx[1].val+"-"+t.val},o=function(t){return"set-"+e.stx[1].val+"-"+t.val+"!"};if("define-struct"===e.stx[0].val){var r=e.stx[1].val,i=e.stx[2],a="make-"+r,s=r+"?",c=i.map(n),u=i.map(o),l=e.stx[1].location,p=new structBinding(r,!1,i,a,s,c,u,null,e.stx[1].location),h=bf(a,!1,i.length,!1,l),f=bf(s,!1,1,!1,l),d=bf(r+"-set!",!1,1,!1,l),m=bf(r+"-ref",!1,1,!1,l),g=[p,m,h,f,d];return t.accumulateDefinedBindings(g,e.location)}return this.names.reduce(function(t,n){var o=new constantBinding(n.val,!1,[],n.location);return t.accumulateDefinedBinding(o,e.location)},t)},requireExpr.prototype.collectDefinitions=function(pinfo){function getWeSchemeModule(t){var e=t.match(/^wescheme\/(\w+)$/);return e?e[1]:!1}function throwModuleError(t){var e=plt.compiler.moduleGuess(that.spec.toString()),n=new types.Message(["Found require of the module ",new types.ColoredPart(that.spec.toString(),that.spec.location),", but this module is unknown.",e.name===that.spec.toString()?"":" Did you mean '"+e.name+"'?"]);throwError(n,that.spec.location,"Error-UnknownModule")}function processModule(t){var e=window.COLLECTIONS[t].provides,n=function(e){var n=new constantBinding(e,new symbolExpr(t),!1);return n.imported=!0,n},o=e.map(n),r=new moduleBinding(t,o);newPinfo=pinfo.accumulateModule(r).accumulateModuleBindings(o)}var moduleName=this.spec instanceof literal?this.spec.val.toString():this.spec.toString(),resolvedModuleName=pinfo.modulePathResolver(moduleName,pinfo.currentModulePath),that=this,newPinfo;resolvedModuleName||getWeSchemeModule(moduleName)||throwModuleError(moduleName);var url=window.location.protocol+"//"+window.location.host+(getWeSchemeModule(moduleName)?"/loadProject?publicId="+getWeSchemeModule(moduleName):"/js/mzscheme-vm/collects/"+moduleName+".js");return window.COLLECTIONS&&window.COLLECTIONS[moduleName]?processModule(moduleName):jQuery.ajax({url:url,success:function(result){if(getWeSchemeModule(moduleName)){var program=(0,eval)("("+result+")");void 0===window.COLLECTIONS&&(window.COLLECTIONS=[]);var lexemes=plt.compiler.lex(program.source.src,moduleName),AST=plt.compiler.parse(lexemes),desugared=plt.compiler.desugar(AST)[0],pinfo=plt.compiler.analyze(desugared),objectCode=plt.compiler.compile(desugared,pinfo);window.COLLECTIONS[moduleName]={name:moduleName,bytecode:(0,eval)("("+objectCode.bytecode+")"),provides:objectCode.provides}}else eval(result);result?processModule(moduleName):throwModuleError(moduleName)},error:function(t){throwModuleError(moduleName)},async:!1}),newPinfo},Program.prototype.collectProvides=function(t){return t},provideStatement.prototype.collectProvides=function(t){function e(e){t.providedNames.put(e,new provideBindingId(e))}function n(t,n){if(n instanceof symbolExpr){if(t.definedNames.containsKey(n.val))return e(n.val),t;var o=new types.Message(["The name '",new types.ColoredPart(n.toString(),n.location),"', is not defined in the program, and cannot be provided."]);throwError(o,n.location)}else{if(!(n instanceof Array))throw"Impossible: all invalid provide clauses should have been filtered out!";if(t.definedNames.containsKey(n[1].val)&&t.definedNames.get(n[1].val)instanceof structBinding){var r=t.definedNames.get(n[1].val),i=[r.name,r.constructor,r.predicate].concat(r.accessors,r.mutators);return i.forEach(e),t}throwError(new types.Message(["The struct '",new types.ColoredPart(n[1].toString(),n[1].location),"', is not defined in the program, and cannot be provided"]),n.location)}}return this.clauses.reduce(n,t)},Program.prototype.analyzeUses=function(t,e){return t},defVar.prototype.analyzeUses=function(t){return t.env.extend(this.expr instanceof lambdaExpr?bf(this.name.val,!1,this.expr.args.length,!1,this.location):new constantBinding(this.name.val,!1,[],this.name.location)),this.expr.analyzeUses(t,t.env)},defVars.prototype.analyzeUses=function(t){return this.names.forEach(function(e){t.env.extend(new constantBinding(e.val,!1,[],e.location))}),this.expr.analyzeUses(t,t.env)},defFunc.prototype.analyzeUses=function(t){return t.env=t.env.extend(bf(this.name.val,!1,this.args.length,!1,this.name.location)),analyzeClosureUses(this,t)},lambdaExpr.prototype.analyzeUses=function(t,e){return analyzeClosureUses(this,t)},beginExpr.prototype.analyzeUses=function(t,e){return this.exprs.reduce(function(t,n){return n.analyzeUses(t,e)},t)},localExpr.prototype.analyzeUses=function(t,e){var n=this.defs.reduce(function(t,n){return n.analyzeUses(t,e)},t);return this.body.analyzeUses(n,n.env)},callExpr.prototype.analyzeUses=function(t,e){return[this.func].concat(this.args).reduce(function(n,o){return o instanceof Array?o.reduce(function(t,e){return e.analyzeUses(t,t.env)},t):o.analyzeUses(n,e)},t)},ifExpr.prototype.analyzeUses=function(t,e){var n=[this.predicate,this.consequence,this.alternative];return n.reduce(function(t,n){return n.analyzeUses(t,e)},t)},symbolExpr.prototype.analyzeUses=function(t,e){(plt.compiler.keywords.indexOf(this.val)>-1&&(!this.parent||this.parent[0]!==this)||this.parent instanceof couple)&&throwError(new types.Message([new types.ColoredPart(this.val,this.location),": expected an open parenthesis before ",this.val,", but found none"]),this.location);var n=e.lookup_context(this.val);return n?(this.bindingLoc=n.loc,t.accumulateBindingUse(n,t)):t.accumulateFreeVariableUse(this.val,t)},plt.compiler.desugar=function(t,e,n){var o=(new Date).getTime();try{var r=desugarProgram(t,e,!0),i=r[0],e=r[1]}catch(a){throw console.log("DESUGARING ERROR"),a}var s=(new Date).getTime();return n&&(console.log("Desugared in "+Math.floor(s-o)+"ms"),console.log(i),console.log(i.toString())),r},plt.compiler.analyze=function(t,e){var n=(new Date).getTime();try{var o=analyze(t)}catch(r){throw console.log("ANALYSIS ERROR"),r}var i=(new Date).getTime();return e&&console.log("Analyzed in "+Math.floor(i-n)+"ms"),o},plt.compiler.provideBindingId=provideBindingId,plt.compiler.provideBindingStructId=provideBindingStructId}(),module.exports=plt.compiler},function(t,e,n){window.plt=window.plt||{},plt.compiler=n(2),function(){function t(t){return function(e){return e[3]=e[3]||[],e[4]=e[4]||!1,e[5]=e[5]||!1,new n(e[0],t,e[1],e[2],e[3],e[4],e[5])}}var e=plt.compiler.moduleBinding,n=plt.compiler.functionBinding,o=plt.compiler.constantBinding,r=new e("moby/runtime/kernel/misc",[["verify-boolean-branch-value",2],["throw-cond-exhausted-error",1],["'check-operator-is-function",3],["print-values",0]].map(t('"moby/runtime/kernel/misc"'))),i=new e("moby/foreign",[["get-js-object",2,!1,["android.permission.FOREIGN-FUNCTION-INTERFACE"]]].map(t('"moby/foreign"'))),a=new e("world-effects",[["make-effect:none",0,!1],["make-effect:beep",0,!1,["android.permission.VIBRATE"]],["make-effect:play-dtmf-tone",2,!1],["make-effect:send-sms",2,!1,["android.permission.SEND-SMS"]],["make-effect:play-sound",1,!1,["android.permission.INTERNET"]],["make-effect:stop-sound",1,!1],["make-effect:pause-sound",1,!1],["make-effect:set-sound-volume",1,!1],["make-effect:set-beep-volume",1,!1],["make-effect:raise-sound-volume",0,!1],["make-effect:lower-sound-volume",1,!1],["make-effect:set-wake-lock",1,!1,["android.permission.WAKE-LOCK"]],["make-effect:release-wake-lock",1,!1,["android.permission.WAKE-LOCK"]],["make-effect:pick-playlist",1,!1],["make-effect:pick-random",2,!1]].map(t('"moby/world-effects"'))),s=new e("world-config",[["on-tick",1,!0],["initial-effect",1,!1],["on-key",1,!1],["on-key!",2,!1],["on-mouse",1,!1],["on-tap",1,!1],["on-tilt",1,!1],["on-redraw",1,!1],["to-draw",1,!1],["on-draw",2,!1],["stop-when",1,!1]].map(t('"moby/world-handlers"'))),c=[["START",14,!1],["test-frame",1,!1],["sine",1,!1],["cosine",1,!1],["tangent",1,!1]],u=new e("bootstrap/bootstrap-teachpack",c.map(t('"bootstrap/bootstrap-teachpack"'))),l=new e("bootstrap2011/bootstrap-teachpack",c.map(t('"bootstrap2011/bootstrap-teachpack"'))),p=new e("bootstrap2012/bootstrap-teachpack",c.map(t('"bootstrap2012/bootstrap-teachpack"'))),h=new e("bootstrap2012/bootstrap-tilt-teachpack",c.map(t('"bootstrap2012/bootstrap-tilt-teachpack"'))),f=new e("bootstrap2014/bootstrap-teachpack",c.map(t('"bootstrap2014/bootstrap-teachpack"'))),d=new e("bootstrap2014/bootstrap-tilt-teachpack",c.map(t('"bootstrap2014/bootstrap-tilt-teachpack"'))),m=new e("bootstrap2015/bootstrap-teachpack",c.map(t('"bootstrap2015/bootstrap-teachpack"'))),g=new e("bootstrap2015/bootstrap-tilt-teachpack",c.map(t('"bootstrap2015/bootstrap-tilt-teachpack"'))),y=new e("bootstrap/cage-teachpack",[["start",1,!1]].map(t('"bootstrap/cage-teachpack"'))),v=new e("bootstrap2011/cage-teachpack",[["start",1,!1]].map(t('"bootstrap2011/cage-teachpack"'))),w=new e("bootstrap2012/cage-teachpack",[["start",1,!1]].map(t('"bootstrap2012/cage-teachpack"'))),b=new e("bootstrap2014/cage-teachpack",[["start",1,!1]].map(t('"bootstrap2014/cage-teachpack"'))),x=new e("bootstrap/function-teachpack",[["start",1,!1]].map(t('"bootstrap/function-teachpack"'))),E=new e("bootstrap2011/function-teachpack",[["start",1,!1]].map(t('"bootstrap2011/function-teachpack"'))),S=new e("bootstrap2012/function-teachpack",[["start",1,!1]].map(t('"bootstrap2012/function-teachpack"'))),k=new e("bootstrap2014/function-teachpack",[["start",1,!1]].map(t('"bootstrap2014/function-teachpack"'))),C=new e("bootstrap2015/function-teachpack",[["start",1,!1]].map(t('"bootstrap2015/function-teachpack"'))),M=new e("location",[["get-latitude",0,!1,["android.permission.LOCATION"]],["get-longitude",0,!1,["android.permission.LOCATION"]],["get-altitude",0,!1,["android.permission.LOCATION"]],["get-bearing",0,!1,["android.permission.LOCATION"]],["get-speed",0,!1,["android.permission.LOCATION"]],["location-distance",0,!1,["android.permission.LOCATION"]]].map(t('"moby/geolocation"'))),T=new e("tilt",[["get-x-acceleration",0,!1,["android.permission.TILT"]],["get-y-acceleration",0,!1,["android.permission.TILT"]],["get-z-acceleration",0,!1,["android.permission.TILT"]],["get-azimuth",0,!1,["android.permission.TILT"]],["get-pitch",0,!1,["android.permission.TILT"]],["get-roll",0,!1,["android.permission.TILT"]]].map(t('"moby/tilt"'))),I=new e("telephony",[["get-signal-strength",0,!1,["android.permission.TELEPHONY"]]].map(t('"moby/net"'))),P=new e("net",[["get-url",1,!1,["android.permission.INTERNET"]]].map(t('"moby/net"'))),q=new e("parser",[["xml->s-sexp",1,!1]].map(t('"moby/parser"'))),B=new e("jsworld",[["js-big-bang",1,!1],["big-bang",1,!1],["js-div",0,!1],["js-p",0,!1],["js-button",2,!1],["js-button!",2,!1],["js-node",1,!1],["js-text",1,!1],["js-select",2,!1],["js-img",1,!1,["android.permission.INTERNET"]]].map(t('"moby/jsworld"'))),N=new e("world",s.bindings.concat(a.bindings,["key=?","play-sound","animate","big-bang","make-color","color?","color-red","color-green","color-blue","color-alpha","empty-scene","empty-image","scene+line","put-image","place-image","place-image/align","put-pinhole","circle","star","polygon","radial-star","star-polygon","nw:rectangle","rectangle","regular-polygon","rhombus","square","triangle","triangle/sas","triangle/sss","triangle/ass","triangle/ssa","triangle/aas","triangle/asa","triangle/saa","right-triangle","isosceles-triangle","ellipse","line","add-line","overlay","overlay/xy","overlay/align","underlay","underlay/xy","underlay/align","beside","beside/align","above","above/align","rotate","scale","scale/xy","crop","frame","flip-horizontal","flip-vertical","text","text/font","video-url","video/url","bitmap/url","image-url","open-image-url","image?","image=?","image-width","image-height","mouse-event?","mouse=?","image->color-list","color-list->image","color-list->bitmap","image-baseline","mode?","image-color?","name->color","x-place?","y-place?","angle?","side-count?","step-count?"].map(function(t){
var e=["video/url","bitmap/url","image-url","open-image-url"],n=e.indexOf(t)>-1?["android.permission.INTERNET"]:[];return new o(t,'"moby/world"',n,!1)}))),R=new e("moby/topLevel",[["<",2,!0],["<=",2,!0],["=",2,!0],[">",2,!0],[">=",2,!0],["=~",3],["number->string",1],["even?",1],["odd?",1],["positive?",1],["negative?",1],["number?",1],["rational?",1],["quotient",2],["remainder",2],["numerator",1],["denominator",1],["integer?",1],["real?",1],["abs",1],["acos",1],["add1",1],["angle",1],["asin",1],["atan",1,!0],["ceiling",1],["complex?",1],["conjugate",1],["cos",1],["cosh",1],["denominator",1],["even?",1],["exact->inexact",1],["exact?",1],["exp",1],["expt",2],["floor",1],["gcd",1,!0],["imag-part",1],["inexact->exact",1],["inexact?",1],["integer->char",1],["integer-sqrt",1],["integer?",1],["lcm",1,!0],["log",1],["magnitude",1],["make-polar",2],["make-rectangular",2],["max",1,!0],["min",1,!0],["modulo",2],["negative?",1],["number?",1],["numerator",1],["odd?",1],["positive?",1],["random",1],["rational?",1],["real-part",1],["real?",1],["round",1],["sgn",1],["sin",1],["sinh",1],["sqr",1],["sqrt",1],["sub1",1],["tan",1],["zero?",1],["+",0,!0],["-",1,!0],["*",0,!0],["/",1,!0],["not",1],["false?",1],["boolean?",1],["boolean=?",2],["symbol->string",1],["symbol=?",2],["symbol?",1],["append",0,!0],["assq",2],["assv",2],["assoc",2],["caaar",1],["caadr",1],["caar",1],["cadar",1],["cadddr",1],["caddr",1],["cadr",1],["car",1],["cddar",1],["cdddr",1],["cddr",1],["cdr",1],["cdaar",1],["cdadr",1],["cdar",1],["cons?",1],["list?",1],["cons",2],["empty?",1],["length",1],["list",0,!0],["list*",1,!0],["list-ref",2],["remove",2],["member",2],["member?",2],["memq",2],["memv",2],["null?",1],["pair?",1],["rest",1],["reverse",1],["first",1],["second",1],["third",1],["fourth",1],["fifth",1],["sixth",1],["seventh",1],["eighth",1],["box",1],["unbox",1],["set-box!",2],["box?",1],["make-posn",2],["posn-x",1],["posn-y",1],["posn?",1],["char->integer",1],["char-alphabetic?",1],["char-ci<=?",2,!0],["char-ci<?",2,!0],["char-ci=?",2,!0],["char-ci>=?",2,!0],["char-ci>?",2,!0],["char-downcase",1],["char-lower-case?",1],["char-numeric?",1],["char-upcase",1],["char-upper-case?",1],["char-whitespace?",1],["char<=?",2,!0],["char<?",2,!0],["char=?",2,!0],["char>=?",2,!0],["char>?",2,!0],["char?",1],["format",1,!0],["list->string",1],["make-string",2],["replicate",2],["string",0,!0],["string->list",1],["string->number",1],["string->symbol",1],["string-alphabetic?",1],["string-append",0,!0],["string-ci<=?",2,!0],["string-ci<?",2,!0],["string-ci=?",2,!0],["string-ci>=?",2,!0],["string-ci>?",2,!0],["string-copy",1],["string-length",1],["string-lower-case?",1],["string-numeric?",1],["string-ref",2],["string-upper-case?",1],["string-whitespace?",1],["string<=?",2,!0],["string<?",2,!0],["string=?",2,!0],["string>=?",2,!0],["string>?",2,!0],["string?",1],["substring",3],["string-ith",2],["int->string",1],["string->int",1],["explode",1],["implode",1],["eof-object?",1],["=~",3],["eq?",2],["equal?",2],["equal~?",3],["eqv?",2],["error",2],["identity",1],["struct?",1],["current-seconds",0],["andmap",1,!0],["apply",2,!0],["argmax",2],["argmin",2],["build-list",2],["build-string",2],["compose",0,!0],["filter",2],["foldl",2,!0],["foldr",2,!0],["map",1,!0],["for-each",1,!0],["memf",2],["ormap",1,!0],["procedure?",1],["quicksort",2],["sort",2],["void",0,!0],["xml->s-exp",1],["build-vector",2],["make-vector",1,!0],["vector",0,!0],["vector-length",1],["vector-ref",2],["vector-set!",3],["vector->list",1],["list->vector",1],["vector?",1],["printf",1,!0],["display",1],["write",1],["newline",0],["call/cc",1],["procedure-arity",1],["check-expect",2],["EXAMPLE",2],["check-within",3],["check-error",2],["make-hasheq",0],["make-hash",0],["hash-set!",3],["hash-ref",3],["hash-remove!",2],["hash-map",2],["hash-for-each",2],["hash?",1],["raise",1],["undefined?",1],["values",0,!0],["make-struct-type",4,!0],["make-struct-field-accessor",2,!0],["make-struct-field-mutator",2,!0],["current-continuation-marks",0,!1],["continuation-mark-set->list",2,!1],["scheme->prim-js",1,!1],["prim-js->scheme",1,!1],["procedure->cps-js-fun",1,!1],["procedure->void-js-fun",1,!1],["js-===",2,!1],["js-get-named-object",1,!1],["js-get-field",2,!0],["js-set-field!",3,!1],["js-typeof",1,!1],["js-instanceof",2,!1],["js-call",2,!0],["js-new",1,!0],["js-make-hash",0,!0],["make-world-config",2,!0],["make-bb-info",2,!1],["bb-info?",1,!1],["bb-info-change-world",1,!1],["bb-info-toplevel-node",1,!1],["make-effect-type",4,!0],["effect?",1,!1],["world-with-effects",2,!1],["make-render-effect-type",4,!0],["render-effect-type?",1],["render-effect?",1],["make-render-effect-type",4,!0],["values",0,!0],["sleep",0,!0],["current-inexact-milliseconds",0,!1],["make-exn",2,!1],["exn-message",1,!1],["exn-continuation-marks",1,!1]].map(t('"moby/toplevel"')));plt.compiler.topLevelModules=[R,r,,B,N],plt.compiler.knownCollections=["bootstrap","bootstrap2011","bootstrap2012","bootstrap2014","bootstrap2015"],plt.compiler.knownModules=[r,B,i,N,u,l,p,f,m,h,d,g,y,v,w,b,x,E,S,k,C,M,T,I,P,q,R]}(),t.exports=plt.compiler},function(t,e,n){n(2);var o=n(4),r=n(3);window.plt=window.plt||{},plt.compiler=plt.compiler||{},function(){function t(){}function e(e,n,o){t.call(this),this.name=e,this.isBoxed=n,this.depth=o}function n(e,n,o){t.call(this),this.name=e,this.pos=o,this.depth=n}function i(e){t.call(this),this.name=e}function a(t){return r.isString(t)&&void 0!==t.chars?'"'+t.toString()+'"':t.toBytecode?t.toBytecode():t}function s(t){for(var e=t.toString().replace(/\|/g,""),n="",o=["{","}","[","]",",","'","`"," ","\\",'"'],r=0;r<e.length;r++)n+=(o.indexOf(e.charAt(r))>-1?"\\":"")+e.charAt(r);return n=n.replace(/\n/g,"\\n")}function c(t){Mt.call(this),this.name=t,this.toBytecode=function(){return'{"$":"global-bucket","value":"'+s(this.name)+'"}'}}function u(t,e,n,o){Mt.call(this),this.$="module-variable",this.modidx=t,this.sym=e,this.pos=n,this.phase=o,this.toBytecode=function(){return'{"$":"module-variable","sym":'+this.sym.toBytecode()+',"modidx":'+this.modidx.toBytecode()+',"pos":'+this.pos+',"phase":'+this.phase+"}"}}function l(){Mt.call(this)}function p(t,e,n){Mt.call(this),this.datum=t,this.wraps=e,this.certs=n}function h(t){this.encoded=t,Mt.call(this)}function f(t,e,n){Mt.call(this),this.numLifts=t,this.topLevels=e,this.stxs=n,this.toBytecode=function(){return'{"$":"prefix","num-lifts":'+this.numLifts+',"toplevels":['+this.topLevels.map(function(t){return a(t)}).join(",")+'],"stxs":['+this.stxs.map(a)+"]}"}}function d(){Mt.call(this)}function m(t){Mt.call(this)}function g(t){Mt.call(this),this.v=t,this.toBytecode=function(){return'{"$":"indirect","v":'+this.v.toBytecode()+"}"}}function y(t,e,n){Mt.call(this),this.maxLetDepth=t,this.prefix=e,this.code=n,this.toBytecode=function(){return'{"$":"compilation-top","max-let-depth":'+this.maxLetDepth+',"prefix":'+this.prefix.toBytecode()+',"compiled-indirects":[],"code":'+this.code.toBytecode()+"}"}}function v(t,e,n,o,r,i,a){Mt.call(this),this.name=t,this.src=e,this.srcName=n,this.nomSrc=o,this.srcPhase=r,this.insp=a,this.isProtected=i}function w(t,e,n,o,r){Mt.call(this),this.depth=t,this.pos=e,this.constant=n,this.ready=o,this.loc=r,this.toBytecode=function(){return'{"$":"toplevel","depth":'+this.depth.toString()+',"pos":'+this.pos.toString()+',"const?":'+this.constant+',"ready?":'+this.ready+',"loc":'+(this.loc&&this.loc.toVector().toBytecode())+"}"}}function b(t){Mt.call(this),this.forms=t,this.toBytecode=function(){return'{"$":"seq","forms":['+this.forms.map(a).join(",")+"]}"}}function x(t,e){Mt.call(this),this.ids=t,this.rhs=e,this.toBytecode=function(){return'{"$":"def-values","ids":['+this.ids.map(a).join(",")+'],"body":'+this.rhs.toBytecode()+"}"}}function E(t,e,n,o){Mt.call(this),this.$="def-values",this.ids=t,this.rhs=e,this.prefix=n,this.maxLetDepth=o,this.toBytecode=function(){return'{"$":"def-values","ids":['+this.ids.toBytecode().join(",")+'],"rhs":'+this.rhs.toBytecode()+',"prefix":'+this.prefix.toBytecode()+',"max-let-depth":'+this.maxLetDepth.toBytecode()+"}"}}function S(t,e,n,o){Mt.call(this),this.ids=t,this.rhs=e,this.prefix=n,this.maxLetDepth=o}function k(t,e,n,o,r,i,a,s,c,u,l,p){Mt.call(this),this.name=t,this.selfModidx=e,this.prefix=n,this.provides=o,this.requires=r,this.body=i,this.syntaxBody=a,this.unexported=s,this.maxLetDepth=c,this.dummy=u,this.langInfo=l,this.internalContext=p,this.toBytecode=function(){return'{"$":"mod","name":'+this.name.toBytecode()+',"self-modidx":'+this.selfModidx.toBytecode()+',"prefix":'+this.prefix.toBytecode()+',"provides":'+this.provides.toBytecode()+',"requires":'+(this.requires&&this.requires.toVector().toBytecode())+',"body":'+this.body.toBytecode()+',"stx-body":'+this.syntaxBody.toBytecode()+',"max-let-depth":'+this.maxLetDepth.toBytecode()+"}"}}function C(t,e,n,o,r,i,s,c,u,l){Mt.call(this),this.name=t,this.flags=n,this.numParams=o,this.paramTypes=r,this.rest=i,this.body=l,this.closureMap=s,this.maxLetDepth=u,this.closureTypes=c,this.operatorAndRandLocs=e,this.toBytecode=function(){return'{"$":"lam","name":'+this.name.toBytecode()+',"locs":['+this.operatorAndRandLocs.map(a).join(",")+'],"flags":['+this.flags.map(a).join(",")+'],"num-params":'+this.numParams+',"param-types":['+this.paramTypes.map(a).join(",")+'],"rest?":'+this.rest+',"closure-map":['+this.closureMap.map(a).join(",")+'],"closure-types":['+this.closureTypes.map(a).join(",")+'],"max-let-depth":'+this.maxLetDepth+',"body":'+this.body.toBytecode()+"}"}}function M(t,e){Mt.call(this),this.code=t,this.genId=e,this.toBytecode=function(){return'{"$":"closure","code":'+this.code.toBytecode()+',"gen-id":'+this.genId.toBytecode()+"}"}}function T(t,e){Mt.call(this),this.name=t,this.clauses=e,this.toBytecode=function(){return'{"$":"case-lam","name":'+this.name.toBytecode()+',"clauses":'+this.clauses.toBytecode()+"}"}}function I(t,e,n){Mt.call(this),this.rhs=t,this.body=e,this.flonum=n,this.toBytecode=function(){return'{"$": "let-one","rhs":'+this.rhs.toBytecode()+',"body":'+this.body.toBytecode()+',"flonum":'+this.flonum.toBytecode()+"}"}}function P(t,e,n){Mt.call(this),this.count=t,this.boxes=e,this.body=n,this.toBytecode=function(){return'{"$":"let-void","count":'+a(this.count)+',"boxes?":'+a(this.boxes)+',"body":'+this.body.toBytecode()+"}"}}function q(t,e){Mt.call(this),this.procs=t,this.body=e,this.toBytecode=function(){return'{"$":"let-rec","procs":'+this.procs.toBytecode()+',"body":'+this.body.toBytecode()+"}"}}function B(t,e,n,o,r){Mt.call(this),this.count=t,this.pos=e,this.boxes=n,this.rhs=o,this.body=r,this.toBytecode=function(){return'{"$":"install-value","count":'+a(this.count)+',"pos":'+a(this.pos)+',"boxes?":'+a(this.boxes)+',"rhs":'+this.rhs.toBytecode()+',"body":'+this.body.toBytecode()+"}"}}function N(t,e){Mt.call(this),this.pos=t,this.body=e,this.toBytecode=function(){return'{"$":"boxenv","pos":'+this.pos.toBytecode()+',"body":'+this.body.toBytecode()+"}"}}function R(t,e,n,o,r){Mt.call(this),this.unbox=t||!1,this.pos=e,this.clear=n,this.flonum=r,this.otherClears=o,this.toBytecode=function(){return'{"$":"localref","unbox?":'+this.unbox+',"pos":'+this.pos+',"clear":'+this.clear+',"other-clears?":'+this.otherClears+',"flonum?":'+this.flonum+"}"}}function A(t,e,n){Mt.call(this),this.depth=t,this.pos=e,this.midpt=n}function D(t,e){Mt.call(this),this.rator=t,this.rands=e,this.toBytecode=function(){return'{"$":"application","rator":'+this.rator.toBytecode()+',"rands":['+this.rands.map(a).join(",")+"]}"}}function F(t,e,n){Mt.call(this),this.testExpr=t,this.thenExpr=e,this.elseExpr=n,this.toBytecode=function(){return'{"$":"branch","test":'+this.testExpr.toBytecode()+',"then":'+this.thenExpr.toBytecode()+',"else":'+this.elseExpr.toBytecode()+"}"}}function O(t,e,n){Mt.call(this),this.$="with-cont-mark",this.key=t,this.val=e,this.body=n,this.toBytecode=function(){return'{"$":"with-cont-mark","key":'+new ct(new ut(this.key)).toBytecode()+',"val":'+new ct(this.val).toBytecode()+',"body":'+this.body.toBytecode()+"}"}}function V(t){Mt.call(this),this.seq=t,this.toBytecode=function(){return'{"$":"beg0","seq":'+this.seq.toBytecode()+"}"}}function L(t){Mt.call(this),this.forms=t,this.toBytecode=function(){return'{"$":"splice","forms":'+this.forms.toBytecode()+"}"}}function j(t){Mt.call(this),this.topLevel=t,this.toBytecode=function(){return'{"$":"varref","top-level":'+this.topLevel.toBytecode()+"}"}}function _(t,e,n){Mt.call(this),this.id=t,this.rhs=e,this.undefOk=n,this.toBytecode=function(){return'{"$":"assign","id":'+this.id.toBytecode()+',"rhs":'+this.rhs.toBytecode()+',"undef-ok":'+this.undefOk.toBytecode()+"}"}}function U(t,e){Mt.call(this),this.proc=t,this.args=e,this.toBytecode=function(){return'{"$":"apply-values","proc":'+this.proc.toBytecode()+',"args":'+this.args.toBytecode()+"}"}}function z(t){Mt.call(this),this.id=t,this.toBytecode=function(){return'{"$":"primval","id":'+this.id.toBytecode()+"}"}}function $(t,e){Mt.call(this),this.$="req",this.reqs=t,this.dummy=e,this.toBytecode=function(){var t=this.reqs instanceof ct?'"'+this.reqs.val+'"':this.reqs.toBytecode();return'{"$":"req","reqs":'+t+',"dummy":'+this.dummy.toBytecode()+"}"}}function W(t,e,n){this.bool1=t,this.bool2=e,this.alist=n,Mt.call(this)}function G(t,e,n){this.amt=t,this.src=e,this.dest=n,Mt.call(this)}function Y(t){this.val=t,Mt.call(this)}function K(t){this.sym=t,Mt.call(this)}function X(t,e,n,o,r){this.path=t,this.phase=e,this.srcPhase=n,this.prefix=r,this.exceptions=o,Mt.call(this)}function Z(){Mt.call(this)}function H(t){this.value=t,Mt.call(this)}function Q(t,e,n,o,r){this.path=t,this.phase=e,this.exportName=o,this.nominalExportName=r,Mt.call(this)}function J(t,e,n,o){this.path=t,this.exportName=e,this.nominalPath=n,this.nominalExportName=o,Mt.call(this)}function tt(t,e){this.path=t,this.nominalPath=e,Mt.call(this)}function et(t,e){this.path=t,this.exportName=e,Mt.call(this)}function nt(t){this.path=t,Mt.call(this)}function ot(t,e,n,o,r,i,a){this.phase=t,this.kind=e,this.unmarshals=o,this.renames=r,this.markRenames=i,this.plusKern=a,Mt.call(this)}function rt(t,e){this.path=t,this.base=e,Mt.call(this),this.toBytecode=function(){return'{"$":"module-path","path":'+a(this.path)+',"base":'+a(this.base)+"}"}}function it(t,e,n){function o(t){return t.length<=1?t:n(t[0],t[1])?o(t.slice(1)):[t[0]].concat(o(t.slice(1)))}var r=function(t,n){return e(t,n)?-1:e(n,t)};return o(t.sort(r))}function at(t,e){var n=t[0],o=t[1],r=t[2],i=e.compile(r,o),a=i[0],o=i[1];return[[a].concat(n),o,r]}function st(t,e){function n(t){var e=t.modules.reduce(function(t,e){return t.concat(e.bindings)},[]),n=function(t){return t.moduleSource&&-1===e.indexOf(t)},o=t.usedBindingsHash.values().filter(n),r=e.concat(o),i=function(t){return new c(t)},a=function(t,e){return new rt(t,e)},s=function(t){return new u(a(t.moduleSource,t.imported?!1:a(!1,!1)),new ut(t.name),-1,0)},l=t.freeVariables.concat(t.definedNames.keys()),p=it(l,function(t,e){return e>t},function(t,e){return t==e}),h=[!1].concat(p.map(i),r.map(s)),d=[!1].concat(p,r.map(function(t){return t.name}));return[new f(0,h,[]),new plt.compiler.globalEnv(d,!1,new plt.compiler.emptyEnv)]}var o=n(e),r=o[0],i=o[1],a=t.filter(plt.compiler.isDefinition),s=t.filter(function(t){return t instanceof St}),l=t.filter(plt.compiler.isExpression),p=s.reduceRight(at,[[],e,i]),h=p[0],e=p[1],d=a.reduceRight(at,[[],e,i]),m=d[0],e=d[1],g=l.reduceRight(at,[[],e,i]),v=g[0],e=g[1],w=new b([].concat(h,m,v)),x=new y(0,r,w),E={bytecode:"/* runtime-version: local-compiler-summer2014 */\n"+x.toBytecode(),permissions:e.permissions(),provides:e.providedNames.keys()};return E}var ct=plt.compiler.literal,ut=plt.compiler.symbolExpr,lt=plt.compiler.Program,pt=plt.compiler.ifExpr,ht=plt.compiler.beginExpr,ft=plt.compiler.localExpr,dt=plt.compiler.andExpr,mt=plt.compiler.orExpr,gt=plt.compiler.lambdaExpr,yt=plt.compiler.quotedExpr,vt=plt.compiler.callExpr,wt=plt.compiler.defFunc,bt=plt.compiler.defVar,xt=plt.compiler.defVars,Et=plt.compiler.defStruct,St=plt.compiler.requireExpr,kt=plt.compiler.provideStatement,Ct=function(t){var e=function(){};return e.prototype=t,new e};ct.prototype.toBytecode=function(){var t=this.val.toBytecode?this.val.toBytecode():this.val===!0?"true":this.val===!1?"false":this.toString();return'{"$":"constant","value":'+t+"}"},ut.prototype.toBytecode=function(){return'types.symbol("'+s(this.val)+'")'},Vector.prototype.toBytecode=function(){return"types.vector(["+this.elts.join(",")+"])"},Array.prototype.toBytecode=function(t){return"types."+(0===this.length?"EMPTY":"list(["+this.map(a).join(",")+"])")},o.Rational.prototype.toBytecode=function(){return"types.rational("+a(this.n)+", "+a(this.d)+")"},o.BigInteger.prototype.toBytecode=function(){return'types.bignum("'+this.toString()+'")'},o.FloatPoint.prototype.toBytecode=function(){var t=this.toString();return"+nan.0"===t&&(t="NaN"),"+inf.0"===t&&(t="Infinity"),"-inf.0"===t&&(t="-Infinity"),'types["float"]('+t+")"},o.Complex.prototype.toBytecode=function(){return"types.complex("+a(this.r)+", "+a(this.i)+")"},Char.prototype.toBytecode=function(){return"types['char'](String.fromCharCode("+this.val.charCodeAt(0)+"))"},e.prototype=Ct(t.prototype),n.prototype=Ct(t.prototype),i.prototype=Ct(t.prototype);var Mt=function(){this.toBytecode=function(){throw console.log(this),"IMPOSSIBLE - generic bytecode toBytecode method was called"}};c.prototype=Ct(Mt.prototype),u.prototype=Ct(Mt.prototype),l.prototype=Ct(Mt.prototype),p.prototype=Ct(Mt.prototype),h.prototype=Ct(Mt.prototype),f.prototype=Ct(Mt.prototype),d.prototype=Ct(Mt.prototype),m.prototype=Ct(Mt.prototype),g.prototype=Ct(Mt.prototype),y.prototype=Ct(Mt.prototype),v.prototype=Ct(Mt.prototype),w.prototype=Ct(Mt.prototype),b.prototype=Ct(Mt.prototype),x.prototype=Ct(Mt.prototype),E.prototype=Ct(Mt.prototype),S.prototype=Ct(Mt.prototype),k.prototype=Ct(Mt.prototype),C.prototype=Ct(Mt.prototype),M.prototype=Ct(Mt.prototype),T.prototype=Ct(Mt.prototype),I.prototype=Ct(Mt.prototype),P.prototype=Ct(Mt.prototype),q.prototype=Ct(Mt.prototype),B.prototype=Ct(Mt.prototype),N.prototype=Ct(Mt.prototype),R.prototype=Ct(Mt.prototype),A.prototype=Ct(Mt.prototype),D.prototype=Ct(Mt.prototype),F.prototype=Ct(Mt.prototype),O.prototype=Ct(Mt.prototype),V.prototype=Ct(Mt.prototype),L.prototype=Ct(Mt.prototype),j.prototype=Ct(Mt.prototype),_.prototype=Ct(Mt.prototype),U.prototype=Ct(Mt.prototype),z.prototype=Ct(Mt.prototype),$.prototype=Ct(Mt.prototype),W.prototype=Ct(Mt.prototype),G.prototype=Ct(Mt.prototype),Y.prototype=Ct(Mt.prototype),K.prototype=Ct(Mt.prototype),X.prototype=Ct(Mt.prototype),Z.prototype=Ct(Mt.prototype),H.prototype=Ct(Mt.prototype),Q.prototype=Ct(Mt.prototype),J.prototype=Ct(Mt.prototype),tt.prototype=Ct(Mt.prototype),et.prototype=Ct(Mt.prototype),nt.prototype=Ct(Mt.prototype),ot.prototype=Ct(Mt.prototype),rt.prototype=Ct(Mt.prototype),lt.prototype.freeVariables=function(t,e){return t},pt.prototype.freeVariables=function(t,e){return this.alternative.freeVariables(this.consequence.freeVariables(this.predicate.freeVariables(t,e),e),e)},ht.prototype.freeVariables=function(t,e){return this.exprs.reduceRight(function(t,n){return n.freeVariables(t,e)},t)},ut.prototype.freeVariables=function(t,e){return e.lookup(this.val,0)instanceof i&&-1==t.indexOf(this)?t.concat([this]):t},ft.prototype.freeVariables=function(t,e){var n=function(t,e){return new plt.compiler.localEnv(e.val,!0,t)},o=function(t,e){return new plt.compiler.localEnv(e.val,!1,t)},r=this.defs.reduce(function(t,e){return(e instanceof xt?e.names:[e.name]).concat(t)},[]),i=r.reduce(n,e),a=this.body.freeVariables(t,i),s=function(t,e){if(e instanceof wt){var n=e.args.reduce(function(t,e){return o(t,e)},i);return e.body.freeVariables(t,n)}return e instanceof Et?t:e.expr.freeVariables(t,i)};return this.defs.reduce(s,a)},dt.prototype.freeVariables=function(t,e){return this.exprs.reduceRight(function(t,n){return n.freeVariables(t,e)},t)},mt.prototype.freeVariables=function(t,e){return this.exprs.reduceRight(function(t,n){return n.freeVariables(t,e)},t)},gt.prototype.freeVariables=function(t,e){var n=function(t,e){return new plt.compiler.localEnv(e.val,!1,t)},o=this.args.slice(0).reverse().reduce(n,e);return this.body.freeVariables(t,o)},yt.prototype.freeVariables=function(t,e){return t},vt.prototype.freeVariables=function(t,e){return this.func.freeVariables(t,e).concat(this.args).reduceRight(function(t,n){return n.freeVariables(t,e)},t)},lt.prototype.compile=function(t,e){return[this,e]},wt.prototype.compile=function(t,e){var n=this.name.compile(t,e),o=n[0],e=n[1],r=new gt(this.args,this.body),i=r.compile(t,e,!1,this.name),a=i[0],e=i[1],s=new x([o],a);return[s,e]},bt.prototype.compile=function(t,e){var n=this.name.compile(t,e),o=n[0],e=n[1],r=this.expr.compile(t,e),i=r[0],e=r[1],a=new x([o],i);return[a,e]},xt.prototype.compile=function(t,e){var n=this.names.reduceRight(at,[[],e,t]),o=n[0],e=n[1],r=this.expr.compile(t,e),i=r[0],e=r[1],a=new x(o,i);return[a,e]},ht.prototype.compile=function(t,e){var n=this.exprs.reduceRight(at,[[],e,t]),o=n[0],r=n[1],i=new b(o);return[i,r]},gt.prototype.compile=function(t,o,r,a){function s(t,e){return t.map(function(t){return e.indexOf(t)>-1?t:!1})}function c(t,e){return new plt.compiler.localEnv(e,!1,t)}function u(t,e){return new plt.compiler.localEnv(e,!0,t)}function l(t,e){return new plt.compiler.globalEnv(t,!1,e)}function p(t,o,r){var a=o.map(function(t){return r.lookup(t.val,0)}),p=function(t,e){return 0===e.length?!1:t(e[0])?e[0]:p(t,e.slice(1))},h=function(t){return t instanceof e},f=function(t){return t instanceof n},d=function(t){return t instanceof i},m=function(t){return t.depth},g=p(d,a);if(g)throw"Can't produce closure; I don't know where "+g.name+" is bound.";var y=it(a.filter(h),function(t,e){return t.depth<e.depth},function(t,e){return t.depth===e.depth}),v=y.map(m),w=a.filter(f),b=it(w.map(m),function(t,e){return e>t},function(t,e){return t===e}),x=t.reverse().map(function(t){return t.val}).reduce(c,r),E=y.reverse().reduce(function(t,e){return e.isBoxed?u(t,e.name):c(t,e.name)},x),S=b.reverse().reduce(function(t,e){var n=w.filter(function(t){return t.depth===e}),o=n.map(function(t){return t.name}),i=s(r.peek(e).names,o);return l(i,t)},E);return[b.concat(v),S]}void 0===r&&(r=!0);var h=this.args.map(function(t){return t.val}).reduce(c,new plt.compiler.emptyEnv);freeVarsInBody=this.body.freeVariables([],h);var f=p(this.args.slice(0),freeVarsInBody,t),d=f[0],m=f[1],g=this.body.compile(m,o),y=g[0],v=g[1],w=function(t){return t.location.toVector()},b=new C(r?[]:new ut(a),[r?this.stx:a].concat(this.args).map(w),[],this.args.length,this.args.map(function(){return new ut("val")}),!1,d,d.map(function(){return new ut("val/ref")}),0,y);return[b,v]},ft.prototype.compile=function(t,e){function n(t,e){return t.concat(e instanceof xt?e.names:e.name)}function o(t,e,n,i){if(0===t.length)return r.body.compile(s,e);var a=t[0].compile(n,e),c=a[0].rhs,e=a[1],u=t[0]instanceof xt?t[0].names.length:1,l=o(t.slice(1),e,n,i+u);newBody=l[0],e=l[1];var p=new B(u,i,!0,c,newBody);return[p,e]}if(0===this.defs.length)return this.body.compile(t,e);var r=this,i=this.defs.reduce(n,[]),a=function(t,e){return new plt.compiler.localEnv(e.val,!0,t)},s=i.reverse().reduce(a,t),c=o(this.defs,e,s,0),u=c[0],e=c[1];return[new P(i.length,!0,u),e]},vt.prototype.compile=function(t,e){var n=function(t,e){return new plt.compiler.unnamedEnv(t)},o=this.args.reduce(n,t),r=this.func.compile(o,e),i=r[0],a=(r[1],this.args.reduceRight(at,[[],e,o])),s=a[0],c=r[1],u=new D(i,s),l=function(t){return t.location},p=[this.func.location].concat(this.args.map(l)),h=p.concat(this.location).map(function(t){return t.toVector()}),f=new O(new ut("moby-application-position-key"),h,new O(new ut("moby-stack-record-continuation-mark-key"),this.location.toVector(),u));return[f,c]},pt.prototype.compile=function(t,e){var n=this.predicate.compile(t,e),o=n[0],r=(n[1],this.consequence.compile(t,e)),i=r[0],a=(r[1],this.alternative.compile(t,e)),s=a[0],c=a[1],u=new F(o,i,s);return[u,c]},ut.prototype.compile=function(t,o){var r,a=t.lookup(this.val,0);if(a instanceof e)r=new R(a.isBoxed,a.depth,!1,!1,!1);else{if(!(a instanceof n))throw a instanceof i?"Couldn't find '"+this.val+"' in the environment":"IMPOSSIBLE: env.lookup failed for '"+this.val+"'! A reference should be added to the environment!";r=new w(a.depth,a.pos,!1,!1,this.location)}return[r,o]},yt.prototype.compile=function(t,e){function n(t){return t instanceof ct?n(t.val):t instanceof Array?t.map(n):t}return result=new ct(n(this.val)),[result,e]},kt.prototype.compile=function(t,e){},St.prototype.compile=function(t,e){return[new $(this.spec,new w(0,0,!1,!1,!1)),e]},plt.compiler.localStackReference=e,plt.compiler.globalStackReference=n,plt.compiler.unboundStackReference=i,plt.compiler.compile=function(t,e,n){var o=(new Date).getTime();try{var r=st(t,e)}catch(i){throw console.log("COMPILATION ERROR"),i}var a=(new Date).getTime();return n&&(console.log("Compiled in "+Math.floor(a-o)+"ms"),console.log(JSON.stringify(r))),r}}(),t.exports=plt.compiler}]);
//# sourceMappingURL=wescheme-js.min.js.map